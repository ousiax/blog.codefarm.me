<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bing WebMaster -->
  <meta name="msvalidate.01" content="AB2FFF876C37F59D9121882CC8395DE5" />

  <title>Python Learning Notes</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.codefarm.me/2024/05/17/python-learning-notes/">
  <link rel="alternate" type="application/rss+xml" title="CODE FARM" href="https://blog.codefarm.me/feed.xml">

  <!--<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" />-->

  <!-- https://cdn.jsdelivr.net/gh/lurongkai/anti-baidu/js/anti-baidu-latest.min.js -->
<script type="text/javascript" src="/js/anti-baidu.min.js" charset="UTF-8"></script>

  
<!-- Google Analytics Website tracking -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83971182-1', 'auto');
  ga('send', 'pageview');

</script>


  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SN88FJ18E5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SN88FJ18E5');
</script>



</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <h2 class="site-title">
      <a class="site-title" href="/">CODE FARM</a>
    </h2>

     <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
        <div class="trigger">
            <ul>
                <li><a href="/">home</a>
                <li><a href="/category">category</a>
                <li><a href="/tag">tag</a>
                <li><a href="/archive">archive</a>
                <li><a href="/about">about</a>
                <li><a href="https://resume.github.io/?ousiax" target="_blank">R&eacute;sum&eacute;</a>
            </ul>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Python Learning Notes</h1>
    
    
    <p class="post-meta"><time datetime="2024-05-17T10:29:20+08:00" itemprop="datePublished">May 17, 2024</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div id="preamble">
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">&gt;</span><span class="w"> </span>import this
<span class="go">The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!</span></code></pre>
</div>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#running-python">1. Running Python</a></li>
<li><a href="#indentations-comments-and-multi-line-expressions">2. Indentations, comments, and multi-line expressions</a></li>
<li><a href="#keywords">3. Keywords</a></li>
<li><a href="#types">4. Types</a></li>
<li><a href="#strings-bytes-and-bytearray">5. Strings, bytes and bytearray</a></li>
<li><a href="#if-while-and-for">6. If, while, and for</a></li>
<li><a href="#tuples-and-lists">7. Tuples and lists</a></li>
<li><a href="#dictionaries-and-sets">8. Dictionaries and sets</a></li>
<li><a href="#iterations-and-comprehensions">9. Iterations and comprehensions</a></li>
<li><a href="#files-and-directories">10. Files and directories</a></li>
<li><a href="#functions">11. Functions</a>
<ul class="sectlevel2">
<li><a href="#namespaces">11.1. Namespaces</a></li>
<li><a href="#arguments">11.2. Arguments</a></li>
<li><a href="#attributes">11.3. Attributes</a></li>
<li><a href="#annotations">11.4. Annotations</a></li>
<li><a href="#lambda">11.5. Lambda</a></li>
<li><a href="#closures">11.6. Closures</a></li>
<li><a href="#generators">11.7. Generators</a></li>
</ul>
</li>
<li><a href="#classes">12. Classes</a>
<ul class="sectlevel2">
<li><a href="#inheritances">12.1. Inheritances</a></li>
<li><a href="#slots-attribute-declarations">12.2. Slots: attribute declarations</a></li>
<li><a href="#properties-attribute-accessors-a-k-a-getters-and-setters">12.3. Properties: attribute accessors (a.k.a. “getters” and “setters”)</a></li>
<li><a href="#instance-methods-class-methods-static-methods">12.4. Instance methods, class methods, static methods</a></li>
<li><a href="#operator-overloading">12.5. Operator overloading</a>
<ul class="sectlevel3">
<li><a href="#constructors-and-destructions-__init__-__del__">12.5.1. Constructors and destructions: __init__, __del__</a></li>
<li><a href="#indexing-and-slicing-__getitem__-and-__setitem__">12.5.2. Indexing and slicing: __getitem__ and __setitem__</a></li>
<li><a href="#iterable-objects-__iter__-and-__next__">12.5.3. Iterable objects: __iter__ and __next__</a></li>
<li><a href="#membership-__contains__-__iter__-and-__getitem__">12.5.4. Membership: __contains__, __iter__, and __getitem__</a></li>
<li><a href="#attribute-access-__getattr__-and-__setattr__">12.5.5. Attribute access: __getattr__ and __setattr__</a></li>
<li><a href="#string-representation-__repr__-and-__str__">12.5.6. String representation: __repr__ and __str__</a></li>
<li><a href="#right-side-and-in-place-uses-__radd__-and-__iadd__">12.5.7. Right-side and in-place uses: __radd__ and __iadd__</a></li>
<li><a href="#call-expressions-__call__">12.5.8. Call expressions: __call__</a></li>
<li><a href="#boolean-tests-__bool__-and-__len__">12.5.9. Boolean tests: __bool__ and __len__</a></li>
<li><a href="#withas-context-managers-__enter__-and-__exit__">12.5.10. with/as Context Managers: __enter__ and __exit__</a></li>
</ul>
</li>
<li><a href="#enum">12.6. Enum</a></li>
</ul>
</li>
<li><a href="#exceptions">13. Exceptions</a></li>
<li><a href="#decorators">14. Decorators</a></li>
<li><a href="#modules-and-packages">15. Modules and packages</a>
<ul class="sectlevel2">
<li><a href="#search-path">15.1. search path</a></li>
<li><a href="#__init__-py">15.2. __init__.py</a></li>
<li><a href="#import-and-from-statements-reload-call">15.3. import and from statements, reload call</a></li>
<li><a href="#relative-imports">15.4. relative imports</a></li>
<li><a href="#_x-__all__-__name__-and-__main__">15.5. _X, __all__, __name__, and __main__</a></li>
<li><a href="#modules-by-name-strings">15.6. modules by name strings</a></li>
<li><a href="#pip-pip-install-packages">15.7. pip: pip install packages</a>
<ul class="sectlevel3">
<li><a href="#virtual-environment">15.7.1. virtual environment</a></li>
<li><a href="#version-specifiers">15.7.2. Version specifiers</a></li>
<li><a href="#pip-install">15.7.3. pip install</a></li>
<li><a href="#cache-configuration">15.7.4. cache, configuration</a></li>
<li><a href="#mirror">15.7.5. mirror</a></li>
<li><a href="#conda">15.7.6. conda</a></li>
<li><a href="#pipenv">15.7.7. pipenv</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#testing">16. Testing</a></li>
<li><a href="#processes-and-concurrency">17. Processes and concurrency</a>
<ul class="sectlevel2">
<li><a href="#subprocess-and-multiprocessing">17.1. subprocess and multiprocessing</a></li>
<li><a href="#queues-processes-and-threads">17.2. Queues, processes, and threads</a></li>
<li><a href="#concurrent-futures">17.3. concurrent.futures</a></li>
<li><a href="#asynchronous-io">17.4. Asynchronous I/O</a></li>
</ul>
</li>
<li><a href="#sql">18. SQL</a>
<ul class="sectlevel2">
<li><a href="#using-db-api-with-sqlite-in-memory">18.1. Using DB-API with SQLite in Memory</a></li>
</ul>
</li>
<li><a href="#install-python-from-source-code-on-linux">Appendix A: Install Python from Source Code on Linux</a></li>
<li><a href="#build-a-docker-image-for-fastapi">Appendix B: Build a Docker Image for FastAPI</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="running-python">1. Running Python</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Using the interactive interpreter (shell)</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 <span class="nt">-q</span>
<span class="gp">&gt;</span><span class="o">&gt;&gt;</span> 2+2
<span class="go">4
</span><span class="gp">&gt;</span><span class="o">&gt;&gt;</span> quit<span class="o">()</span></code></pre>
</div>
</div>
</li>
<li>
<p>Using python files</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="nf">print</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 test.py
<span class="go">4</span></code></pre>
</div>
</div>
</li>
<li>
<p>Using python files with shebang</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In computing, a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)"><strong>shebang</strong></a> is the character sequence consisting of the characters number sign and exclamation mark (<code>#!</code>) at the beginning of a script. It is also called sharp-exclamation, sha-bang, <strong>hashbang</strong>, pound-bang, or hash-pling.</p>
</div>
<div class="paragraph text-right">
<p>&#8201;&#8212;&#8201;From Wikipedia, the free encyclopedia</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1">#!/usr/bin/env python3
</span><span class="nf">print</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>./test.py
<span class="go">4</span></code></pre>
</div>
</div>
</li>
<li>
<p>Executing modules as scripts</p>
<div class="paragraph">
<p>In Python, <code>python -m</code> is a command-line construct used to execute modules as scripts directly from the command line without explicitly writing a separate Python script file (<code>.py</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 <span class="nt">-m</span> venv <span class="nt">--help</span>
<span class="go">usage: venv [-h] [--system-site-packages] [--symlinks | --copies] [--clear] [--upgrade] [--without-pip]
            [--prompt PROMPT] [--upgrade-deps]
            ENV_DIR [ENV_DIR ...]

Creates virtual Python environments in one or more target directories.
. . .</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 <span class="nt">-m</span> webbrowser https://www.google.com</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="indentations-comments-and-multi-line-expressions">2. Indentations, comments, and multi-line expressions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Python uses whitespace indentation (the recommended style, called PEP-8, is to use four spaces), rather than curly brackets or keywords, to delimit blocks.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Don&#8217;t use tabs, or mix tabs and spaces; it messes up the indent count.</p>
</li>
<li>
<p>When designing the language that became Python, Guido van Rossum decided that the indentation itself was enough to define a program’s structure, and avoided typing all those parentheses and curly braces. Python is unusual in this use of white space to define program structure.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">disaster</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">if</span> <span class="n">disaster</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Woe!</span><span class="sh">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Whee!</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>As one special case here, the body of a compound statement can instead appear on the same line as the header in Python, after the colon:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">:</span> <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Simple statement on header line</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In Python, the general rule is that the end of a line automatically terminates the statement that appears on that line.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># x = 1;</span></code></pre>
</div>
</div>
</li>
<li>
<p>It is possible to squeeze more than one statement onto a single line in Python by separating them with semicolons:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nf">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="c1"># Three statements on one line</span></code></pre>
</div>
</div>
</li>
<li>
<p>Python allows writing expressions that span multiple lines within certain delimiters.</p>
<div class="ulist">
<ul>
<li>
<p>In older versions of Python (pre-3.0), the backslash character (<code>\</code>) at the end of a line was used to indicate that the line continued on the next line, which  is no longer required in modern Python (versions 3.0 and above).</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Example in older Python (error-prone, not recommended)
</span><span class="n">long_expression</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">+</span> \
                  <span class="mi">6</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>In modern Python, avoid using the continuation character (<code>\</code>) for line continuation, and utilize parentheses (<code>()</code>), brackets (<code>[]</code>), or braces (<code>{}</code>) for readability and structure in multi-line expressions.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Parentheses for complex calculations
</span><span class="n">long_calculation</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span>
                    <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span>
                          <span class="n">e</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span>

<span class="c1"># Brackets for multi-line lists or data structures
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">item1</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">item2 with a longer description</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">item3</span><span class="sh">"</span>
<span class="p">]</span>

<span class="c1"># Braces for multi-line dictionaries
</span><span class="n">person_info</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Alice</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">age</span><span class="sh">"</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">hobbies</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">reading</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">hiking</span><span class="sh">"</span><span class="p">]</span>
<span class="p">}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>A comment is marked by using the <code>#</code> (names: <em>hash</em>, <em>sharp</em>, <em>pound</em>, or or the sinister-sounding <em>octothorpe</em>) character; everything from that point on to the end of the current line is part of the comment.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># 60 sec/min * 60 min/hr * 24 hr/day
</span><span class="n">seconds_per_day</span> <span class="o">=</span> <span class="mi">86400</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">seconds_per_day</span> <span class="o">=</span> <span class="mi">86400</span> <span class="c1"># 60 sec/min * 60 min/hr * 24 hr/day</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Python does NOT
# have a multiline comment.
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">No comment: quotes make the # harmless.</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="keywords">3. Keywords</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="txt">False               class               from                or
None                continue            global              pass
True                def                 if                  raise
and                 del                 import              return
as                  elif                in                  try
assert              else                is                  while
async               except              lambda              with
await               finally             nonlocal            yield
break               for                 not</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="types">4. Types</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Python is a dynamically, strongly typed and garbage-collected programming language.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>In a dynamically typed language, the data type of a variable is NOT explicitly declared at the time of definition, and is determined at runtime.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">age</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># age is an integer (no need to declare the data type explicitly)
</span><span class="n">age</span> <span class="o">=</span> <span class="sh">"</span><span class="s">thirty</span><span class="sh">"</span>  <span class="c1"># age is now a string</span></code></pre>
</div>
</div>
</li>
<li>
<p>In a statically typed language, the data type of a variable MUST be declared at compile time and the compiler ensures type compatibility throughout the code.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// In Java, declare the type of a variable before assigning a value.</span>
<span class="kt">int</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">30</span><span class="o">;</span>  <span class="c1">// age is declared as an integer</span>
<span class="n">age</span> <span class="o">=</span> <span class="s">"thirty"</span><span class="o">;</span>  <span class="c1">// error: incompatible types: String cannot be converted to int</span></code></pre>
</div>
</div>
</li>
<li>
<p>In a strongly typed language, the data type of a variable MUST be declared at the time of definition, and the compiler or interpreter enforces type safety.</p>
</li>
<li>
<p>In Python, everything is ultimately an object, even data types like integers and strings, that has associated methods and attributes.</p>
<div class="paragraph">
<p>At runtime, Python checks if the methods or attributes involved are compatible with the object&#8217;s type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Like dynamic languages, Python infers types based on assigned values.
</span><span class="n">name</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Alice</span><span class="sh">"</span>  <span class="c1"># name is a string
</span><span class="n">name</span> <span class="o">+</span> <span class="mi">10</span>  <span class="c1"># This would cause a TypeError in Python (mixing string and number)</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In computer programming, <a href="https://en.wikipedia.org/wiki/Duck_typing">duck typing</a> is an application of the duck test—"If it walks like a duck and it quacks like a duck, then it must be a duck"—to determine whether an object can be used for a particular purpose.</p>
</div>
<div class="paragraph text-right">
<p>&#8201;&#8212;&#8201;From Wikipedia, the free encyclopedia</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yml"><span class="c1"># Python's major built-in object types, organized by categories.</span>
<span class="na">Collections</span><span class="pi">:</span>
  <span class="na">Sequences</span><span class="pi">:</span>
    <span class="na">Immutable</span><span class="pi">:</span>
      <span class="na">String</span><span class="pi">:</span>
      <span class="na">Unicode (2.X)</span><span class="pi">:</span>
      <span class="na">Bytes (3.X)</span><span class="pi">:</span>
      <span class="na">Tuple</span><span class="pi">:</span>
    <span class="na">Mutable</span><span class="pi">:</span>
      <span class="na">List</span><span class="pi">:</span>
      <span class="na">Bytearray (3.X/2.6+)</span><span class="pi">:</span>
  <span class="na">Mappings</span><span class="pi">:</span>
    <span class="na">Dictionary</span><span class="pi">:</span>
  <span class="na">Sets</span><span class="pi">:</span>
    <span class="na">Set</span><span class="pi">:</span>
    <span class="na">Fronzenset</span><span class="pi">:</span>
<span class="na">Numbers</span><span class="pi">:</span>
  <span class="na">Integers</span><span class="pi">:</span>
    <span class="na">Integer</span><span class="pi">:</span>
    <span class="na">Long (2.X)</span><span class="pi">:</span>
    <span class="na">Boolean</span><span class="pi">:</span>
  <span class="na">Float</span><span class="pi">:</span>
  <span class="na">Complex</span><span class="pi">:</span>
  <span class="na">Decimal</span><span class="pi">:</span>
  <span class="na">Fraction</span><span class="pi">:</span>
<span class="na">Callables</span><span class="pi">:</span>
  <span class="na">Function</span><span class="pi">:</span>
  <span class="na">Generator</span><span class="pi">:</span>
  <span class="na">Class</span><span class="pi">:</span>
  <span class="na">Method</span><span class="pi">:</span>
    <span class="na">Bound</span><span class="pi">:</span>
    <span class="na">Unbound (2.X)</span><span class="pi">:</span>
<span class="na">Other</span><span class="pi">:</span>
  <span class="na">Module</span><span class="pi">:</span>
  <span class="na">Instance</span><span class="pi">:</span>
  <span class="na">File</span><span class="pi">:</span>
  <span class="na">None</span><span class="pi">:</span>
  <span class="na">View (3.X/2.7)</span><span class="pi">:</span>
<span class="na">Internals</span><span class="pi">:</span>
  <span class="na">Type</span><span class="pi">:</span>
  <span class="na">Code</span><span class="pi">:</span>
  <span class="na">Frame</span><span class="pi">:</span>
  <span class="na">Traceback</span><span class="pi">:</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="nb">bool</span> <span class="c1"># True, False
</span>
<span class="nb">int</span> <span class="c1"># 47, 25000, 25_000, 0b0100_0000, 0o100, 0x40, sys.maxsize, - sys.maxsize - 1
</span>
<span class="nb">float</span> <span class="c1"># 3.14, 2.7e5, float('inf'), float('-inf'), float('nan')
</span>
<span class="nb">complex</span> <span class="c1"># 3j, 5 + 9j
</span>
<span class="c1"># In Python 3, strings are Unicode character sequences, not byte arrays.
</span><span class="nb">str</span> <span class="c1"># 'alas', "alack", '''a verse attack'''
</span>
<span class="nb">list</span> <span class="c1"># ['Winken', 'Blinken', 'Nod']
</span><span class="nb">tuple</span> <span class="c1"># (2, 4, 8)
</span>
<span class="nb">bytes</span> <span class="c1"># b'ab\xff'
</span><span class="nb">bytearray</span> <span class="c1"># bytearray(...)
</span>
<span class="nb">set</span> <span class="c1"># set([3, 5, 7])
</span><span class="nb">frozenset</span> <span class="c1"># frozenset(['Elsa', 'Otto'])
</span>
<span class="nb">dict</span> <span class="c1"># {}, {'game': 'bingo', 'dog': 'dingo', 'drummer': 'Ringo'}
</span>
<span class="n">decimal</span><span class="p">.</span><span class="nc">Decimal</span><span class="p">(</span><span class="sh">'</span><span class="s">1.0</span><span class="sh">'</span><span class="p">),</span> <span class="n">fractions</span><span class="p">.</span><span class="nc">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Decimal and fraction extension types</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># int(), float(), bin(), oct(), hex(), chr(), and ord()
</span><span class="nf">int</span><span class="p">(</span><span class="bp">True</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># (1, 0)
</span><span class="nf">int</span><span class="p">(</span><span class="mf">98.6</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="mf">1.0e4</span><span class="p">)</span>  <span class="c1"># (98, 10_000)
</span><span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">99</span><span class="sh">'</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">-23</span><span class="sh">'</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">+12</span><span class="sh">'</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">1_000_000</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># (99, -23, 12, 1_000_000)
</span>
<span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">10</span><span class="sh">'</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="sh">'</span><span class="s">binary</span><span class="sh">'</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">10</span><span class="sh">'</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="sh">'</span><span class="s">octal</span><span class="sh">'</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">10</span><span class="sh">'</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="sh">'</span><span class="s">hexadecimal</span><span class="sh">'</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">10</span><span class="sh">'</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="sh">'</span><span class="s">chesterdigital</span><span class="sh">'</span>
<span class="c1"># (2, 'binary', 8, 'octal', 16, 'hexadecimal', 22, 'chesterdigital')
</span>
<span class="nf">float</span><span class="p">(</span><span class="bp">True</span><span class="p">),</span> <span class="nf">float</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># (1.0, 0.0)
</span><span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">98.6</span><span class="sh">'</span><span class="p">),</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">-1.5</span><span class="sh">'</span><span class="p">),</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">1.0e4</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># (98.6, -1.5, 10_000.0)
</span>
<span class="nf">bin</span><span class="p">(</span><span class="mi">65</span><span class="p">),</span> <span class="nf">oct</span><span class="p">(</span><span class="mi">65</span><span class="p">),</span> <span class="nf">hex</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span>  <span class="c1"># ('0b1000001', '0o101', '0x41')
</span>
<span class="nf">chr</span><span class="p">(</span><span class="mi">65</span><span class="p">),</span> <span class="nf">ord</span><span class="p">(</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ('A', 65)
</span>
<span class="c1"># Python also promotes booleans to integers or floats:
</span><span class="bp">False</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">True</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">False</span> <span class="o">+</span> <span class="mf">0.</span><span class="p">,</span> <span class="bp">True</span> <span class="o">+</span> <span class="mf">0.</span>  <span class="c1"># (0, 1, 0.0, 1.0)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p><a href="https://fastapi.tiangolo.com/python-types/">Type hints</a> (or type annotations)</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># variable_name: type
</span><span class="n">age</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">pi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.14159</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># def func(argument: type) -&gt; type
</span><span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
  <span class="sh">"""</span><span class="s">Greets the provided name.</span><span class="sh">"""</span>
  <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">!</span><span class="sh">"</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># any
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">argument</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">any</span><span class="p">:</span> <span class="bp">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># simple types: all the standard Python types, for example: int, float, bool, bytes
</span><span class="k">def</span> <span class="nf">get_items</span><span class="p">(</span><span class="n">item_a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">item_b</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">item_c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">item_d</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">item_e</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span> <span class="bp">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># generic types with type parameters: like dict, list, set and tuple
# the internal types in the square brackets are called "type parameters".
# Python 3.9+
</span><span class="k">def</span> <span class="nf">process_items</span><span class="p">(</span>
    <span class="n">items_l</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">items_t</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">items_s</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span>
    <span class="n">prices</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">):</span> <span class="bp">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># union: a variable can be any of several types separated by a vetical bar (|)
</span><span class="k">def</span> <span class="nf">process_item</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">):</span> <span class="bp">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># possibly None: a value could have a type, like str, but that it could also be None.
# Python 3.10+
</span><span class="k">def</span> <span class="nf">say_hi</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="bp">None</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Hey </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">!</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Hello World</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># classes as types
</span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>


<span class="k">def</span> <span class="nf">get_person_name</span><span class="p">(</span><span class="n">one_person</span><span class="p">:</span> <span class="n">Person</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">one_person</span><span class="p">.</span><span class="n">name</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># type Hints with Metadata Annotations
# Python 3.9+
</span><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="k">def</span> <span class="nf">say_hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="sh">"</span><span class="s">this is just metadata</span><span class="sh">"</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Hello </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="sh">"</span></code></pre>
</div>
</div>
</li>
<li>
<p>In Python, a name must be bound to an object before it can be used.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># assignment statements
</span><span class="n">spam</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Spam</span><span class="sh">'</span>                   <span class="c1"># simple assignment
</span><span class="n">spam</span><span class="p">,</span> <span class="n">ham</span> <span class="o">=</span> <span class="sh">'</span><span class="s">yum</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">YUM</span><span class="sh">'</span>        <span class="c1"># tuple unpacking
</span><span class="p">[</span><span class="n">spam</span><span class="p">,</span> <span class="n">ham</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">yum</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">YUM</span><span class="sh">'</span><span class="p">]</span>    <span class="c1"># list unpacking
</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>             <span class="c1"># sequence unpacking (each character to a variable)
</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>                  <span class="c1"># extended sequence unpacking (a='s', b=['p', 'a', 'm'])
</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>                  <span class="c1"># use the underscore (_) for unwanted variables
</span><span class="n">spam</span> <span class="o">=</span> <span class="n">ham</span> <span class="o">=</span> <span class="sh">'</span><span class="s">lunch</span><span class="sh">'</span>            <span class="c1"># multiple assignment (both variables refer to the same object)
</span><span class="n">spams</span> <span class="o">+=</span> <span class="mi">42</span>                     <span class="c1"># augmented assignment (equivalent to spams = spams + 42)
</span><span class="n">spam</span> <span class="o">=</span> <span class="n">ham</span> <span class="o">=</span> <span class="n">eggs</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c1"># multiple variable names can be assigned a value at the same time</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># swap variable names
</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>  <span class="c1"># 2, 1</span></code></pre>
</div>
</div>
</li>
<li>
<p>In Python, variables are NOT places, just names, and a name is a <em>reference</em> to an object rather than the object itself, which is a chunk of data that contains at least a <em>type</em>, a unique <em>id</em>, a <em>value</em>, and a <em>reference count</em>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="nf">type</span><span class="p">(</span><span class="mf">5.20</span><span class="p">)</span>  <span class="c1"># &lt;class 'float'&gt;
</span><span class="nf">id</span><span class="p">(</span><span class="mf">5.20</span><span class="p">)</span>    <span class="c1"># 140683748269744
</span><span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sys</span><span class="p">.</span><span class="nf">getrefcount</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># 1000000591
</span><span class="k">del</span> <span class="n">y</span>
<span class="n">sys</span><span class="p">.</span><span class="nf">getrefcount</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># 1000000590
</span><span class="k">del</span> <span class="n">z</span>
<span class="n">sys</span><span class="p">.</span><span class="nf">getrefcount</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># 1000000589</span></code></pre>
</div>
</div>
</li>
<li>
<p>A <em>class</em> is the definition of an object, and "class" and "type" mean pretty much the same thing.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="nf">type</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>             <span class="c1"># &lt;class 'int'&gt;
</span><span class="nf">type</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span>      <span class="c1"># True
</span><span class="nf">isinstance</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>  <span class="c1"># True</span></code></pre>
</div>
</div>
</li>
<li>
<p>Strings, tuples and lists are common built-in sequences, which are zero-based indexing and ordered collections that can store elements of any data types, except strings, which are sequences of characters themselves.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># iteration
</span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">]:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># range
</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># enumeration
</span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">([</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">]):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s">, Item: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># comparisons
</span><span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># True
</span><span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">)</span>         <span class="c1"># True
</span><span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">)</span>          <span class="c1"># True</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># `+`, `*`
</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ('cat', 'dog', 'cattle')
</span><span class="p">(</span><span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">3</span>                 <span class="c1"># ('bark', 'bark', 'bark')</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># unpacking
</span><span class="n">cat</span><span class="p">,</span> <span class="n">dog</span><span class="p">,</span> <span class="n">cattle</span> <span class="o">=</span> <span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># testing with `in`
</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">cat</span><span class="sh">'</span>                        <span class="c1"># True
</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># False</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># indexing, and slicing a shallow copy subsequence:
</span><span class="n">s</span> <span class="o">=</span> <span class="sh">'</span><span class="s">hello!</span><span class="sh">'</span>  <span class="c1"># len(S) is 6
# S[-7], S[6]  # IndexError: string index out of range
</span>
<span class="c1"># The slice expression X[I:J:K] is equivalent to indexing with a slice object: X[slice(I, J, K)]:
#    slice(stop)
#    slice(start, stop[, step])
#
# [:] extracts the entire sequence from start to end.
# [start:] specifies from the start offset to the end.
# [:end] specifies from the beginning to the end offset minus 1.
# [start:end] indicates from the start offset to the end offset minus 1.
# [start:end:step] extracts from the start offset to the end offset minus 1, skipping characters by step.
</span>
<span class="c1"># Indexing (S[i]) fetches components at offsets:
#   The first item is at offset 0.
#   Negative indexes mean to count backward from the end or right.
#     Technically, a negative offset is added to the length of a sequence to derive a positive offset.
#   S[0] fetches the first item.
#   S[−2] fetches the second item from the end (like S[len(S)−2]).
#
# Slicing(S[i:j]) extracts contiguous sections of sequences:
#   The upper bound is noninclusive.
#   Slice boundaries default to 0 and the sequence length, if omitted.
#   S[1:3] fetches items at offsets 1 up to but not including 3.
#   S[1:] fetches items at offset 1 through the end(the sequence length).
#   S[:3] fetches items at offset 0 up to but not including 3.
#   S[:−1] fetches items at offset 0 up to but not including the last item.
#   S[:] fetches items at offsets 0 through the end—making a top-level copy of S.
#
# Extended slicing (S[i:j:k]) accepts a step ( or stride) k, which defaults to + 1:
#   Allows for skipping items and reversing order(using a negative stride).
</span>
<span class="n">s</span><span class="p">[:],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">s</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="n">s</span><span class="p">[:</span><span class="mi">6</span><span class="p">:],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">:],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># ('hello!', 'hello!', 'hello!', 'hello!', 'hello!', 'hello!')
</span><span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># '!olleh'
</span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)],</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># (6, '!', '!', 'h', 'h')</span></code></pre>
</div>
</div>
</li>
<li>
<p>In Python, truthiness and falsiness are used to check a value in a Boolean context:</p>
<div class="ulist">
<ul>
<li>
<p>Truthy: Values that evaluate to <code>True</code>, which includes most non-zero numbers, non-empty strings, lists, dictionaries, and many objects.</p>
</li>
<li>
<p>Falsy: Values that evaluate to <code>False</code>, which include <code>False</code>, zero numbers (<code>0</code>, <code>0.0</code>), empty strings (<code>""</code>), lists (<code>[]</code>), and tuples (<code>()</code>), and <code>None</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">falsy</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="sh">''</span><span class="p">,</span> <span class="p">[],</span> <span class="p">(),</span> <span class="bp">None</span><span class="p">]</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In Python, the logical operators <code>and</code>, <code>or</code>, <code>not</code> are used to combine Boolean values (<code>True</code>/<code>False</code>) or expressions that evaluate to Boolean values.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">letter</span> <span class="o">=</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span>
<span class="k">if</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">a</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">e</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">i</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">u</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="sh">'</span><span class="s">is a vowel</span><span class="sh">'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="sh">'</span><span class="s">is not a vowel</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Python provides bit-level integer operators, similar to those in the C language.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Bitwise operators have lower precedence than arithmetic operators like <code>+</code>, <code>-</code>, <code>*</code>, and <code>/</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The order of precedence for bitwise operators is: <code>~</code>, <code>&lt;&lt;</code> <code>&gt;&gt;</code>, <code>&amp;</code>, <code>^</code>, <code>|</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 0b0101
</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 0b0001
</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">0b</span><span class="si">{</span><span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="mi">04</span><span class="n">b</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># and
# 0b0001
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">0b</span><span class="si">{</span><span class="p">(</span><span class="n">x</span> <span class="o">|</span> <span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="mi">04</span><span class="n">b</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># or
# 0b0101
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">0b</span><span class="si">{</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="mi">04</span><span class="n">b</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># exclusive or
# 0b0100
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">0b</span><span class="si">{</span><span class="o">~</span><span class="n">x</span><span class="si">:</span><span class="mi">04</span><span class="n">b</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>       <span class="c1"># flip bits
# 0b-110
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">0b</span><span class="si">{</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="mi">04</span><span class="n">b</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># left shift
# 0b1010
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">0b</span><span class="si">{</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="mi">04</span><span class="n">b</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># right shift
# 0b0010</span></code></pre>
</div>
</div>
</li>
<li>
<p>Test for equality: <code>==</code> and <code>is</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># The `==` operator tests value equivalence.
#   Python performs an equivalence test, comparing all nested objects recursively.
#
# The `is` operator tests object identity.
#   Python tests whether the two are the same object (i.e., live at the same address in memory).
</span><span class="n">S1</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>
<span class="n">S2</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>
<span class="nf">id</span><span class="p">(</span><span class="n">S1</span><span class="p">),</span> <span class="nf">id</span><span class="p">(</span><span class="n">S2</span><span class="p">),</span> <span class="n">S1</span> <span class="o">==</span> <span class="n">S2</span><span class="p">,</span> <span class="n">S1</span> <span class="ow">is</span> <span class="n">S2</span> <span class="c1"># (4472645872, 4472645872, True, True)
</span>
<span class="n">foo</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">bar</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="nf">id</span><span class="p">(</span><span class="n">foo</span><span class="p">),</span> <span class="nf">id</span><span class="p">(</span><span class="n">bar</span><span class="p">),</span> <span class="n">foo</span> <span class="o">==</span> <span class="n">bar</span><span class="p">,</span> <span class="n">foo</span> <span class="ow">is</span> <span class="n">bar</span> <span class="c1"># (4472786448, 4472786352, True, False)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Division, and modulo: <code>/</code>, <code>//</code>, <code>%</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># True division (/):
#   Always returns a float, even if both operands are integers
#     and the result is a whole number ({0, 1, 2, 3, 4,...}).
</span><span class="mi">10</span>   <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 5.0 (float)
</span><span class="mf">10.0</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 5.0 (float)
</span><span class="mi">11</span>   <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 5.5 (float)
</span>
<span class="c1"># Floor Division (//):
#   If both operands are integers, it
#     returns an int (the floor of the division result).
#   If either operand is a float, it
#     returns a float (the floor of the division result).
</span><span class="mi">10</span>   <span class="o">//</span> <span class="mi">2</span>    <span class="c1"># 5 (int)
</span><span class="mi">11</span>   <span class="o">//</span> <span class="mi">2</span>    <span class="c1"># 5 (int)
</span><span class="mf">11.0</span> <span class="o">//</span> <span class="mi">2</span>    <span class="c1"># 5.0 (float)
</span><span class="mi">11</span>   <span class="o">//</span> <span class="mf">2.0</span>  <span class="c1"># 5.0 (float)
</span><span class="o">-</span><span class="mi">11</span>  <span class="o">//</span> <span class="mi">2</span>    <span class="c1"># -6 (int - floor division towards negative infinity)
</span>
<span class="c1"># Modulo Operator (%): the remainder of a division
#   If both operands are integers, it
#     returns an int.
#   If either operand is a float, it
#     returns a float.
</span><span class="mi">10</span>   <span class="o">%</span> <span class="mi">3</span>     <span class="c1">#  1 (int)
</span><span class="mf">10.0</span> <span class="o">%</span> <span class="mi">3</span>     <span class="c1">#  1.0 (float)
</span><span class="mi">10</span>   <span class="o">%</span> <span class="mf">3.0</span>   <span class="c1">#  1.0 (float)
</span><span class="o">-</span><span class="mi">10</span>  <span class="o">%</span> <span class="mi">3</span>     <span class="c1">#  2 (int)
</span><span class="mi">10</span>   <span class="o">%</span> <span class="o">-</span><span class="mi">3</span>    <span class="c1">#  -2 (int)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="strings-bytes-and-bytearray">5. Strings, bytes and bytearray</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In Python 3.X there are three string types: <code>str</code> is used for Unicode text (including ASCII), <code>bytes</code> is used for binary data (including encoded text), and <code>bytearray</code> is a mutable variant of bytes.</p>
</div>
<div class="paragraph">
<p>Files work in two modes: <em>text</em>, which represents content as <code>str</code> and implements Unicode encodings, and <code>binary</code>, which deals in raw bytes and does no data translation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>UTF-8 is the standard text encoding in Python, Linux, and HTML.</p>
<div class="paragraph">
<p>Ken Thompson and Rob Pike, whose names will be familiar to Unix developers, designed the UTF-8 dynamic encoding scheme one night on a placemat in a New Jersey diner. It uses one to four bytes per Unicode character:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>One byte for ASCII</p>
</li>
<li>
<p>Two bytes for most Latin-derived (but not Cyrillic) languages</p>
</li>
<li>
<p>Three bytes for the rest of the basic multilingual plane</p>
</li>
<li>
<p>Four bytes for the rest, including some Asian languages and symbols</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">cafe</span> <span class="o">=</span> <span class="sh">'</span><span class="s">café</span><span class="sh">'</span>

<span class="c1"># len() function on string counts Unicode characters, not bytes:
</span><span class="nf">len</span><span class="p">(</span><span class="n">cafe</span><span class="p">)</span>  <span class="c1"># 4
</span>
<span class="n">cafe_bytes</span> <span class="o">=</span> <span class="n">cafe</span><span class="p">.</span><span class="nf">encode</span><span class="p">()</span>  <span class="c1"># b'caf\xc3\xa9'
</span>
<span class="c1"># len() returns the number of bytes:
</span><span class="nf">len</span><span class="p">(</span><span class="n">cafe_bytes</span><span class="p">)</span>  <span class="c1"># 5
</span>
<span class="n">cafe_text</span> <span class="o">=</span> <span class="n">cafe_bytes</span><span class="p">.</span><span class="nf">decode</span><span class="p">()</span>  <span class="c1"># 'café'</span></code></pre>
</div>
</div>
</li>
<li>
<p>Strings are created by enclosing characters in matching single, double, or triple quotes:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="sh">'</span><span class="s">Snap</span><span class="sh">'</span>
<span class="sh">"</span><span class="s">Crackle</span><span class="sh">"</span>
<span class="sh">"'</span><span class="s">Nay!</span><span class="sh">'</span><span class="s"> said the naysayer. </span><span class="sh">'</span><span class="s">Neigh?</span><span class="sh">'</span><span class="s"> said the horse.</span><span class="sh">"</span>
<span class="sh">'</span><span class="s">The rare double quote in captivity: </span><span class="sh">"</span><span class="s">.</span><span class="sh">'</span>
<span class="sh">'''</span><span class="s">Boom!</span><span class="sh">'''</span>
<span class="sh">"""</span><span class="s">Eek!</span><span class="sh">"""</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Triple quotes are very useful to create multiline strings, like this classic poem from Edward Lear:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">poem</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">There was a Young Lady of Norway,
    Who casually sat in a doorway;
    When the door squeezed her flat,
    She exclaimed, </span><span class="sh">"</span><span class="s">What of that?</span><span class="sh">"</span><span class="s">
    This courageous Young Lady of Norway.</span><span class="sh">'''</span>
<span class="nf">print</span><span class="p">(</span><span class="n">poem</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">There was a Young Lady of Norway,
</span><span class="gp">    Who casually sat in a doorway;</span><span class="w">
</span><span class="go">    When the door squeezed her flat,
    She exclaimed, "What of that?"
    This courageous Young Lady of Norway.</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># the line ending characters, and leading or trailing spaces are preserved as below:
</span><span class="sh">'</span><span class="s">There was a Young Lady of Norway,</span><span class="se">\n</span><span class="s">    Who casually sat in a doorway;</span><span class="se">\n</span><span class="s">    When the door squeezed her flat,</span><span class="se">\n</span><span class="s">    She exclaimed, </span><span class="sh">"</span><span class="s">What of that?</span><span class="sh">"</span><span class="se">\n</span><span class="s">    This courageous Young Lady of Norway.</span><span class="sh">'</span></code></pre>
</div>
</div>
</li>
<li>
<p>Escape with <code>\</code>, combine by using <code>+</code>, duplicate with <code>*</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">hi</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Na </span><span class="sh">'</span> <span class="sh">'</span><span class="s">Na </span><span class="sh">'</span> <span class="sh">'</span><span class="s">Na </span><span class="sh">'</span> <span class="sh">'</span><span class="s">Na </span><span class="sh">'</span> \ <span class="c1"># literal strings (not string variables) just one after the other
</span>    <span class="o">+</span> <span class="sh">'</span><span class="s">Hey </span><span class="sh">'</span> <span class="o">*</span> <span class="mi">4</span> \
    <span class="o">+</span> <span class="sh">'</span><span class="se">\\</span><span class="sh">'</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\t</span><span class="sh">'</span> <span class="o">+</span> <span class="sh">'</span><span class="s">Goodbye.</span><span class="sh">'</span>
<span class="nf">print</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>  <span class="c1"># Na Na Na Na Hey Hey Hey Hey \	Goodbye.</span></code></pre>
</div>
</div>
</li>
<li>
<p>In Python, adjacent string literals (inside parentheses) are automatically concatenated into a single string.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">s</span> <span class="o">=</span> <span class="sh">"</span><span class="s">foo</span><span class="sh">"</span> <span class="sh">"</span><span class="s">bar</span><span class="sh">"</span> <span class="sh">"</span><span class="s">buz</span><span class="sh">"</span>
<span class="nf">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1"># foobarbuz</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">s</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sh">"</span><span class="s">Hello, </span><span class="sh">"</span>
    <span class="sh">"</span><span class="s">this is an example </span><span class="sh">"</span>
    <span class="sh">"</span><span class="s">of string concatenation with a very looooooooooooooong text.</span><span class="sh">"</span>
<span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1"># Hello, this is an example of string concatenation with a very looooooooooooooong text.</span></code></pre>
</div>
</div>
</li>
<li>
<p>Python has a few special types of strings, indicated by a letter before the first quote.</p>
<div class="ulist">
<ul>
<li>
<p><code>f</code> or <code>F</code> starts an <em>f-string</em>, used for formatting.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">thing</span> <span class="o">=</span> <span class="sh">'</span><span class="s">wereduck</span><span class="sh">'</span>
<span class="n">place</span> <span class="o">=</span> <span class="sh">'</span><span class="s">werepond</span><span class="sh">'</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">The </span><span class="si">{</span><span class="n">thing</span><span class="si">}</span><span class="s"> is in the </span><span class="si">{</span><span class="n">place</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 'The wereduck is in the werepond'</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>r</code> or <code>R</code> starts a raw string, used to prevent escape sequences in the string.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">info</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'</span><span class="s">Type a \n to get a new line</span><span class="sh">'</span>  <span class="c1"># info = 'Type a \\n to get a new line'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># raw string does not undo any real (not `\n`) newlines:
</span><span class="n">poem</span> <span class="o">=</span> <span class="sa">r</span><span class="sh">'''</span><span class="s">Boys and girls, come out to play.
The moon doth shine as bright as day.</span><span class="sh">'''</span>
<span class="nf">print</span><span class="p">(</span><span class="n">poem</span><span class="p">)</span> <span class="c1"># 'Boys and girls, come out to play.\nThe moon doth shine as bright as day.'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">Boys and girls, come out to play.
The moon doth shine as bright as day.</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>fr</code> (or <code>FR</code>, <code>Fr</code>, or <code>fR</code>), the combination, that starts a raw f-string.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">hello</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Hello</span><span class="sh">'</span>
<span class="n">world</span> <span class="o">=</span> <span class="sh">'</span><span class="s">世界</span><span class="sh">'</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">fr</span><span class="sh">'</span><span class="si">{</span><span class="n">hello</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">world</span><span class="si">}</span><span class="s">!</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Hello, 世界!</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>u</code> starts a Unicode string, which is the same as a plain string.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Python 3 strings are Unicode character sequences, not byte arrays.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">hi</span> <span class="o">=</span> <span class="sa">u</span><span class="sh">'</span><span class="s">Hello, 世界!</span><span class="sh">'</span>  <span class="c1"># same as: hi = 'Hello, 世界!'</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>b</code> starts a value of type bytes.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">ip</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\x14\xcd\xf3\xa6</span><span class="sh">'</span>
<span class="nf">list</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="c1"># [20, 205, 243, 166]</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Python has three ways of formatting strings.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">actor</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Richard Gere</span><span class="sh">'</span>
<span class="n">cat</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Chester</span><span class="sh">'</span>
<span class="n">weight</span> <span class="o">=</span> <span class="mi">28</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># old style (supported in Python 2 and 3): format_string % data
</span><span class="sh">'</span><span class="s">My wife</span><span class="se">\'</span><span class="s">s favorite actor is %s</span><span class="sh">'</span> <span class="o">%</span> <span class="n">actor</span>  <span class="c1"># "My wife's favorite actor is Richard Gere"
</span><span class="sh">'</span><span class="s">Our cat %s weighs %d pounds</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>  <span class="c1"># 'Our cat Chester weighs 28 pounds'
</span><span class="sh">'</span><span class="s">Our cat %(cat)s weighs %(weight)d pounds</span><span class="sh">'</span> <span class="o">%</span> <span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="n">cat</span><span class="p">,</span> <span class="sh">'</span><span class="s">weight</span><span class="sh">'</span><span class="p">:</span> <span class="n">weight</span><span class="p">}</span>  <span class="c1"># dictionary-based expressions</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># new style (Python 2.6 and up): format_string.format(data)
</span><span class="sh">'</span><span class="s">{0}, {1} and {2}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># By position
</span><span class="sh">'</span><span class="s">{motto}, {pork} and {food}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">motto</span><span class="o">=</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="n">pork</span><span class="o">=</span><span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">,</span> <span class="n">food</span><span class="o">=</span><span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># By keyword
</span><span class="sh">'</span><span class="s">{motto}, {0} and {food}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">,</span> <span class="n">motto</span><span class="o">=</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="n">food</span><span class="o">=</span><span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># By both
</span><span class="sh">'</span><span class="s">{}, {} and {}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># By relative position
# 'spam, ham and eggs'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># f-strings (Python 3.6 and up): f, F
</span><span class="sa">f</span><span class="sh">'</span><span class="s">Our cat </span><span class="si">{</span><span class="n">cat</span><span class="si">}</span><span class="s"> weighs </span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s"> pounds</span><span class="sh">'</span>  <span class="c1"># 'Our cat Chester weighs 28 pounds'</span></code></pre>
</div>
</div>
</li>
<li>
<p>Python 3 introduced the following sequences of eight-bit integers, with possible values from 0 to 255, in two types:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>bytes</code> is immutable, like a tuple of bytes</p>
</li>
<li>
<p><code>bytearray</code> is mutable, like a list of bytes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Endian order refers to the byte order used to store multi-byte values (like integers, floats) in computer memory.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Big-Endian: In big-endian order, the most significant byte (MSB) of a multi-byte value is stored at the beginning (lower memory address) of the allocated space. The remaining bytes follow in decreasing order of significance.</p>
</li>
<li>
<p>Little-Endian: In little-endian order, the least significant byte (LSB) is stored at the beginning (lower memory address), followed by bytes of increasing significance.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">blist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span>

<span class="n">the_bytes</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">blist</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">the_bytes</span><span class="p">)</span>
<span class="c1"># b'\x01\x02\x03\xff'
</span>
<span class="n">the_byte_array</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">(</span><span class="n">blist</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">the_byte_array</span><span class="p">)</span>
<span class="c1"># bytearray(b'\x01\x02\x03\xff')
</span>
<span class="n">the_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span>  <span class="c1"># TypeError: 'bytes' object does not support item assignment
</span>
<span class="n">the_byte_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span>

<span class="n">the_byte_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">256</span>  <span class="c1"># ValueError: byte must be in range(0, 256)
</span>
<span class="n">the_bytes</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">the_bytes</span><span class="p">),</span> <span class="mi">16</span><span class="p">):</span>
    <span class="n">end_index</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">the_bytes</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">the_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">end_index</span><span class="p">])</span>
<span class="c1"># b'\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f'
# b'\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f'
# b' !"#$%&amp;\'()*+,-./'
# b'0123456789:;&lt;=&gt;?'
# b'@ABCDEFGHIJKLMNO'
# b'PQRSTUVWXYZ[\\]^_'
# b'`abcdefghijklmno'
# b'pqrstuvwxyz{|}~\x7f'
# b'\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f'
# b'\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f'
# b'\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf'
# b'\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf'
# b'\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf'
# b'\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf'
# b'\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef'
# b'\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff'</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>regular expressions: pattern matching, substitution, and splitting</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">re</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">p</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Les Fleurs du Mal</span><span class="sh">'</span>  <span class="c1"># pattern
</span><span class="n">c</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># compile
</span><span class="n">s</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Charles Baudelaire</span><span class="sh">'</span><span class="s">s </span><span class="sh">'</span><span class="s">Les Fleurs du Mal</span><span class="sh">'"</span>  <span class="c1"># source
</span><span class="n">m</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># match
</span><span class="k">if</span> <span class="n">m</span><span class="p">:</span>  <span class="c1"># m != None
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Mon cœur est comme une feuille sèche, emportée par le vent...</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">'</span><span class="s">Les Fleurs du Mal</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># find exact beginning match with match()
</span><span class="nf">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># return a Match object
# None
</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sh">'</span><span class="s">Les Fleurs du Mal</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># find first match with search()
</span><span class="nf">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># return a Match object
# &lt;re.Match object; span=(22, 39), match='Les Fleurs du Mal'&gt;
</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="sh">'</span><span class="s">es</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># find all matches with findall()
</span><span class="nf">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># return a list
# ['es', 'es']
</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">\s</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># split at matches with split()
</span><span class="nf">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># return a list
# ['Charles', "Baudelaire's", "'Les", 'Fleurs', 'du', "Mal'"]
</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sh">"'"</span><span class="p">,</span> <span class="sh">'</span><span class="s">?</span><span class="sh">'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># replace at matches with sub()
</span><span class="nf">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># return a string
# Charles Baudelaire?s ?Les Fleurs du Mal?</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="if-while-and-for">6. If, while, and for</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In Python (version 3.8 and above), the walrus operator (<code>:=</code>, formally known as the assignment expression operator) combines assignment and expression evaluation in a single line.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">tweet_limit</span> <span class="o">=</span> <span class="mi">280</span>
<span class="n">tweet_string</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Blah</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">50</span>
<span class="k">if</span> <span class="n">diff</span> <span class="p">:</span><span class="o">=</span> <span class="n">tweet_limit</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">tweet_string</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># walrus operator
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">A fitting tweet</span><span class="sh">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Went over by</span><span class="sh">"</span><span class="p">,</span> <span class="nf">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span></code></pre>
</div>
</div>
</li>
<li>
<p>Compare with <code>if</code>, <code>elif</code>, and <code>else</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">color</span> <span class="o">=</span> <span class="sh">"</span><span class="s">mauve</span><span class="sh">"</span>
<span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="sh">"</span><span class="s">red</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">It</span><span class="sh">'</span><span class="s">s a tomato</span><span class="sh">"</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">color</span> <span class="o">==</span> <span class="sh">"</span><span class="s">green</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">It</span><span class="sh">'</span><span class="s">s a green pepper</span><span class="sh">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">ve never heard of the color</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>if</code>/<code>else</code> ternary expression:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Python runs expression Y only if X turns out to be true, and runs expression Z only if X turns out to be false.
# A = Y if X else Z  # equivalent to `((X and Y) or Z)`
</span><span class="n">A</span> <span class="o">=</span> <span class="sh">'</span><span class="s">t</span><span class="sh">'</span> <span class="k">if</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span> <span class="k">else</span> <span class="sh">'</span><span class="s">f</span><span class="sh">'</span>  <span class="c1"># (('spam' and 't') or 'f')
</span><span class="n">A</span>  <span class="c1"># 't'</span></code></pre>
</div>
</div>
</li>
<li>
<p>It is also possible to chain comparisons:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">if</span> <span class="mi">4</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># True
</span>    <span class="bp">...</span></code></pre>
</div>
</div>
</li>
<li>
<p>Dictionary-based multiway branching:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Handling switch defaults
</span><span class="n">branch</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
          <span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">:</span> <span class="mf">1.99</span><span class="p">,</span>
          <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">}</span>
<span class="nf">print</span><span class="p">(</span><span class="n">branch</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bad choice</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># 1.25
</span><span class="nf">print</span><span class="p">(</span><span class="n">branch</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">bacon</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bad choice</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># Bad choice
# membership test in an if statement can have the same default effect:
</span><span class="n">choice</span> <span class="o">=</span> <span class="sh">'</span><span class="s">bacon</span><span class="sh">'</span>
<span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">branch</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Bad choice</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Bad choice
</span>
<span class="c1"># handle defaults by catching and handling the exceptions they'd otherwise trigger:
</span><span class="k">try</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>
<span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Bad choice</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Handling larger actions
</span><span class="n">branch</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">...,</span>  <span class="c1"># A table of callable function objects
</span>          <span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">:</span> <span class="n">function</span><span class="p">,</span>
          <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">...}</span>
<span class="n">branch</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">default</span><span class="p">)()</span></code></pre>
</div>
</div>
</li>
<li>
<p>Repeat with <code>while</code>, and <code>break</code>, <code>continue</code>, and <code>else</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Integer, please [q to quit]: </span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">:</span>  <span class="c1"># quit
</span>        <span class="k">break</span>
    <span class="n">number</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># an even number
</span>        <span class="k">continue</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="sh">"</span><span class="s">squared is</span><span class="sh">"</span><span class="p">,</span> <span class="n">number</span><span class="o">*</span><span class="n">number</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">while</span> <span class="n">x</span><span class="p">:</span>  <span class="c1"># Exit when x empty
</span>    <span class="k">if</span> <span class="nf">match</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># Value at front?
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Ni</span><span class="sh">'</span><span class="p">)</span>
        <span class="k">break</span>  <span class="c1"># Exit, go around else
</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># Slice off front and repeat
</span><span class="k">else</span><span class="p">:</span>  <span class="c1"># break not called
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Not found</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Only here if exhausted x</span></code></pre>
</div>
</div>
</li>
<li>
<p>Iterate with <code>for</code>/<code>in</code>, and <code>break</code>, <code>continue</code> and <code>else</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">word</span> <span class="o">=</span> <span class="sh">'</span><span class="s">thud</span><span class="sh">'</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">word</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">u</span><span class="sh">'</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">word</span> <span class="o">=</span> <span class="sh">'</span><span class="s">thud</span><span class="sh">'</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">word</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">letter</span> <span class="o">==</span> <span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Eek! An </span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="s">!</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>  <span class="c1"># break not called
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">No </span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="s"> in there.</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># counter loops: range
</span><span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>  <span class="c1"># 0 2 ... 8
</span>
<span class="c1"># reverse loops: range
</span><span class="n">spam</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">spam</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">spam</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># (3, 'm')	(2, 'a')	(1, 'p')	(0, 's')</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># generating both offsets and items: enumerate
</span><span class="nf">for </span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 0: s	1: p	2: a	3: m</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># parallel traversals: zip
</span><span class="k">for</span> <span class="n">nums</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>  <span class="c1"># (0, 1) (2, 3) .. (8, 9)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># unpack sequence elements into variables
</span><span class="n">nums</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="c1"># 1 2
# 3 4
# 5 6</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tuples-and-lists">7. Tuples and lists</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Tuples</strong> are built-in immutable sequences.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># to make a tuple with one or more elements, follow each element with a comma (`,`):
</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># ('cat',)
</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span>  <span class="c1"># ('cat', 'dog', 'cattle')
</span>
<span class="c1"># to make an empty tuple, using `()`, or `tuple()`:
</span><span class="p">()</span>  <span class="c1"># ()
</span><span class="nf">tuple</span><span class="p">()</span>  <span class="c1"># ()
</span>
<span class="c1"># the comma is required to make a tuple
</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 'cat'
</span>
<span class="c1"># the parentheses is not required, but could make the tuple more visible
</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,)</span>  <span class="c1"># ('cat',)
</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ('cat', 'dog', 'cattle')
</span>
<span class="c1"># for cases in which commas might also have another use, the parentheses is needed
</span><span class="nf">type</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,)</span>  <span class="c1"># &lt;class 'str'&gt;
</span><span class="nf">type</span><span class="p">((</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,))</span>  <span class="c1"># &lt;class 'tuple'&gt;
</span>
<span class="c1"># tuple()
</span><span class="nf">tuple</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ('c', 'a', 't')
</span>
<span class="c1"># zip()
</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">chicken</span><span class="sh">'</span><span class="p">)):</span>
     <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># (1, 1, 'cat')
# (2, 4, 'dog')
# (8, 9, 'cattle')
</span>
<span class="c1"># generator expression
</span><span class="n">nums</span> <span class="o">=</span> <span class="nf">tuple</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># (0, 1, 2, 3, 4, 5, 6, 7, 8, 9)
</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nums</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># &lt;generator object &lt;genexpr&gt; at 0x7fcd7069b920&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># named tuples are a tuple/class/dictionary hybrid.
</span><span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>  <span class="c1"># import extension type
</span><span class="n">Rec</span> <span class="o">=</span> <span class="nf">namedtuple</span><span class="p">(</span><span class="sh">'</span><span class="s">Rec</span><span class="sh">'</span><span class="p">,</span> <span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">jobs</span><span class="sh">'</span><span class="p">])</span>  <span class="c1"># make a generated class
</span><span class="n">bob</span> <span class="o">=</span> <span class="nc">Rec</span><span class="p">(</span><span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mf">40.5</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">dev</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">mgr</span><span class="sh">'</span><span class="p">])</span>  <span class="c1"># a named-tuple record
</span><span class="nf">print</span><span class="p">(</span><span class="n">bob</span><span class="p">)</span>
<span class="c1"># Rec(name='Bob', age=40.5, jobs=['dev', 'mgr'])
</span>
<span class="n">bob</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bob</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># access by position
# ('Bob', ['dev', 'mgr'])
</span>
<span class="n">bob</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">bob</span><span class="p">.</span><span class="n">jobs</span>  <span class="c1"># access by attribute
# ('Bob', ['dev', 'mgr'])
</span>
<span class="c1"># converting to a dictionary supports key-based behavior when needed:
</span><span class="n">x</span> <span class="o">=</span> <span class="n">bob</span><span class="p">.</span><span class="nf">_asdict</span><span class="p">()</span>  <span class="c1"># dictionary-like form
</span><span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="sh">'</span><span class="s">jobs</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># access by key too
# ('Bob', ['dev', 'mgr'])
</span>
<span class="nf">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># &lt;class 'dict'&gt;
</span><span class="n">x</span>
<span class="c1"># {'name': 'Bob', 'age': 40.5, 'jobs': ['dev', 'mgr']}</span></code></pre>
</div>
</div>
</li>
<li>
<p><strong>Lists</strong> are built-in mutable sequences.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># create with `[]` or `list()`
</span><span class="p">[]</span>  <span class="c1"># []
</span><span class="p">[</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># ['meow', 'bark', 'moo']
</span><span class="p">[(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">),</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># [('cat', 'meow'), 'bark', 'moo']
</span><span class="nf">list</span><span class="p">()</span>  <span class="c1"># []
</span><span class="nf">list</span><span class="p">(</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ['c', 'a', 't']
</span>
<span class="c1"># append(), insert(), extend()
</span><span class="n">wow</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># ['meow']
</span><span class="n">wow</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ['meow', 'moo']
</span><span class="n">wow</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ['meow', 'bark', 'moo']
</span><span class="n">wow</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="sh">'</span><span class="s">cluck</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">baa</span><span class="sh">'</span><span class="p">])</span> <span class="c1"># ['meow', 'bark', 'moo', 'cluck', 'baa']
</span>
<span class="c1"># plus(+), repeat(*)
</span><span class="n">plus</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sh">'</span><span class="s">cluck</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">baa</span><span class="sh">'</span><span class="p">]</span> <span class="c1"># ['meow', 'bark', 'moo', 'cluck', 'baa']
</span><span class="n">repeat</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="c1"># ['bark', 'bark', 'bark']
</span>
<span class="c1"># index, and slice assignment
</span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Spam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">SPAM!</span><span class="sh">'</span><span class="p">]</span>
<span class="c1"># index assignment
</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span>  <span class="c1"># ['spam', 'eggs', 'SPAM!']
# slice assignment: delete+insert  # list[start:stop:step] = iterable
#   if the iterable is shorter, elements are deleted from the slice.
#   if the iterable is longer, extra elements are inserted.
</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">eat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">more</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># ['eat', 'more', 'SPAM!']
</span>
<span class="c1"># del, remove(), pop(), clear()
</span><span class="n">farm</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">chicken</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">duck</span><span class="sh">'</span><span class="p">]</span>

<span class="k">del</span> <span class="n">farm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># ['cat', 'dog', 'cattle', 'chicken']
</span>
<span class="n">farm</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># ['cat', 'cattle', 'chicken']
</span>
<span class="c1"># pop: remove and return item at index (default last).
</span><span class="n">farm</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>  <span class="c1"># 'chicken'
# ['cat', 'cattle']
</span>
<span class="n">farm</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 'cattle'
# ['cat']
</span>
<span class="n">farm</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
<span class="c1"># []
</span>
<span class="c1"># sort() and sorted()
</span><span class="n">farm</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">]</span>

<span class="c1"># a sorted copy
</span><span class="nf">sorted</span><span class="p">(</span><span class="n">farm</span><span class="p">)</span>  <span class="c1"># ['cat', 'cattle', 'dog']
</span><span class="nf">print</span><span class="p">(</span><span class="n">farm</span><span class="p">)</span>  <span class="c1"># ['cat', 'dog', 'cattle']
</span>
<span class="c1"># sorting in-place
</span><span class="n">farm</span><span class="p">.</span><span class="nf">sort</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">farm</span><span class="p">)</span>  <span class="c1"># ['cat', 'cattle', 'dog']
</span>
<span class="c1"># shallow copy: any changes made to the elements within the original list will also be reflected in the copy.
</span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">],</span> <span class="p">[</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">]]</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>  <span class="c1"># equivalent to list slicing ([:] )but might be slightly less efficient.
</span><span class="n">d</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1"># deep copy: changes to elements within the original list won't affect the copy (and vice versa) because they point to different objects in memory.
</span><span class="kn">import</span> <span class="n">copy</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="nf">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span>
<span class="n">a</span>  <span class="c1"># [['cat', 'moo'], ['dog', 'bark']]
</span><span class="n">b</span>  <span class="c1"># [['cat', 'moo'], ['dog', 'bark']]
</span><span class="n">c</span>  <span class="c1"># [['cat', 'moo'], ['dog', 'bark']]
</span><span class="n">d</span>  <span class="c1"># [['cat', 'moo'], ['dog', 'bark']]
</span>
<span class="n">e</span>  <span class="c1"># [['cat', 'meow'], ['dog', 'bark']]
</span>
<span class="c1"># list comprehensions: [expression for item in iterable]
</span><span class="n">even_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="c1"># [0, 2, 4, 6, 8]
# list comprehensions: [expression for item in iterable if condition]
</span><span class="n">odd_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1"># [1, 3, 5, 7, 9]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># from collections import deque
</span><span class="n">q</span> <span class="o">=</span> <span class="nf">deque</span><span class="p">([],</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">q</span><span class="p">.</span><span class="n">maxlen</span>  <span class="c1"># 5
</span><span class="n">q</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># deque([0], maxlen=5)
</span><span class="n">q</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># deque([0, 1, 2], maxlen=5)
</span><span class="n">q</span><span class="p">.</span><span class="nf">extendleft</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># deque([4, 3, 0, 1, 2], maxlen=5)
</span><span class="n">q</span><span class="p">.</span><span class="nf">appendleft</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># deque([5, 4, 3, 0, 1], maxlen=5)
</span><span class="n">q</span><span class="p">.</span><span class="nf">pop</span><span class="p">()</span>  <span class="c1"># 1
</span><span class="n">q</span><span class="p">.</span><span class="nf">popleft</span><span class="p">()</span>  <span class="c1"># 5</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dictionaries-and-sets">8. Dictionaries and sets</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In Python, keys in dictionaries (dict) and elements in sets must be of immutable, or hashable data types.</p>
</div>
<div class="paragraph">
<p>The <code>hash()</code> built-in function works directly with built-in types and falls back to calling <code>__hash__</code> for user-defined types.</p>
</div>
<div class="paragraph">
<p>If a user-defined class doesn&#8217;t explicitly define the <code>__hash__</code> method, Python falls back to hashing the object&#8217;s identity, the memory address. However, the hash values will be unpredictable that based on the object&#8217;s memory location, which can change depending on various factors (e.g., memory allocation, garbage collection).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nc">Foo</span><span class="p">(),</span> <span class="nc">Foo</span><span class="p">()</span>
<span class="nf">id</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nf">id</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># (4346584704, 4345722384)
</span><span class="nf">hash</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nf">hash</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># (271661544, 271607649)</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Dictionaries</strong> <em>(hash maps or associative arrays)</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># dictionaries are sometimes called hash maps or associative arrays
</span><span class="p">{}</span>  <span class="c1"># {}
</span><span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">}</span>  <span class="c1"># {'cat': 'meow', 'dog': 'bark'}
</span>
<span class="c1"># dict(): keyword argument names need to be legal variable names (no spaces, no reserved words)
</span><span class="nf">dict</span><span class="p">(</span><span class="n">cat</span><span class="o">=</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="n">dog</span><span class="o">=</span><span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># {'cat': 'meow', 'dog': 'bark'}
</span>
<span class="c1"># dict(): zipping together sequences of keys and values into a dictionary
</span><span class="nf">dict</span><span class="p">([[</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">],</span> <span class="p">[</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">]])</span>  <span class="c1"># {'cat': 'meow', 'dog': 'bark'}
</span>
<span class="c1"># [key], get()
</span><span class="n">animals</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">}</span>
<span class="n">animals</span><span class="p">[</span><span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span>  <span class="c1"># {'cat': 'meow', 'dog': 'bark', 'cattle': 'moo'}
</span><span class="n">animals</span><span class="p">[</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># 'meow'
</span><span class="n">animals</span><span class="p">[</span><span class="sh">'</span><span class="s">sheep</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># KeyError: 'sheep'
</span><span class="n">animals</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">sheep</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># None
</span><span class="n">animals</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">sheep</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">baa</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 'baa'
</span>
<span class="c1"># testing
</span><span class="n">animals</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">}</span>
<span class="sh">'</span><span class="s">cat</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">animals</span>  <span class="c1"># True
</span><span class="sh">'</span><span class="s">sheep</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">animals</span>  <span class="c1"># False
</span><span class="n">animals</span><span class="p">[</span><span class="sh">'</span><span class="s">sheep</span><span class="sh">'</span><span class="p">]</span> <span class="k">if</span> <span class="sh">'</span><span class="s">sheep</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">animals</span> <span class="k">else</span> <span class="sh">'</span><span class="s">oops!</span><span class="sh">'</span>  <span class="c1"># 'oops!'
</span>
<span class="c1"># keys(), values(), items(), len()
</span><span class="n">animals</span><span class="p">.</span><span class="nf">keys</span><span class="p">()</span>  <span class="c1"># dict_keys(['cat', 'dog', 'cattle'])
</span><span class="n">animals</span><span class="p">.</span><span class="nf">values</span><span class="p">()</span>  <span class="c1"># dict_values(['meow', 'bark', 'moo'])
</span><span class="n">animals</span><span class="p">.</span><span class="nf">items</span><span class="p">()</span>  <span class="c1"># dict_items([('cat', 'meow'), ('dog', 'bark'), ('cattle', 'moo')])
</span><span class="nf">len</span><span class="p">(</span><span class="n">animals</span><span class="p">)</span>  <span class="c1"># 3
</span>
<span class="c1"># `**`, update()
</span><span class="p">{</span><span class="o">**</span><span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">},</span> <span class="o">**</span><span class="p">{</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">}}</span>  <span class="c1"># {'cat': 'meow', 'dog': 'bark'}
</span><span class="n">animals</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">}</span>
<span class="n">animals</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">})</span>  <span class="c1"># {'cat': 'meow', 'dog': 'bark'}
</span>
<span class="c1"># del, pop(), clear()
</span><span class="n">animals</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">}</span>
<span class="k">del</span> <span class="n">animals</span><span class="p">[</span><span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">]</span>
<span class="c1"># {'cat': 'meow', 'cattle': 'moo'}
</span><span class="n">animals</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 'moo'
# {'cat': 'meow'}
</span><span class="n">animals</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
<span class="c1"># {}
</span>
<span class="c1"># iterations
</span><span class="n">animals</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">animals</span><span class="p">:</span>  <span class="c1"># for key in animals.keys()
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s"> =&gt; </span><span class="si">{</span><span class="n">animals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># cat =&gt; meow	dog =&gt; bark	cattle =&gt; moo
</span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">animals</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s"> =&gt; </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># cat =&gt; meow     dog =&gt; bark     cattle =&gt; moo
</span>
<span class="c1"># dictionary comprehensions: {key_expression : value_expression for expression in iterable}
</span><span class="n">word</span> <span class="o">=</span> <span class="sh">'</span><span class="s">letters</span><span class="sh">'</span>
<span class="n">letter_counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">letter</span><span class="p">:</span> <span class="n">word</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">word</span><span class="p">}</span>
<span class="c1"># {'l': 1, 'e': 2, 't': 2, 'r': 1, 's': 1}
</span>
<span class="c1"># dictionary comprehensions: {key_expression : value_expression for expression in iterable if condition}
</span><span class="n">vowels</span> <span class="o">=</span> <span class="sh">'</span><span class="s">aeiou</span><span class="sh">'</span>
<span class="n">word</span> <span class="o">=</span> <span class="sh">'</span><span class="s">onomatopoeia</span><span class="sh">'</span>
<span class="n">vowel_counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">letter</span><span class="p">:</span> <span class="n">word</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nf">set</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">if</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">vowels</span><span class="p">}</span>
<span class="c1"># {'i': 1, 'o': 4, 'a': 2, 'e': 1}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># setdefault()
</span><span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">extend</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># KeyError: 0
</span><span class="n">d</span><span class="p">.</span><span class="nf">setdefault</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[]).</span><span class="nf">extend</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># [0, 1, 2, 3, 4]
</span>
<span class="c1"># from collections import defaultdict  # defaultdict(default_factory=None, /, [...])
</span><span class="nf">dict</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># KeyError: 0
</span><span class="nf">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># []
</span><span class="nf">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># 0
</span><span class="nf">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 0.0
</span><span class="nf">defaultdict</span><span class="p">(</span><span class="nb">str</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># ''</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># from collections import Counter  # Counter(iterable=None, /, **kwds)
#  Dict subclass for counting hashable items.  Sometimes called a bag
#  or multiset.  Elements are stored as dictionary keys and their counts
#  are stored as dictionary values.
</span>
<span class="n">word</span> <span class="o">=</span> <span class="sh">'</span><span class="s">abcdeabcdabcaba</span><span class="sh">'</span>
<span class="c1"># {letter: word.count(letter) for letter in set(word)}  # {'e': 1, 'a': 5, 'c': 3, 'd': 2, 'b': 4}
</span><span class="n">c</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>  <span class="c1"># Counter({'a': 5, 'b': 4, 'c': 3, 'd': 2, 'e': 1})
</span><span class="n">c</span><span class="p">.</span><span class="nf">elements</span><span class="p">()</span>  <span class="c1"># ['a', 'a', 'a', 'a', 'a', 'b', 'b', 'b', 'b', 'c', 'c', 'c', 'd', 'd', 'e']
</span><span class="n">c</span><span class="p">.</span><span class="nf">most_common</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># [('a', 5), ('b', 4)]
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s"> -&gt; </span><span class="si">{</span><span class="n">c</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># a -&gt; 5	b -&gt; 4	c -&gt; 3	d -&gt; 2	e -&gt; 1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Sets</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># `{}`, set(), frozenset()
</span><span class="p">{}</span>  <span class="c1"># &lt;class 'dict'&gt;
</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">}</span>  <span class="c1"># {0, 2, 4, 6}
</span>
<span class="nf">set</span><span class="p">()</span>  <span class="c1"># set()
</span><span class="nf">set</span><span class="p">(</span><span class="sh">'</span><span class="s">letter</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># {'l', 't', 'r', 'e'}
</span><span class="nf">set</span><span class="p">({</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">})</span>  <span class="c1"># {'cat', 'cattle', 'dog'}
</span>
<span class="nf">frozenset</span><span class="p">()</span>  <span class="c1"># frozenset()
</span><span class="nf">frozenset</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>  <span class="c1"># frozenset({1, 3, 4, 5, 9})
</span>
<span class="c1"># len(), add(), remove()
</span><span class="n">nums</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">}</span>
<span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>  <span class="c1"># 5
</span><span class="n">nums</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># {0, 1, 2, 3, 4, 5}
</span><span class="n">nums</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># {1, 2, 3, 4, 5}
</span>
<span class="c1"># iteration
</span><span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">}:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># 0	2	4	6	8
</span>
<span class="c1"># testing
</span><span class="mi">2</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span>  <span class="c1"># True
</span><span class="mi">3</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span>  <span class="c1"># False
</span>
<span class="c1"># `&amp;`: intersection(), `|`: union(), `-`: difference(), `^`: symmetric_difference()
</span><span class="n">a</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span>  <span class="c1"># {3}
</span><span class="n">a</span> <span class="o">|</span> <span class="n">b</span>  <span class="c1"># {1, 2, 3}
</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span>  <span class="c1"># {1}
</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span>  <span class="c1"># {1, 2}
</span>
<span class="c1"># `&lt;=`: issubset(), `&lt;`: proper subset, `&gt;=`: issuperset(), `&gt;`: proper superset
</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span>  <span class="c1"># False
</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span>  <span class="c1"># False
</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span>  <span class="c1"># False
</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span>  <span class="c1"># False
</span>
<span class="c1"># set comprehensions: { expression for expression in iterable }
</span><span class="p">{</span><span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)}</span>  <span class="c1"># {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}
# set comprehensions: { expression for expression in iterable if condition }
</span><span class="p">{</span><span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">}</span>  <span class="c1"># {0, 2, 4, 6, 8}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="iterations-and-comprehensions">9. Iterations and comprehensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The terms "iterable" and "iterator" are casually used interchangeably to refer to an object that supports iteration in general. For clarity, using the term:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>iterable</em> to refer to an object that supports the <code>iter</code> call, and</p>
</li>
<li>
<p><em>iterator</em> to refer to an object returned by an <em>iterable</em> on <code>iter</code> that supports the <code>next(I)</code> call.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any object with a <code>__next__</code> method to advance to a next result, which raises <code>StopIteration</code> at the end of the series of results, is considered an <em>iterator</em>, that may also be stepped through with a <code>for</code> loop or other iteration tool, because all iteration tools normally work internally by calling <code>__next__</code> on each iteration and catching the <code>StopIteration</code> exception to determine when to exit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="nf">print</span><span class="p">(</span><span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">script2.py</span><span class="sh">'</span><span class="p">).</span><span class="nf">read</span><span class="p">())</span>
<span class="c1"># import sys
# print(sys.path)
# x = 2
# print(x**32)
</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">script2.py</span><span class="sh">'</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>
<span class="c1"># 'import sys\n'
</span><span class="n">f</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>
<span class="c1"># 'print(sys.path)\n'
</span><span class="n">f</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>
<span class="c1"># 'x = 2\n'
</span><span class="n">f</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>
<span class="c1"># 'print(x**32)\n'
</span><span class="n">f</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>
<span class="c1"># Traceback (most recent call last):
#   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
# StopIteration</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># manual iteration: what for loops usually do
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">script2.py</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">rt</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># To simplify manual iteration code, Python 3.X also provides a built-in function, next,
</span>            <span class="c1"># that automatically calls an object’s __next__ method.
</span>            <span class="n">line</span> <span class="o">=</span> <span class="n">fi</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>  <span class="c1"># same as: line = next(fi)
</span>            <span class="nf">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
            <span class="k">break</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">script2.py</span><span class="sh">'</span><span class="p">):</span>  <span class="c1"># use file iterators to read by lines
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="nf">upper</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>  <span class="c1"># calls __next__, catches StopIteration</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the <code>for</code> loop begins, it first uses the iteration protocol to obtain an iterator from the iterable object by passing it to the <code>iter</code> built-in function; the object returned by <code>iter</code> in turn has the required <code>next</code> method. The <code>iter</code> function internally runs the <code>__iter__</code> method, much like <code>next</code> and <code>__next__</code>.</p>
</div>
<div class="paragraph">
<p>The Python iteration protocol is used by for loops, comprehensions, maps, and more, and also supported by files, lists, dictionaries, generators, and more.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An iterable object&#8217;s <code>__iter__</code> method, called by <code>iter()</code>, returns an iterator for the iteration.</p>
</li>
<li>
<p>The iterator&#8217;s <code>__next__</code> method, called by <code>next()</code>, produces values during the iteration until it raises <code>StopIteration</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># iterable
</span><span class="n">I</span> <span class="o">=</span> <span class="nf">iter</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>  <span class="c1"># iterator
</span><span class="nf">next</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="c1"># 1
</span><span class="nf">next</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="c1"># 2
</span><span class="nf">next</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="c1"># 3
</span><span class="nf">next</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="c1"># Traceback (most recent call last):
#   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
# StopIteration</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Iteration contexts in Python include the <code>for</code> loop; <code>list</code> comprehensions; the <code>map</code> built-in function; the <code>in</code> membership test expression; and the built-in functions <code>sorted</code>, <code>sum</code>, <code>any</code>, and <code>all</code>, and also includes the <code>list</code> and <code>tuple</code> built-ins, string <code>join</code> methods, and sequence assignments, all of which use the iteration protocol to step across iterable objects one item at a time.</p>
</div>
<div class="paragraph">
<p>Technically speaking, list comprehensions are never really required because a list of expression results can be always built up manually with for loops, however, list comprehensions might run much faster than manual for loop statements (often roughly twice as fast) because their iterations are performed at C language speed inside the interpreter, rather than with manual Python code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
    <span class="n">res</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>  <span class="c1"># [11, 12, 13, 14, 15]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">res2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>  <span class="c1"># [11, 12, 13, 14, 15]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># filter clauses: if
</span><span class="p">[</span><span class="n">line</span><span class="p">.</span><span class="nf">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">script2.py</span><span class="sh">'</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># nested loops: for
</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">abc</span><span class="sh">'</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">lmn</span><span class="sh">'</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># all, any, map, filter, reduce, zip, enumerate, shuffle, sample, reversed, sorted
</span><span class="n">nums</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</span>
<span class="nf">all</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">)</span>  <span class="c1"># False
</span><span class="nf">any</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">)</span>  <span class="c1"># True
</span>
<span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">nums</span><span class="p">)</span>  <span class="c1"># [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</span><span class="nf">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nums</span><span class="p">)</span>  <span class="c1"># [0, 2, 4, 6, 8]
# from functools import reduce
</span><span class="nf">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">nums</span><span class="p">)</span>  <span class="c1"># ((0 + 1) + 2) + ... = 45
</span>
<span class="nf">zip</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># [(0, 0, 0), (1, 1, 1), (2, 2, 2)]
</span>
<span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">map</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">filter</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">reduce</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">enumerate</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span>     <span class="c1"># [(0, 'map'), (1, 'filter'), (2, 'reduce')]
</span><span class="nf">enumerate</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># [(1, 'map'), (2, 'filter'), (3, 'reduce')]
</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>  <span class="c1"># [(1, 'map'), (2, 'filter'), (3, 'reduce')]
</span>
<span class="c1"># from random import shuffle, sample
</span><span class="nf">shuffle</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>  <span class="c1"># Shuffle list x in place, and return None.
</span><span class="n">nums</span>  <span class="c1"># [4, 2, 5, 9, 6, 0, 1, 3, 8, 7]
</span><span class="nf">sample</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>  <span class="c1"># [5, 3, 7, 6, 8, 4, 0, 1, 2, 9]
</span>
<span class="nf">reversed</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>  <span class="c1"># [7, 8, 3, 1, 0, 6, 9, 5, 2, 4]
</span><span class="n">nums</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># [7, 8, 3, 1, 0, 6, 9, 5, 2, 4]
</span>
<span class="nf">sorted</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">itertools</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Alan</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Adam</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Wes</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Will</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Albert</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Steven</span><span class="sh">"</span><span class="p">]</span>

<span class="k">for</span> <span class="n">letter</span><span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">itertools</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="nf">list</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>

<span class="c1"># A ['Alan', 'Adam']
# W ['Wes', 'Will']
# A ['Albert']
# S ['Steven']
</span>
<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">itertools</span><span class="p">.</span><span class="nf">chain</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nf">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="nf">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">[</span><span class="mi">10</span><span class="p">]):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 0       1       2       3       4       5       6       7       8       9       10
</span>
<span class="nf">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="nf">combinations</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="nf">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="nf">combinations_with_replacement</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="nf">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="nf">permutations</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="nf">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="nf">product</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="files-and-directories">10. Files and directories</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <em>file</em> is a sequence of bytes, stored in some <em>filesystem</em>, and accessed by a <em>filename</em>. A <em>directory</em> (or <em>folder</em>) is a collection of files, and possibly other directories.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Text files</em> represent content as normal <code>str</code> strings, perform Unicode encoding and decoding automatically, and perform end-of-line translation by default.</p>
</li>
<li>
<p><em>Binary files</em> represent content as a special <code>bytes</code> string type and allow programs to access file content unaltered.</p>
</li>
<li>
<p><code>open(filename, mode)</code>: Opens a file in the specified mode, and returns a file object used for reading or writing data.</p>
<div class="ulist">
<ul>
<li>
<p><code>file.read([size])</code>: Read a specified number of characters (or bytes) from the file (or all remaining bytes if no size is provided).</p>
</li>
<li>
<p><code>file.readline()</code>: Read a single line from the file.</p>
</li>
<li>
<p><code>file.readlines([size])</code>: Return a list of lines from the stream.</p>
</li>
<li>
<p><code>for line in open('data'): use line</code>: File iterators read line by line.</p>
</li>
<li>
<p><code>file.write(data)</code>: Write a string of characters (or bytes) data to the file.</p>
</li>
<li>
<p><code>file.writelines(strings)</code>: Write all line strings in a list into file.</p>
</li>
<li>
<p><code>file.flush()</code>: Flush output buffer to disk without closing.</p>
</li>
<li>
<p><code>file.tell()</code>: Return the stream position as an opaque number.</p>
</li>
<li>
<p><code>file.seek(pos)</code>: Set the stream position, and return the new stream position.</p>
</li>
<li>
<p><code>file.encoding</code>: Encoding of the text stream.</p>
</li>
<li>
<p><code>mode</code> (optional): a string specifies how the file will be opened, which determines the access permissions and how newline characters (for text files) are handled.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>r</code> (read): Opens the file for reading. The file must exist, or an error will be raised.</p>
</li>
<li>
<p><code>w</code> (write): Opens the file for writing. An existing file will be truncated (emptied) before writing. If the file doesn&#8217;t exist, it will be created.</p>
</li>
<li>
<p><code>a</code> (append): Opens the file for appending. New data will be written to the end of the file. If the file doesn&#8217;t exist, it will be created.</p>
</li>
<li>
<p><code>x</code> (exclusive creation): Attempts to create a new file. If the file already exists, an error will be raised.</p>
</li>
<li>
<p><code>r+</code> (read and write): Opens the file for both reading and writing. The file must exist.</p>
</li>
<li>
<p><code>w+</code> (read and write): Opens the file for both reading and writing. An existing file will be truncated before any operations. If the file doesn&#8217;t exist, it will be created.</p>
</li>
<li>
<p><code>a+</code> (append and read): Opens the file for both appending and reading. If the file doesn&#8217;t exist, it will be created.</p>
</li>
<li>
<p>By default, Python opens files in text mode (<code>t</code>), that handles newline characters differently based on the operating system (CRLF on Windows, LF on Unix/Linux).</p>
</li>
<li>
<p>The binary mode (<code>b</code>) can be specified  by appending it to any mode (e.g., <code>rb</code>, <code>wb</code>), that treats the file as a raw stream of bytes without newline conversion.</p>
</li>
<li>
<p>Python 3 offers a universal newline mode (<code>U</code>) that attempts to handle various newline conventions consistently.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">poem</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
Je suis l</span><span class="sh">'</span><span class="s">automne, la saison des pluies,
Le temps des fruits mûrs et des feuilles jaunies,
Le soleil pâle et les jours qui décroissent,
Le vent qui hurle et les chaumes qui gémissent.

Je suis l</span><span class="sh">'</span><span class="s">automne, la saison des regrets,
Le temps où meurent les amours et les joies,
Le temps des souvenirs et des larmes secrètes,
Le temps des nuits longues et des tristesses froides.

Je suis l</span><span class="sh">'</span><span class="s">automne, la saison des douleurs,
Le temps des fièvres et des maladies,
Le temps où l</span><span class="sh">'</span><span class="s">on se sent mourir sans pouvoir guérir,
Le temps où l</span><span class="sh">'</span><span class="s">on voudrait mourir et qu</span><span class="sh">'</span><span class="s">on n</span><span class="sh">'</span><span class="s">ose pas.

Je suis l</span><span class="sh">'</span><span class="s">automne, la saison de la mort,
Le temps où l</span><span class="sh">'</span><span class="s">on se couche dans la terre humide,
Le temps où l</span><span class="sh">'</span><span class="s">on dort pour toujours sans rêver,
Le temps où l</span><span class="sh">'</span><span class="s">on ne souffre plus et qu</span><span class="sh">'</span><span class="s">on n</span><span class="sh">'</span><span class="s">aime plus.
</span><span class="sh">'''</span>

<span class="c1"># sys.getdefaultencoding()  # 'utf-8'
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">autumn_song.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w+</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fio</span><span class="p">:</span>
    <span class="n">fio</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">poem</span><span class="p">)</span>

    <span class="n">fio</span><span class="p">.</span><span class="nf">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">fio</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>

    <span class="n">fio</span><span class="p">.</span><span class="nf">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fio</span><span class="p">:</span>  <span class="c1"># iterate over lines in the file object (text mode only)
</span>        <span class="nf">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>os.mkdir(directory_name)</code>: Create a single directory.</p>
</li>
<li>
<p><code>os.makedirs(directory_path)</code> : Create nested directories if they don&#8217;t exist.</p>
</li>
<li>
<p><code>os.remove(filename)</code>: Delete a single file.</p>
</li>
<li>
<p><code>shutil.rmtree(directory_path)</code>: Delete a directory and its contents recursively.</p>
</li>
<li>
<p><code>os.rename(old_name, new_name)</code>: Rename a file or directory.</p>
</li>
<li>
<p><code>os.getcwd()</code>: Get the current working directory.</p>
</li>
<li>
<p><code>os.chdir(new_path)</code>: Change the working directory.</p>
</li>
<li>
<p><code>os.listdir(directory_path)</code>: Get a list of files and subdirectories within a directory.</p>
</li>
<li>
<p><code>os.path.exists(path)</code>: Check if a file or directory exists.</p>
</li>
<li>
<p><code>os.path.getsize(path)</code>: Get a file size.</p>
</li>
<li>
<p><code>os.path.isdir(path)</code>: Check if it&#8217;s a directory.</p>
</li>
<li>
<p><code>os.path.isfile(path)</code>: Check whether a path is a regular file.</p>
</li>
<li>
<p><code>os.walk(directory)</code>: Iterate through a directory recursively, yielding a 3-tuple for each directory containing its path, subdirectories, and filenames.</p>
</li>
<li>
<p><code>glob.glob(pathname)</code>: Return a list of paths matching a pathname pattern.</p>
</li>
<li>
<p><code>glob.iglob(pathname)</code>: Returns an iterator of paths that match the given pattern.</p>
<div class="paragraph">
<p>The pattern can include wildcard characters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>*</code>: Matches zero or more characters.</p>
</li>
<li>
<p><code>?</code>: Matches exactly one character.</p>
</li>
<li>
<p><code>[]</code>: Matches any character within the specified set.</p>
</li>
<li>
<p><code>{}</code>: Matches one of the enclosed patterns.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">glob</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="sh">"</span><span class="s">*.txt</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># Find all text files in the current directory
</span><span class="n">glob</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="sh">"</span><span class="s">**/*.py</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># Find all Python files in the current directory and its subdirectories
</span><span class="n">glob</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="sh">"</span><span class="s">./docs/**/*.png</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># "./docs/": Specifies the directory to search in.
</span><span class="n">glob</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="sh">"</span><span class="s">**/images/*.jpg</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># Use ** to match files in subdirectories as well</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>pathlib.Path</code>: Represents a file path object in the modern and object-oriented <code>pathlib</code> module for working with file paths.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Creating and manipulating files and directories:
</span><span class="n">Path</span><span class="p">.</span><span class="nf">mkdir</span><span class="p">()</span>    <span class="c1"># Create a new directory.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">unlink</span><span class="p">()</span>   <span class="c1"># Remove a file.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">rmdir</span><span class="p">()</span>    <span class="c1"># Remove an empty directory.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">rename</span><span class="p">()</span>   <span class="c1"># Rename a file or directory.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>     <span class="c1"># Copy a file or directory.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">replace</span><span class="p">()</span>  <span class="c1"># Move a file or directory.
</span>
<span class="c1"># Getting information about files and directories:
</span><span class="n">Path</span><span class="p">.</span><span class="nf">exists</span><span class="p">()</span>   <span class="c1"># Check if a path exists.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">is_file</span><span class="p">()</span>  <span class="c1"># Check if a path is a file.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">is_dir</span><span class="p">()</span>   <span class="c1"># Check if a path is a directory.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">stat</span><span class="p">()</span>     <span class="c1"># Get information about a file or directory (e.g., size, modification time).
</span><span class="n">Path</span><span class="p">.</span><span class="nf">iterdir</span><span class="p">()</span>  <span class="c1"># Iterate over the contents of a directory.
</span>
<span class="c1"># Working with file paths:
</span><span class="n">Path</span><span class="p">.</span><span class="nf">joinpath</span><span class="p">()</span> <span class="c1"># Join multiple path components into a single path.
</span><span class="n">Path</span><span class="p">.</span><span class="n">parent</span>     <span class="c1"># Get the parent directory of a path.
</span><span class="n">Path</span><span class="p">.</span><span class="n">name</span>       <span class="c1"># Get the name of a file or directory.
</span><span class="n">Path</span><span class="p">.</span><span class="n">stem</span>       <span class="c1"># Get the name of a file without the extension.
</span><span class="n">Path</span><span class="p">.</span><span class="n">suffix</span>     <span class="c1"># Get the file extension.
</span><span class="n">Path</span><span class="p">.</span><span class="nf">resolve</span><span class="p">()</span>  <span class="c1"># Convert a relative path to an absolute path.
</span>
<span class="c1"># Using context managers:
</span><span class="n">Path</span><span class="p">.</span><span class="nf">open</span><span class="p">()</span>     <span class="c1"># Open a file for reading or writing.</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="functions">11. Functions</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Function-related statements and expressions
</span>
<span class="c1"># call expressions
</span><span class="nf">myfunc</span><span class="p">(</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">,</span> <span class="n">meat</span><span class="o">=</span><span class="n">ham</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">)</span>

<span class="c1"># def
</span><span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="n">messge</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Hello </span><span class="sh">'</span> <span class="o">+</span> <span class="n">message</span><span class="p">)</span>

<span class="c1"># return
</span><span class="k">def</span> <span class="nf">adder</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># global
</span><span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">old</span><span class="sh">'</span>
<span class="k">def</span> <span class="nf">changer</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">x</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">new</span><span class="sh">'</span>

<span class="c1"># nonlocal (3.X) allows a function to modify variables defined in a higher-level scope that is not global
</span><span class="k">def</span> <span class="nf">outer</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">old</span><span class="sh">'</span>
    <span class="k">def</span> <span class="nf">changer</span><span class="p">():</span>
        <span class="k">nonlocal</span> <span class="n">x</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="sh">'</span><span class="s">new</span><span class="sh">'</span>

<span class="c1"># yield
</span><span class="k">def</span> <span class="nf">squares</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">yield</span> <span class="n">i</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># generator
</span>
<span class="c1"># lambda
</span><span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># pass
</span><span class="k">def</span> <span class="nf">do_nothing</span><span class="p">():</span>
    <span class="k">pass</span>  <span class="c1"># NOOP
</span><span class="nf">do_nothing</span><span class="p">()</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Python 3.X (but not 2.X) allows ellipses coded as <code>&#8230;&#8203;</code> (literally, three consecutive dots) to appear any place an expression can. Because ellipses do nothing by themselves, this can serve as an alternative to the <code>pass</code> statement, especially for code to be filled in later—a sort of Python "TBD":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">func1</span><span class="p">():</span>
    <span class="p">...</span> <span class="c1"># Alternative to pass
</span><span class="k">def</span> <span class="nf">func2</span><span class="p">():</span>
    <span class="bp">...</span>
<span class="nf">func1</span><span class="p">()</span> <span class="c1"># Does nothing if called</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ellipses can also appear on the same line as a statement header and may be used to initialize variable names if no specific type is required:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">func1</span><span class="p">():</span> <span class="p">...</span> <span class="c1"># Works on same line too
</span><span class="k">def</span> <span class="nf">func2</span><span class="p">():</span> <span class="bp">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="p">...</span> <span class="c1"># Alternative to None
</span><span class="n">x</span>       <span class="c1"># Ellipsis
</span><span class="nf">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># &lt;class 'ellipsis'&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This notation is new in Python 3.X—and goes well beyond the original intent of <code>&#8230;&#8203;</code> in slicing extensions—so time will tell if it becomes widespread enough to challenge <code>pass</code> and <code>None</code> in these roles.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>def</code> is an executable statement to create a new function object and assigns it to a name at runtime, and can appear anywhere a statement can—even nested in other statements.</p>
</li>
<li>
<p><code>lambda</code> is an expression, not a statement, for coding simple functions, and its body is a single expression, not a block of statements.</p>
</li>
<li>
<p><code>return</code> sends a result object back to the caller.</p>
</li>
<li>
<p><code>yield</code> sends a result object back to the caller, but remembers where it left off, to produce a series of results over time.</p>
</li>
<li>
<p><code>global</code> declares module-level variables that are to be assigned, that tells Python that a function plans to change one or more global names—that is, names that live in the enclosing module’s scope (namespace).</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="mi">88</span>  <span class="c1"># Global X
</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">X</span>
    <span class="n">X</span> <span class="o">=</span> <span class="mi">99</span>  <span class="c1"># Global X: outside def
</span>
<span class="nf">func</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># Prints 99</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>nonlocal</code> declares enclosing function variables that are to be assigned, that is declaring the enclosing scopes’ names in a nonlocal statement enables nested functions to assign and thus change such names as well.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">tester</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">start</span>  <span class="c1"># Each call gets its own state
</span>
    <span class="k">def</span> <span class="nf">nested</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">state</span>  <span class="c1"># Remembers state in enclosing scope
</span>        <span class="nf">print</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Allowed to change it if nonlocal
</span>    <span class="k">return</span> <span class="n">nested</span>

<span class="c1"># Increments state on each call
</span><span class="n">F</span> <span class="o">=</span> <span class="nf">tester</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nc">F</span><span class="p">(</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># spam 0
</span><span class="nc">F</span><span class="p">(</span><span class="sh">'</span><span class="s">ham</span><span class="sh">'</span><span class="p">)</span>   <span class="c1"># ham 1
</span><span class="nc">F</span><span class="p">(</span><span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># eggs 2</span></code></pre>
</div>
</div>
</li>
<li>
<p>Arguments are <strong>passed by assignment</strong> (object reference), and are passed by position, unless saying otherwise.</p>
<div class="ulist">
<ul>
<li>
<p>Values passed in a function call match argument names in a function’s definition from left to right by default.</p>
</li>
<li>
<p>Function calls can also pass arguments by name with <code>name=value</code> keyword syntax, and unpack arbitrarily many arguments to send with <code>*args</code> and <code>**kargs</code> starred-argument notation.</p>
</li>
<li>
<p>Function definitions use the same two forms to specify argument defaults, and collect arbitrarily many arguments received.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Arguments, return values, and variables are not declared, and there are no type constraints on functions, and a single function can often be applied to a variety of object types—any objects that sport a compatible interface (methods and expressions) will do, regardless of their specific types.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># None
</span><span class="k">def</span> <span class="nf">whatis</span><span class="p">(</span><span class="n">thing</span><span class="p">):</span>  <span class="c1"># def whatis(thing: any) -&gt; None:
</span>    <span class="k">if</span> <span class="n">thing</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="sh">"</span><span class="s">is None</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">thing</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="sh">"</span><span class="s">is True</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">whatis</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>  <span class="c1"># None is None</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># docstring
</span><span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="n">anything</span><span class="p">):</span>
    <span class="sh">'</span><span class="s">echo returns its input argument</span><span class="sh">'</span>
    <span class="k">return</span> <span class="n">anything</span>

<span class="nf">print</span><span class="p">(</span><span class="n">echo</span><span class="p">.</span><span class="n">__doc__</span><span class="p">)</span>  <span class="c1"># 'echo returns its input argument'
</span><span class="nf">help</span><span class="p">(</span><span class="n">echo</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="namespaces">11.1. Namespaces</h3>
<div class="paragraph">
<p>When talking about the search for a name’s value in relation to code, the term <em>scope</em> refers to a <em>namespace</em>—a place where names live.</p>
</div>
<div class="paragraph">
<p>Python’s name-resolution scheme is sometimes called the <em>LEGB rule</em>, after the scope names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When using an unqualified name inside a function, Python searches up to four scopes—the local (<em>L</em>) scope, then the local scopes of any enclosing (<em>E</em>) <code>def</code>s and <code>lambda</code>s, then the global (<em>G</em>) scope, and then the built-in (<em>B</em>) scope—and stops at the first place the name is found. If the name is not found during this search, Python reports an error (<code>NameError</code>) .</p>
</li>
<li>
<p>When assigning a name in a function (instead of just referring to it in an expression), Python always creates or changes the name in the local scope, unless it’s declared to be <code>global</code> or <code>nonlocal</code> in that function.</p>
</li>
<li>
<p>When assigning a name outside any function (i.e., at the top level of a module file, or at the interactive prompt), the local scope is the same as the global scope—the module’s namespace.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">tester</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">nested</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">state</span>  <span class="c1"># Nonlocals must already exist in enclosing def!
</span>        <span class="n">state</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nested</span>
<span class="c1"># SyntaxError: no binding for nonlocal 'state' found
</span>

<span class="k">def</span> <span class="nf">tester</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">nested</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">state</span>  <span class="c1"># Globals don't have to exist yet when declared
</span>        <span class="n">state</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># This creates the name in the module now
</span>        <span class="nf">print</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nested</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Python provides two functions to access the contents of the namespaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>locals()</code> returns a dictionary of the contents of the local namespace.</p>
</li>
<li>
<p><code>globals()</code> returns a dictionary of the contents of the global namespace.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">a</span> <span class="o">=</span> <span class="mf">5.21</span>

<span class="k">def</span> <span class="nf">print_global_a</span><span class="p">():</span>
 <span class="k">global</span> <span class="n">a</span>  <span class="c1"># the global keyword: explicit is better than implicit
</span> <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="nf">print_global_a</span><span class="p">()</span>
<span class="c1"># 5.21
</span>
<span class="k">def</span> <span class="nf">print_locals_globals</span><span class="p">():</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">b</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.14</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">locals</span><span class="p">())</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">globals</span><span class="p">())</span>

<span class="nf">print_locals_globals</span><span class="p">()</span>
<span class="c1"># {'a': 0, 'b': 3.14}
# {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__spec__': None, '__annotations__': {}, '__builtins__': &lt;module 'builtins' (built-in)&gt;, 'print_locals': &lt;function print_locals at 0x7fab761ade40&gt;, 'print_globals': &lt;function print_globals at 0x7fab761adee0&gt;, 'print_locals_globals': &lt;function print_locals_globals at 0x7fab761bbba0&gt;, 'a': 5.21}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>vars()</code> without arguments, equivalent to <code>locals()</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="nf">print</span><span class="p">(</span><span class="nf">vars</span><span class="p">())</span>
<span class="c1"># {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': &lt;class '_frozen_importlib.BuiltinImporter'&gt;, '__spec__': None, '__annotations__': {}, '__builtins__': &lt;module 'builtins' (built-in)&gt;}</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="arguments">11.2. Arguments</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># function argument-matching forms
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">name</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># normal: matches any passed value by position or name
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># defaults: default argument value, if not passed in the call
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># varargs collecting: matches and collects remaining positional arguments in a tuple
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">**</span><span class="n">kargs</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># varargs collecting: matches and collects remaining keyword arguments in a dictionary
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">other</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># keyword-only arguments: arguments that must be passed by keyword only in calls (3.X)
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># keyword-only arguments: arguments that must be passed by keyword only in calls (3.X)
</span>
<span class="nf">func</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># positionals: matched by position
</span><span class="nf">func</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># keywords: matched by name
</span><span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">iterable</span><span class="p">)</span>  <span class="c1"># varargs unpacking: pass all objects in iterable as individual positional arguments
</span><span class="nf">func</span><span class="p">(</span><span class="o">**</span><span class="nb">dict</span><span class="p">)</span>  <span class="c1"># varargs unpacking: pass all key/value pairs in dict as individual keyword arguments</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># arguments
</span><span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="n">wine</span><span class="p">,</span> <span class="n">entree</span><span class="p">,</span> <span class="n">dessert</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">wine</span><span class="sh">'</span><span class="p">:</span> <span class="n">wine</span><span class="p">,</span> <span class="sh">'</span><span class="s">entree</span><span class="sh">'</span><span class="p">:</span> <span class="n">entree</span><span class="p">,</span> <span class="sh">'</span><span class="s">dessert</span><span class="sh">'</span><span class="p">:</span> <span class="n">dessert</span><span class="p">}</span>

<span class="c1"># positional (or named) arguments: passed by order
</span><span class="nf">menu</span><span class="p">(</span><span class="sh">'</span><span class="s">chardonnay</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">chicken</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cake</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># {'wine': 'chardonnay', 'entree': 'chicken', 'dessert': 'cake'}
</span>
<span class="c1"># keyword arguments: passed by name
</span><span class="nf">menu</span><span class="p">(</span><span class="n">entree</span><span class="o">=</span><span class="sh">'</span><span class="s">beef</span><span class="sh">'</span><span class="p">,</span> <span class="n">dessert</span><span class="o">=</span><span class="sh">'</span><span class="s">bagel</span><span class="sh">'</span><span class="p">,</span> <span class="n">wine</span><span class="o">=</span><span class="sh">'</span><span class="s">bordeaux</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># {'wine': 'bordeaux', 'entree': 'beef', 'dessert': 'bagel'}
</span>
<span class="c1"># mix positional and keyword arguments
</span><span class="nf">menu</span><span class="p">(</span><span class="sh">'</span><span class="s">frontenac</span><span class="sh">'</span><span class="p">,</span> <span class="n">dessert</span><span class="o">=</span><span class="sh">'</span><span class="s">flan</span><span class="sh">'</span><span class="p">,</span> <span class="n">entree</span><span class="o">=</span><span class="sh">'</span><span class="s">fish</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># {'wine': 'frontenac', 'entree': 'fish', 'dessert': 'flan'}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># optional positional arguments
</span><span class="k">def</span> <span class="nf">print_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># gather as a tuple
</span>
<span class="nf">print_args</span><span class="p">()</span>
<span class="c1"># ()
</span><span class="nf">print_args</span><span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># ('meow', 'bark', 'moo')
</span><span class="nf">print_args</span><span class="p">((</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">))</span>
<span class="c1"># (('meow', 'bark', 'moo'),)
</span><span class="nf">print_args</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># explode a tuple with `*`
# ('meow', 'bark', 'moo')</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># optional keyword arguments
</span><span class="k">def</span> <span class="nf">print_kargs</span><span class="p">(</span><span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">kargs</span><span class="p">)</span>  <span class="c1"># gather as a dict
</span>
<span class="nf">print_kargs</span><span class="p">()</span>
<span class="c1"># {}
</span><span class="nf">print_kargs</span><span class="p">(</span><span class="n">cat</span><span class="o">=</span><span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="n">dog</span><span class="o">=</span><span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="n">cattle</span><span class="o">=</span><span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># {'cat': 'meow', 'dog': 'bark', 'cattle': 'moo'}
</span><span class="nf">print_kargs</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dog</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">cattle</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">moo</span><span class="sh">'</span><span class="p">})</span>  <span class="c1"># explode a dict with `**`
# {'cat': 'meow', 'dog': 'bark', 'cattle': 'moo'}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># default parameters
</span><span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="n">wine</span><span class="p">,</span> <span class="n">entree</span><span class="p">,</span> <span class="n">dessert</span><span class="o">=</span><span class="sh">'</span><span class="s">pudding</span><span class="sh">'</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">wine</span><span class="sh">'</span><span class="p">:</span> <span class="n">wine</span><span class="p">,</span> <span class="sh">'</span><span class="s">entree</span><span class="sh">'</span><span class="p">:</span> <span class="n">entree</span><span class="p">,</span> <span class="sh">'</span><span class="s">dessert</span><span class="sh">'</span><span class="p">:</span> <span class="n">dessert</span><span class="p">}</span>

<span class="nf">menu</span><span class="p">(</span><span class="sh">'</span><span class="s">chardonnay</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">chicken</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># {'wine': 'chardonnay', 'entree': 'chicken', 'dessert': 'pudding'}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># keyword-only arguments `*`
</span><span class="k">def</span> <span class="nf">kwonly</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    - a: may be passed by name or position.
    - b: collects any extra positional arguments
    - c: must be passed by keyword only.
    </span><span class="sh">'''</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="nf">kwonly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 1 (2,) 3
</span><span class="nf">kwonly</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 1 () 3
</span><span class="nf">kwonly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># TypeError: kwonly() missing 1 required keyword-only argument: 'c'
</span>
<span class="k">def</span> <span class="nf">kwonly</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    - a: may be passed by name or position.
    - b: must be passed by keyword.
    - c: optional but must be passed by keyword.
    </span><span class="sh">'''</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="nf">kwonly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 1 eggs spam</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># In a function header, arguments must appear in this order: any normal arguments (name); followed
# by any default arguments (name=value); followed by the *name (or * in 3.X) form; followed by any
# name or name=value keyword-only arguments (in 3.X); followed by the **name form.
</span>
<span class="c1"># In Python 3.X only, argument names in a function header can also have annotation values, specified
# as name:value (or name:value=default when defaults are present). The function itself can also have
# an annotation value, given as def f()-&gt;value.
</span>
<span class="c1"># In a function call, arguments must appear in this order: any positional arguments (value); followed
# by a combination of any keyword arguments (name=value) and the *iterable form; followed by the
# **dict form.
</span>
<span class="c1"># In both the call and header, the **args form must appear last if present.
</span>
<span class="c1"># The steps that Python internally carries out to match arguments before assignment can roughly be
# described as follows:
#   1. Assign nonkeyword arguments by position.
#   2. Assign keyword arguments by matching names.
#   3. Assign extra nonkeyword arguments to *name tuple.
#   4. Assign extra keyword arguments to **name dictionary.
#   5. Assign default values to unassigned arguments in header.
</span><span class="k">def</span> <span class="nf">the_order_of_arguments</span><span class="p">(</span>
    <span class="n">required</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">optional</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kargs</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
  <span class="sh">"""</span><span class="s">
  This function demonstrates the order of arguments in Python.

  Args:
      required (str): A required positional argument.
      optional (str, optional): An optional positional argument with a default value of None.
      *args (tuple, optional): Captures any remaining positional arguments as a tuple.
      key (str, optional): A keyword-only argument with a default value of None.
      **kargs (dict, optional): Captures any remaining keyword arguments as a dictionary.

  Returns:
      None
  </span><span class="sh">"""</span>
  <span class="c1"># Function body (can be replaced with actual logic)
</span>  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Required argument: </span><span class="si">{</span><span class="n">required</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Optional argument: </span><span class="si">{</span><span class="n">optional</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Positional arguments (as tuple): </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Keyword-only argument: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Keyword arguments (as dictionary): </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">the_order_of_arguments</span><span class="p">(</span><span class="sh">"</span><span class="s">This is required</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">This is optional</span><span class="sh">"</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="sh">"</span><span class="s">hello</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># applying functions generically
</span><span class="kn">from</span> <span class="n">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span>

<span class="k">def</span> <span class="nf">tracer</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">pargs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>  <span class="c1"># accept arbitrary arguments
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">calling:</span><span class="sh">'</span><span class="p">,</span> <span class="n">func</span><span class="p">.</span><span class="n">__name__</span><span class="p">)</span>
    <span class="k">return</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">pargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>  <span class="c1"># pass along arbitrary arguments
</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">tracer</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="c1"># calling: func
# 10</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># recursion
</span><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">lol</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lol</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">yield</span> <span class="k">from</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># yield from expression
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">item</span>

<span class="n">lol</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[]]]</span>
<span class="nf">list</span><span class="p">(</span><span class="nf">flatten</span><span class="p">(</span><span class="n">lol</span><span class="p">))</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="attributes">11.3. Attributes</h3>
<div class="paragraph">
<p>In Python, functions are objects, which may be assigned to other names, passed to other functions, embedded in data structures, returned from one function to another, and more, as if they were simple numbers or strings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># functions are first-class citizens
</span><span class="k">def</span> <span class="nf">answer</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">run_sth</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nf">func</span><span class="p">()</span>

<span class="nf">run_sth</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>  <span class="c1"># 42
</span>
<span class="c1"># inner functions
</span><span class="k">def</span> <span class="nf">outer</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">+</span><span class="n">d</span>
    <span class="k">return</span> <span class="nf">inner</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Function objects are not limited to the system-defined attributes, but also can be attached arbitrary user-defined attributes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">func</span><span class="p">():</span> <span class="bp">...</span>

<span class="nf">dir</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>  <span class="c1"># ['__annotations__', '__code__', '__name__', ...]
</span>
<span class="n">func</span><span class="p">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">func</span><span class="p">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">func</span><span class="p">.</span><span class="n">count</span>  <span class="c1"># 1
</span>
<span class="n">func</span><span class="p">.</span><span class="n">handles</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Button-Press</span><span class="sh">'</span>
<span class="n">func</span><span class="p">.</span><span class="n">handles</span>  <span class="c1"># 'Button-Press'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="annotations">11.4. Annotations</h3>
<div class="paragraph">
<p>In Python 3.X, it’s also possible to attach annotation information—arbitrary user-defined data about a function’s arguments and result—to a function object, and when present are simply attached to the function object’s <code>__annotations__</code> attribute for use by other tools.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
<span class="n">func</span><span class="p">.</span><span class="n">__annotations__</span>  <span class="c1"># {'a': 'spam', 'b': (1, 10), 'c': &lt;class 'float'&gt;, 'return': &lt;class 'int'&gt;}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lambda">11.5. Lambda</h3>
<div class="paragraph">
<p>Python provides a <code>lambda</code> expression form that generates anonymous (i.e., unnamed) function objects. Its general form is the keyword <code>lambda</code>, followed by one or more arguments (exactly like the arguments list enclosed in parentheses in a <code>def</code> header), followed by an expression after a colon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">lambda</span> <span class="n">argument1</span><span class="p">,</span> <span class="n">argument2</span><span class="p">,...</span> <span class="n">argumentN</span> <span class="p">:</span> <span class="n">expression</span> <span class="n">using</span> <span class="n">arguments</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># defs and lambdas do the same sort of work:
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span>
<span class="nf">func</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># 9
</span><span class="n">f</span> <span class="o">=</span> <span class="n">func</span>
<span class="nf">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># 9
</span>
<span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span>
<span class="nf">g</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># 9
</span>
<span class="c1"># defaults work on lambda arguments, just like in a def:
</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="o">=</span><span class="sh">"</span><span class="s">fee</span><span class="sh">"</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="sh">"</span><span class="s">fie</span><span class="sh">"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="sh">"</span><span class="s">foe</span><span class="sh">"</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
<span class="nf">x</span><span class="p">(</span><span class="sh">"</span><span class="s">wee</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># 'weefiefoe'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># lambda is also commonly used to code jump tables, which are lists or dictionaries of
# actions to be performed on demand. For example:
</span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Inline function definition
</span>     <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span><span class="p">,</span>
     <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># A list of three callable functions
</span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">f</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># Prints 4, 8, 16
</span><span class="nf">print</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># Prints 9
</span>
<span class="n">key</span> <span class="o">=</span> <span class="sh">'</span><span class="s">got</span><span class="sh">'</span>
<span class="n">actions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">already</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">got</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">one</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">}</span>
<span class="n">actions</span><span class="p">[</span><span class="n">key</span><span class="p">]()</span>  <span class="c1"># 8</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># lambda functions in Python don't support type hints in the same way as regular functions.
</span><span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">int</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span> <span class="c1"># invalid syntax</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="n">nums</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</span>
<span class="c1"># map: mapping functions over iterables
</span><span class="nf">list</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nums</span><span class="p">))</span>  <span class="c1"># [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
</span>
<span class="c1"># filter: selecting items in iterables
</span><span class="nf">list</span><span class="p">(</span><span class="nf">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nums</span><span class="p">))</span>  <span class="c1"># [0, 2, 4, 6, 8]
</span>
<span class="c1"># reduce: combining items in iterables
</span><span class="nf">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span> <span class="n">nums</span><span class="p">)</span>  <span class="c1"># 45</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="closures">11.6. Closures</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">maker</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># make and return action
</span>        <span class="k">return</span> <span class="n">X</span> <span class="o">**</span> <span class="n">N</span>  <span class="c1"># action retains N from enclosing scope
</span>    <span class="k">return</span> <span class="n">action</span>

<span class="n">f</span> <span class="o">=</span> <span class="nf">maker</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f</span>  <span class="c1"># &lt;function maker.&lt;locals&gt;.action at 0x7faba988f240&gt;
</span><span class="nf">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 9
</span><span class="nf">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># 16
</span><span class="n">g</span> <span class="o">=</span> <span class="nf">maker</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># g remembers 3, f remembers 2
</span><span class="nf">g</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># 64
</span><span class="nf">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># 16
</span>
<span class="k">def</span> <span class="nf">maker</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">action</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="n">N</span><span class="p">)</span>  <span class="c1"># N remembered from enclosing def
</span>    <span class="k">return</span> <span class="n">action</span>

<span class="n">x</span> <span class="o">=</span> <span class="nf">maker</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">x</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># Prints 16, 4 ** 2</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># If a lambda or def defined within a function is nested inside a loop, and
# the nested function references an enclosing scope variable that is changed
# by that loop, all functions generated within the loop will have the same
# value—the value the referenced variable had in the last loop iteration.
#
# It's because the enclosing scope variable is looked up when the nested
# functions are later called, they all effectively remember the same value:
# the value the loop variable had on the last loop iteration.
</span><span class="k">def</span> <span class="nf">make_actions</span><span class="p">():</span>
    <span class="n">acts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="c1"># Tries to remember each i
</span>        <span class="n">acts</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">i</span> <span class="o">**</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># But all remember same last i!
</span>    <span class="k">return</span> <span class="n">acts</span>

<span class="n">acts</span> <span class="o">=</span> <span class="nf">make_actions</span><span class="p">()</span>
<span class="p">[</span><span class="nf">act</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">acts</span><span class="p">]</span>  <span class="c1"># [16, 16, 16, 16, 16]
</span>
<span class="c1"># That is, to make this sort of code work, we must pass in the current value
# of the enclosing scope’s variable with a default. Because defaults are
# evaluated when the nested function is created (not when it’s later called),
# each remembers its own value for i:
</span><span class="k">def</span> <span class="nf">make_actions</span><span class="p">():</span>
    <span class="n">acts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="c1"># Use defaults instead
</span>        <span class="n">acts</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">**</span> <span class="n">x</span><span class="p">)</span>  <span class="c1"># Remember current i
</span>    <span class="k">return</span> <span class="n">acts</span>

<span class="n">acts</span> <span class="o">=</span> <span class="nf">make_actions</span><span class="p">()</span>
<span class="p">[</span><span class="nf">act</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="n">acts</span><span class="p">]</span>  <span class="c1"># [0, 1, 4, 9, 16]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="generators">11.7. Generators</h3>
<div class="ulist">
<ul>
<li>
<p>A function <code>def</code> statement that contains a <code>yield</code> statement is turned into a <em>generator function</em>.</p>
<div class="paragraph">
<p>When called, it returns a new generator object with automatic retention of local scope and code position; an automatically created <code>__iter__</code> method that simply returns itself; and an automatically created <code>__next__</code> method (<code>next</code> in 2.X) that starts the function or resumes it where it last left off, and raises <code>StopIteration</code> when finished producing results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">gensquares</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">i</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># Resume here later
</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">gensquares</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="c1"># Resume the function
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="s"> : </span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Print last yielded value
# 0 : 1 : 4 : 9 : 16 :
</span>
<span class="n">x</span> <span class="o">=</span> <span class="nf">gensquares</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># iter() is not required: a no-op here
</span><span class="nf">iter</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="n">x</span>  <span class="c1"># True
</span><span class="n">x</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>  <span class="c1"># 0
</span><span class="n">x</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>  <span class="c1"># 1
</span><span class="n">x</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>  <span class="c1"># 4
</span><span class="n">x</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>  <span class="c1"># 9
</span><span class="n">x</span><span class="p">.</span><span class="nf">__next__</span><span class="p">()</span>  <span class="c1"># StopIteration</span></code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>State suspension</p>
<div class="ulist">
<ul>
<li>
<p>Unlike normal functions that return a value and exit, generator functions automatically <em>suspend</em> and <em>resume</em> their execution and state around the point of value generation.</p>
<div class="paragraph">
<p>Because of that, they are often a useful alternative to both computing an entire series of values up front and manually saving and restoring state in classes.</p>
</div>
</li>
<li>
<p>The <em>state</em> that generator functions retain when they are suspended includes both their code location, and their entire local scope. Hence, their <em>local variables</em> retain information between results, and make it available when the functions are resumed.</p>
</li>
<li>
<p>The chief code difference between generator and normal functions is that a generator <em>yields</em> a value, rather than <em>returning</em> one—the <code>yield</code> statement suspends the function and sends a value back to the caller, but retains enough state to enable the function to resume from where it left off.</p>
<div class="paragraph">
<p>When resumed, the function continues execution immediately after the last <code>yield</code> run. From the function’s perspective, this allows its code to produce a series of values over time, rather than computing them all at once and sending them back in something like a list.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Iteration protocol integration</p>
<div class="ulist">
<ul>
<li>
<p>Generator functions, coded as def statements containing yield statements, are automatically made to support the <em>iteration object protocol</em> and thus may be used in any iteration context to produce results over time and on demand.</p>
<div class="paragraph">
<p>To support this protocol, functions containing a <code>yield</code> statement are compiled specially as generators—they are not normal functions, but rather are built to return an object with the expected iteration protocol methods. When later called, they return a generator object that supports the iteration interface with an automatically created method named <code>__next__</code> to start or resume execution.</p>
</div>
</li>
<li>
<p>Generator functions may also have a <code>return</code> statement that, along with falling off the end of the <code>def</code> block, simply terminates the generation of values—technically, by raising a <code>StopIteration</code> exception after any normal function exit actions.</p>
<div class="paragraph">
<p>From the caller’s perspective, the generator’s <code>__next__</code> method resumes the function and runs until either the next yield result is returned or a <code>StopIteration</code> is raised.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>A comprehension expression enclosed in parentheses (like tuples, their enclosing parentheses are often optional) is known as a <em>generator expression</em>.</p>
<div class="paragraph">
<p>When run, it returns a new generator object with the same automatically created method interface and state retention as a generator function call’s results —with an <code>__iter__</code> method that simply returns itself; and a <code>__next__</code> method (<code>next</code> in 2.X) that starts the implied loop or resumes it where it last left off, and raises <code>StopIteration</code> when finished producing results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>      <span class="c1"># list comprehension: build a list
# [0, 1, 4, 9]
</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>      <span class="c1"># generator expression: make an iterable
# &lt;generator object &lt;genexpr&gt; at 0x7fcd7069b780&gt;
</span><span class="nf">list</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># list comprehension equivalence
</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="nf">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="c1"># used as function arguments
</span><span class="mi">328350</span></code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Generator expressions are a <em>memory-space</em> optimization —they do not require the entire result list to be constructed all at once, as the squarebracketed list comprehension does.</p>
</li>
<li>
<p>Generator expressions may run slightly slower than list comprehensions in practice, so they are probably best used only for very large result sets, or applications that cannot wait for full results generation.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Python 3.3 introduces extended syntax for the <code>yield</code> statement that allows delegation to a subgenerator with a <code>from generator</code> clause.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">both</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">i</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">)):</span>
        <span class="k">yield</span> <span class="n">i</span>

<span class="nf">list</span><span class="p">(</span><span class="nf">both</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># [0, 1, 2, 3, 4, 0, 1, 4, 9, 16]
</span>
<span class="k">def</span> <span class="nf">both</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">yield</span> <span class="k">from</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">yield</span> <span class="nf">from </span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="nf">list</span><span class="p">(</span><span class="nf">both</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># [0, 1, 2, 3, 4, 0, 1, 4, 9, 16]
</span>
<span class="sh">'</span><span class="s"> : </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">both</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># '0 : 1 : 2 : 3 : 4 : 0 : 1 : 4 : 9 : 16'</span></code></pre>
</div>
</div>
</li>
<li>
<p>Generators are single-iteration objects, that support just one active iteration, and can’t have multiple iterators of either positioned at different locations in the set of results.</p>
<div class="paragraph">
<p>Because of this, a generator’s iterator is the generator itself; in fact, as suggested earlier, calling <code>iter</code> on a generator expression or function is an optional no-op.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">SPAM</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">iter</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="ow">is</span> <span class="n">G</span>  <span class="c1"># My iterator is myself: G has __next__
# True
</span>
<span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="sh">'</span><span class="s">SPAM</span><span class="sh">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># SSSS PPPP AAAA MMMM
</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># &lt;empty&gt;</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="classes">12. Classes</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Like the function <code>def</code> statement, the Python <code>class</code> statement is an executable statement, and generates a new class object and assigns it to the name in the class header when reached and run, and provides default behavior and serve as factories for instance objects.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">name</span><span class="p">:</span> <span class="p">...</span>  <span class="c1"># standard class definition
</span><span class="k">class</span> <span class="nc">name</span><span class="p">():</span> <span class="p">...</span>  <span class="c1"># less common approach (equivalent in functionality)</span></code></pre>
</div>
</div>
</li>
<li>
<p>The first argument (called <code>self</code> by convention) inside a class’s method functions references the instance object being processed and assignments to attributes of <code>self</code> create or change data in the instance, not the class.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># superclass links are made by listing classes in parentheses in a class statement header.
</span><span class="k">class</span> <span class="nc">name</span><span class="p">(</span><span class="n">superclass</span><span class="p">,</span> <span class="p">...):</span>  <span class="c1"># assign to name
</span>    <span class="c1"># class attributes are created by statements (assignments) in class statements.
</span>    <span class="n">attr</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># class data attributes, shared by all instances
</span>
    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="p">...):</span>  <span class="c1"># methods
</span>        <span class="c1"># instance attributes are generated by assignments to self attributes in methods.
</span>        <span class="n">self</span><span class="p">.</span><span class="n">attr</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># per-instance data</span></code></pre>
</div>
</div>
</li>
<li>
<p>Like in module files, top-level assignments within a <code>class</code> statement (not nested in a <code>def</code>) generate attributes in the class object&#8217;s local scope.</p>
</li>
<li>
<p>A class object&#8217;s attributes record state information and behavior to be shared by all instances created from the class and function <code>def</code> statements nested inside a <code>class</code> generate <em>methods</em>, which process instances.</p>
</li>
<li>
<p>Like a function, each time a class is called, it creates and returns a new instance object that inherits class attributes and gets its own namespace.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">red</span><span class="sh">'</span>

<span class="n">cat</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>  <span class="c1"># create an object from a class
</span><span class="n">tom</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>
<span class="n">jerry</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">tom</span><span class="p">.</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># red
</span><span class="nf">print</span><span class="p">(</span><span class="n">jerry</span><span class="p">.</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># red
</span>
<span class="n">tom</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">black</span><span class="sh">'</span>  <span class="c1"># object attributes take precedence over class attributes when accessed or modified
</span><span class="n">Cat</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span>  <span class="c1"># affect existing and new objects
</span>
<span class="n">butch</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">jerry</span><span class="p">.</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># blue
</span><span class="nf">print</span><span class="p">(</span><span class="n">tom</span><span class="p">.</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># black
</span><span class="nf">print</span><span class="p">(</span><span class="n">butch</span><span class="p">.</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># blue</span></code></pre>
</div>
</div>
</li>
<li>
<p>An instance method call <code>instance.method(args&#8230;&#8203;)</code> is automatically mapped to a class’s method functions as <code>class.method(instance, args&#8230;&#8203;)</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">meow!</span><span class="sh">'</span><span class="p">)</span>

<span class="n">tom</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>
<span class="n">tom</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># meow!
</span><span class="n">Cat</span><span class="p">.</span><span class="nf">wow</span><span class="p">(</span><span class="n">tom</span><span class="p">)</span>  <span class="c1"># meow!</span></code></pre>
</div>
</div>
</li>
<li>
<p>The built-in <code>instance.__class__</code> attribute provides a link from an instance to the class from which it was created, and classes in turn have a <code>__name__</code>, and a <code>__bases__</code> sequence that provides access to superclasses.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">tom</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>
<span class="n">tom</span><span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span>
<span class="n">tom</span><span class="p">.</span><span class="n">__class__</span><span class="p">.</span><span class="n">color</span>  <span class="c1"># red
</span><span class="n">tom</span><span class="p">.</span><span class="n">color</span>  <span class="c1"># blue</span></code></pre>
</div>
</div>
</li>
<li>
<p>The built-in <code>object.__dict__</code> attribute provides a dictionary for every attribute attached to a namespace object (including modules, classes, and instances).</p>
<div class="paragraph">
<p>Because attribute fetch qualification also performs an inheritance search, it can access inherited attributes that namespace dictionary indexing cannot.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Super</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data1</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>

<span class="k">class</span> <span class="nc">Sub</span><span class="p">(</span><span class="n">Super</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">hola</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data2</span> <span class="o">=</span> <span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span>

<span class="n">x</span> <span class="o">=</span> <span class="nc">Sub</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">__dict__</span>  <span class="c1"># instance namespace dict
# {}
</span><span class="n">x</span><span class="p">.</span><span class="n">__class__</span>  <span class="c1"># class of instance
# &lt;class '__main__.Sub'&gt;
</span><span class="n">x</span><span class="p">.</span><span class="n">__class__</span><span class="p">.</span><span class="n">__name__</span>
<span class="c1"># 'Sub'
</span><span class="n">Sub</span><span class="p">.</span><span class="n">__bases__</span>  <span class="c1"># superclasses of class
# (&lt;class '__main__.Super'&gt;,)
</span><span class="n">Super</span><span class="p">.</span><span class="n">__bases__</span>
<span class="c1"># (&lt;class 'object'&gt;,)
</span>
<span class="n">x</span><span class="p">.</span><span class="nf">hello</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">__dict__</span>
<span class="c1"># {'data1': 'spam'}
</span><span class="n">x</span><span class="p">.</span><span class="nf">hola</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">__dict__</span>
<span class="c1"># {'data1': 'spam', 'data2': 'eggs'}
</span><span class="n">x</span><span class="p">.</span><span class="n">data1</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">__dict__</span><span class="p">[</span><span class="sh">'</span><span class="s">data1</span><span class="sh">'</span><span class="p">]</span>
<span class="c1"># ('spam', 'spam')
</span><span class="n">x</span><span class="p">.</span><span class="n">data3</span> <span class="o">=</span> <span class="sh">'</span><span class="s">toast</span><span class="sh">'</span>
<span class="n">x</span><span class="p">.</span><span class="n">__dict__</span>
<span class="c1"># {'data1': 'spam', 'data2': 'eggs', 'data3': 'toast'}
</span>
<span class="n">x</span><span class="p">.</span><span class="n">__dict__</span><span class="p">[</span><span class="sh">'</span><span class="s">hello</span><span class="sh">'</span><span class="p">]</span>
<span class="c1"># KeyError: 'hello'</span></code></pre>
</div>
</div>
</li>
<li>
<p>In Python, the <code>super()</code> function is used to access the parent class&#8217;s methods and attributes and helps to call the parent class constructors in <code>__init__</code> in the correct order based on the method resolution order (MRO).</p>
</li>
<li>
<p>In classes, operator overloading is implemented by providing specially methods named with double underscores (<code>__X__</code>) to intercept operations.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># initialization: __init__(), to save syllables, double underscores (__), also pronounce as dunder.
</span><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="c1"># self is not a reserved word, but it’s common as the first argument to refer to the object itself.
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># initializer
</span>        <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="c1"># a method is a function in a class or object.
</span>    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">name</span><span class="si">:}</span><span class="s">: meow!</span><span class="sh">'</span><span class="p">)</span>


<span class="n">cat</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">(</span><span class="sh">'</span><span class="s">Tom</span><span class="sh">'</span><span class="p">)</span>
<span class="n">cat</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># Tom: meow!
</span><span class="n">Cat</span><span class="p">.</span><span class="nf">wow</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>  <span class="c1"># Tom: meow!</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="inheritances">12.1. Inheritances</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># inheritance is based on attribute lookup in Python (in X.name expressions)
</span><span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">voice</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">voice</span> <span class="o">=</span> <span class="n">voice</span>

    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">voice</span><span class="si">}</span><span class="s">!</span><span class="sh">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">Animal</span><span class="p">.</span><span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="sh">'</span><span class="s">meow</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Name superclass explicitly, pass self
</span>
<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">(</span><span class="sh">'</span><span class="s">bark</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Reference superclass generically, omit self
</span>
    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">voice</span><span class="si">}</span><span class="s">! </span><span class="sh">'</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>

<span class="n">cat</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">()</span>
<span class="n">cat</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># meow!
</span>
<span class="n">dog</span> <span class="o">=</span> <span class="nc">Dog</span><span class="p">()</span>
<span class="n">dog</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># bark! bark! bark!</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The inheritance search path is more breadth-first in diamond cases—Python first looks in any superclasses to the right of the one just searched before ascending to the common superclass at the top.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In other words, this search proceeds across by levels before moving up.</p>
</li>
<li>
<p>This search order is called the new-style MRO for “method resolution order” (and often just MRO for short when used in contrast with the classic DFLR, depth first, and then left to right order).</p>
</li>
<li>
<p>Despite the name, this is used for all attributes in Python, not just methods.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># multiple inheritance: method resolution order
</span><span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">I speak!</span><span class="sh">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Horse</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Neigh!</span><span class="sh">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Donkey</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Hee-haw!</span><span class="sh">'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Mule</span><span class="p">(</span><span class="n">Donkey</span><span class="p">,</span> <span class="n">Horse</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="nf">print</span><span class="p">(</span><span class="n">Mule</span><span class="p">.</span><span class="nf">mro</span><span class="p">())</span>
<span class="c1"># [&lt;class '__main__.Mule'&gt;, &lt;class '__main__.Donkey'&gt;, &lt;class '__main__.Horse'&gt;, &lt;class '__main__.Animal'&gt;, &lt;class 'object'&gt;]
</span>
<span class="k">class</span> <span class="nc">Hinny</span><span class="p">(</span><span class="n">Horse</span><span class="p">,</span> <span class="n">Donkey</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="nf">print</span><span class="p">(</span><span class="n">Hinny</span><span class="p">.</span><span class="n">__mro__</span><span class="p">)</span>
<span class="c1"># (&lt;class '__main__.Hinny'&gt;, &lt;class '__main__.Horse'&gt;, &lt;class '__main__.Donkey'&gt;, &lt;class '__main__.Animal'&gt;, &lt;class 'object'&gt;)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Mixins in Python are a code reuse technique used to add functionalities to classes
# without relying on traditional inheritance to achieve modularity.
</span><span class="k">class</span> <span class="nc">PrettyMixin</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="n">pprint</span>
        <span class="n">pprint</span><span class="p">.</span><span class="nf">pprint</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">self</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Thing</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Nyarlathotep</span><span class="sh">"</span>
        <span class="n">self</span><span class="p">.</span><span class="n">feature</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ichor</span><span class="sh">"</span>
        <span class="n">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="sh">"</span><span class="s">eldritch</span><span class="sh">"</span>

<span class="c1"># Mixins are included in a class definition using multiple inheritance syntax.
</span><span class="k">class</span> <span class="nc">PrettyThing</span><span class="p">(</span><span class="n">Thing</span><span class="p">,</span> <span class="n">PrettyMixin</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="n">t</span> <span class="o">=</span> <span class="nc">PrettyThing</span><span class="p">()</span>
<span class="n">t</span><span class="p">.</span><span class="nf">dump</span><span class="p">()</span>  <span class="c1"># {'age': 'eldritch', 'feature': 'ichor', 'name': 'Nyarlathotep'}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># Python doesn’t have private attributes, but has a naming convention for attributes that
# should not be visible outside of their class definition: begin with two underscores (__).
</span><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="c1"># getter
</span>        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">__name</span>

    <span class="nd">@name.setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>  <span class="c1"># setter
</span>        <span class="n">self</span><span class="p">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>

<span class="n">cat</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">(</span><span class="sh">'</span><span class="s">Tom</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">cat</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># Tom
</span><span class="n">cat</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Jerry</span><span class="sh">'</span>
<span class="nf">print</span><span class="p">(</span><span class="n">cat</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># Jerry</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># duck typing: a loose implementation of polymorphism
# If it walks like a duck and quacks like a duck, it’s a duck.
#     —— A Wise Person
</span><span class="k">class</span> <span class="nc">Duck</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">who</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">__name</span>

    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sh">'</span><span class="s">quack!</span><span class="sh">'</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">who</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">__name</span>

    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sh">'</span><span class="s">meow!</span><span class="sh">'</span>

<span class="k">def</span> <span class="nf">who_wow</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">obj</span><span class="p">.</span><span class="nf">who</span><span class="p">()</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">obj</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">who_wow</span><span class="p">(</span><span class="nc">Duck</span><span class="p">(</span><span class="sh">'</span><span class="s">Donald</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># Donald: quack!
</span><span class="nf">who_wow</span><span class="p">(</span><span class="nc">Cat</span><span class="p">(</span><span class="sh">'</span><span class="s">Tom</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># Tom: meow!</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># dataclasses
</span><span class="kn">from</span> <span class="n">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sh">'</span><span class="s">blue</span><span class="sh">'</span>

<span class="n">tom</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">(</span><span class="sh">'</span><span class="s">tom</span><span class="sh">'</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">tom</span><span class="p">)</span>  <span class="c1"># Cat(name='tom', age=3, color='blue')</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="slots-attribute-declarations">12.2. Slots: attribute declarations</h3>
<div class="paragraph">
<p>By assigning a sequence of string attribute names to a special <code>__slots__</code> class attribute, it can enable a new-style class to both limit the set of legal attributes that instances of the class will have, and optimize memory usage and possibly program speed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">limiter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">job</span><span class="sh">'</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="nf">limiter</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">age</span> <span class="c1"># Must assign before use
# AttributeError: age
</span><span class="n">x</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1"># Looks like instance data
</span><span class="n">x</span><span class="p">.</span><span class="n">age</span>
<span class="c1"># 40
</span><span class="n">x</span><span class="p">.</span><span class="n">ape</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># Illegal: not in __slots__
# AttributeError: 'limiter' object has no attribute 'ape'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="properties-attribute-accessors-a-k-a-getters-and-setters">12.3. Properties: attribute accessors (a.k.a. “getters” and “setters”)</h3>
<div class="paragraph">
<p>A property is a type of object assigned to a class attribute name by calling the <code>property</code> built-in function, passing in up to three accessor methods—handlers for get, set, and delete operations—as well as an optional docstring for the property.  If any argument is passed as None or omitted, that operation is not supported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">operators</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">40</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="nf">operators</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">age</span>  <span class="c1"># Runs __getattr__
# 40
</span><span class="n">x</span><span class="p">.</span><span class="n">name</span>  <span class="c1"># Runs __getattr__
# AttributeError: name</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">properties</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  <span class="c1"># Need object in 2.X for setters
</span>    <span class="k">def</span> <span class="nf">getage</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">40</span>
    <span class="n">age</span> <span class="o">=</span> <span class="nf">property</span><span class="p">(</span><span class="n">getage</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>  <span class="c1"># (get, set, del, docs), or use @
</span>
<span class="n">x</span> <span class="o">=</span> <span class="nf">properties</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">age</span>  <span class="c1"># Runs getage
# 40
</span><span class="n">x</span><span class="p">.</span><span class="n">name</span>  <span class="c1"># Normal fetch
# AttributeError: 'properties' object has no attribute 'name'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">properties</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  <span class="c1"># Need object in 2.X for setters
</span>    <span class="k">def</span> <span class="nf">getage</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">40</span>

    <span class="k">def</span> <span class="nf">setage</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">set age: %s</span><span class="sh">'</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_age</span> <span class="o">=</span> <span class="n">value</span>
    <span class="n">age</span> <span class="o">=</span> <span class="nf">property</span><span class="p">(</span><span class="n">getage</span><span class="p">,</span> <span class="n">setage</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="nf">properties</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">age</span>  <span class="c1"># Runs getage
# 40
</span><span class="n">x</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">42</span>  <span class="c1"># Runs setage
# set age: 42
</span><span class="n">x</span><span class="p">.</span><span class="n">_age</span>  <span class="c1"># Normal fetch: no getage call
# 42
</span><span class="n">x</span><span class="p">.</span><span class="n">age</span>  <span class="c1"># Runs getage
# 40
</span><span class="n">x</span><span class="p">.</span><span class="n">job</span> <span class="o">=</span> <span class="sh">'</span><span class="s">trainer</span><span class="sh">'</span>  <span class="c1"># Normal assign: no setage call
</span><span class="n">x</span><span class="p">.</span><span class="n">job</span>  <span class="c1"># Normal fetch: no getage call
# 'trainer'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">properties</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@property</span>  <span class="c1"># Coding properties with decorators: ahead
</span>    <span class="k">def</span> <span class="nf">age</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="bp">...</span>

    <span class="nd">@age.setter</span>
    <span class="k">def</span> <span class="nf">age</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">...</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="instance-methods-class-methods-static-methods">12.4. Instance methods, class methods, static methods</h3>
<div class="ulist">
<ul>
<li>
<p>Instance methods, passed a <code>self</code> instance object (the default)</p>
</li>
<li>
<p>Static methods, passed no extra object (via <code>staticmethod</code>)</p>
</li>
<li>
<p>Class methods, passed a class object (via <code>classmethod</code>, and inherent in metaclasses)</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Methods</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">imeth</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>  <span class="c1"># Normal instance method: passed a self
</span>        <span class="nf">print</span><span class="p">([</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">smeth</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># Static: no instance passed
</span>        <span class="nf">print</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">cmeth</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>  <span class="c1"># Class: gets class, not instance
</span>        <span class="nf">print</span><span class="p">([</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>

    <span class="n">smeth</span> <span class="o">=</span> <span class="nf">staticmethod</span><span class="p">(</span><span class="n">smeth</span><span class="p">)</span>  <span class="c1"># Make smeth a static method (or @: ahead)
</span>    <span class="n">cmeth</span> <span class="o">=</span> <span class="nf">classmethod</span><span class="p">(</span><span class="n">cmeth</span><span class="p">)</span>  <span class="c1"># Make cmeth a class method (or @: ahead)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Methods</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">imeth</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>  <span class="c1"># Normal instance method: passed a self
</span>        <span class="nf">print</span><span class="p">([</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">smeth</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  <span class="c1"># Static: no instance passed
</span>        <span class="nf">print</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">cmeth</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>  <span class="c1"># Class: gets class, not instance
</span>        <span class="nf">print</span><span class="p">([</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># instance methods, class methods, static methods
</span><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="c1"># Class attribute (shared by all instances)
</span>    <span class="n">species</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Felis catus</span><span class="sh">"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">self</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>

    <span class="c1"># Instance method (operates on a specific instance)
</span>    <span class="k">def</span> <span class="nf">meow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> says meow!</span><span class="sh">"</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_from_dict</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">cat_dict</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Class method to create a Cat object from a dictionary.

        Args:
            cls (class): The Cat class itself.
            cat_dict (dict): A dictionary containing cat data (name, age).

        Returns:
            Cat: A new Cat object.
        </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="nf">cls</span><span class="p">(</span><span class="n">cat_dict</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">],</span> <span class="n">cat_dict</span><span class="p">[</span><span class="sh">"</span><span class="s">age</span><span class="sh">"</span><span class="p">])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_adult</span><span class="p">(</span><span class="n">age</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Static method to check if a cat is considered adult (age &gt;= 1).

        Args:
            age (int): The cat</span><span class="sh">'</span><span class="s">s age.

        Returns:
            bool: True if the cat is adult, False otherwise.
        </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">1</span>


<span class="c1"># Create Cat objects
</span><span class="n">cat1</span> <span class="o">=</span> <span class="nc">Cat</span><span class="p">(</span><span class="sh">"</span><span class="s">Whiskers</span><span class="sh">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cat2</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">.</span><span class="nf">create_from_dict</span><span class="p">({</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Luna</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">age</span><span class="sh">"</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>

<span class="c1"># Instance method call (operates on specific objects)
</span><span class="n">cat1</span><span class="p">.</span><span class="nf">meow</span><span class="p">()</span>  <span class="c1"># Output: Whiskers says meow!
</span><span class="n">cat2</span><span class="p">.</span><span class="nf">meow</span><span class="p">()</span>  <span class="c1"># Output: Luna says meow!
</span>
<span class="c1"># Class method call
</span><span class="n">new_cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">.</span><span class="nf">create_from_dict</span><span class="p">({</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Simba</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">age</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Static method call
</span><span class="n">is_cat1_adult</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">.</span><span class="nf">is_adult</span><span class="p">(</span><span class="n">cat1</span><span class="p">.</span><span class="n">age</span><span class="p">)</span>

<span class="c1"># Output: Simba is 1 years old.
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">new_cat</span><span class="p">.</span><span class="n">name</span><span class="si">}</span><span class="s"> is </span><span class="si">{</span><span class="n">new_cat</span><span class="p">.</span><span class="n">age</span><span class="si">}</span><span class="s"> years old.</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># Output: Is Whiskers an adult? True
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Is Whiskers an adult? </span><span class="si">{</span><span class="n">is_cat1_adult</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="operator-overloading">12.5. Operator overloading</h3>
<div class="ulist">
<ul>
<li>
<p>Operator overloading lets classes intercept normal Python operations.</p>
</li>
<li>
<p>Classes can overload all Python expression operators.</p>
</li>
<li>
<p>Classes can also overload built-in operations such as printing, function calls, attribute access, etc.</p>
</li>
<li>
<p>Overloading makes class instances act more like built-in types.</p>
</li>
<li>
<p>Overloading is implemented by providing specially named methods in a class.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="constructors-and-destructions-__init__-__del__">12.5.1. Constructors and destructions: __init__, __del__</h4>
<div class="paragraph">
<p>The <code>__init__</code> <em>constructor</em> is called whenever an instance is generated, and its counterpart, the <code>__del__</code> <em>destructor</em> is run automatically when an instance’s space is being reclaimed (i.e., at “garbage collection” time).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Technically, instance creation first triggers the <code>__new__</code> method, which creates and returns the new instance object, which is then passed into <code>__init__</code> for initialization.</p>
</li>
<li>
<p>Python automatically reclaims all memory space held by an instance when the instance is reclaimed, destructors are not necessary for space management. It’s often better to code termination activities in an explicitly called method (e.g., <code>shutdown</code>), and the <code>try/finally</code> statement also supports termination actions, as does the <code>with</code> statement for objects that support its context manager model.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Life</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">'</span><span class="s">unknown</span><span class="sh">'</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Hello </span><span class="sh">'</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">live</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Goodbye </span><span class="sh">'</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">name</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">brian</span> <span class="o">=</span> <span class="nc">Life</span><span class="p">(</span><span class="sh">'</span><span class="s">Brian</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Hello Brian
</span><span class="n">brian</span><span class="p">.</span><span class="nf">live</span><span class="p">()</span>  <span class="c1"># Brian
</span><span class="n">brian</span> <span class="o">=</span> <span class="sh">'</span><span class="s">loretta</span><span class="sh">'</span>  <span class="c1"># Goodbye Brian</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="indexing-and-slicing-__getitem__-and-__setitem__">12.5.2. Indexing and slicing: __getitem__ and __setitem__</h4>
<div class="ulist">
<ul>
<li>
<p>When an instance <code>X</code> appears in an <em>indexing expression</em> like <code>X[i]</code>, Python calls the <code>__getitem__</code> method inherited by the instance, passing <code>X</code> and the index in brackets to the arguments.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Indexer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">index</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">X</span> <span class="o">=</span> <span class="nc">Indexer</span><span class="p">()</span>
<span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># X[i] calls X.__getitem__(i)
# 4
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># Runs __getitem__(X, i) each time
# 0 1 4 9 16</span></code></pre>
</div>
</div>
</li>
<li>
<p>In addition to indexing, <code>__getitem__</code> is also called for <em>slice expressions</em>—using upper and lower bounds and a stride bundled up into a slice object.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Indexer</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>  <span class="c1"># Called for index or slice
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">getitem:</span><span class="sh">'</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># Perform index or slice</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">Indexer</span><span class="p">()</span>
<span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># getitem: 0
# 5
</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># getitem: -1
# 9
</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="c1"># getitem: slice(2, 4, None)
# [7, 8]
</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="c1"># getitem: slice(1, None, None)
# [6, 7, 8, 9]
</span><span class="n">X</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># getitem: slice(None, -1, None)
# [5, 6, 7, 8]
</span><span class="n">X</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># getitem: slice(None, None, 2)
# [5, 7, 9]</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>__getitem__</code> may be also called automatically as an iteration fallback option (all iteration contexts will try the <code>__iter__</code> method first), for example, the <code>for</code> loops, <code>in</code> membership test, list comprehensions, the <code>map</code> built-in, list and tuple assignments, and type constructors.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">StepperIndex</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">StepperIndex</span><span class="p">(</span><span class="sh">'</span><span class="s">Spam</span><span class="sh">'</span><span class="p">)</span>

<span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Indexing calls __getitem__
# 'p'
</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>  <span class="c1"># for loops call __getitem__
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># for indexes items 0..N
# S p a m
</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">X</span>  <span class="c1"># All call __getitem__ too
# True
</span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>  <span class="c1"># List comprehension
# ['S', 'p', 'a', 'm']
</span><span class="nf">list</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">str</span><span class="p">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span>  <span class="c1"># map calls
# ['S', 'P', 'A', 'M']
</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span>  <span class="c1"># Sequence assignments
</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>
<span class="c1"># ('S', 'a', 'm')
</span><span class="nf">list</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nf">tuple</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># And so on...
# (['S', 'p', 'a', 'm'], ('S', 'p', 'a', 'm'), 'Spam')</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>__setitem__</code> index assignment method similarly intercepts both index and slice assignments.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">IndexSetter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>  <span class="c1"># Intercept index or slice assignment
</span>        <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># Assign index or slice</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>__index__</code> method returns an integer value for an instance when needed and is used by built-ins that convert to digit strings.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__index__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">255</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">C</span><span class="p">()</span>
<span class="nf">hex</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># '0xff'
</span><span class="nf">bin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># '0b11111111'
</span><span class="nf">oct</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># '0o377'</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="iterable-objects-__iter__-and-__next__">12.5.3. Iterable objects: __iter__ and __next__</h4>
<div class="ulist">
<ul>
<li>
<p>Technically, iteration contexts work by passing an iterable object to the <code>iter</code> built-in function to invoke an <code>__iter__</code> method, which is expected to return an iterator object.</p>
</li>
<li>
<p>If it’s provided, Python then repeatedly calls the iterator object’s <code>__next__</code> method to produce items until a <code>StopIteration</code> exception is raised.</p>
</li>
<li>
<p>A <code>next</code> built-in function is also available as a convenience for manual iterations—<code>next(I)</code> is the same as <code>I.<em>next</em>()</code>.</p>
</li>
<li>
<p>In all iteration contexts, Python tries to use <code>__iter__</code> first, which returns an object that supports the iteration protocol with a <code>__next__</code> method: if no <code>__iter__</code> is found by inheritance search, Python falls back on the <code>__getitem__</code> indexing method, which is called repeatedly, with successively higher indexes, until an <code>IndexError</code> exception is raised.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Squares</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">):</span>  <span class="c1"># Save state when created
</span>        <span class="n">self</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">self</span><span class="p">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="c1"># Get iterator object on iter
</span>        <span class="k">return</span> <span class="n">self</span>  <span class="c1"># One-shot iteration, single traversal only
</span>
    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="c1"># Return a square on each iteration
</span>        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">stop</span><span class="p">:</span>  <span class="c1"># Also called by next built-in
</span>            <span class="k">raise</span> <span class="nb">StopIteration</span>
        <span class="n">self</span><span class="p">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">value</span> <span class="o">**</span> <span class="mi">2</span></code></pre>
</div>
</div>
</li>
<li>
<p>If used, the <code>yield</code> statement can create the <code>__next__</code> method automatically.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Squares</span><span class="p">:</span>                          <span class="c1"># __iter__ + yield generator
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">):</span>    <span class="c1"># __next__ is automatic/implied
</span>        <span class="n">self</span><span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="n">self</span><span class="p">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">start</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">value</span> <span class="o">**</span> <span class="mi">2</span></code></pre>
</div>
</div>
</li>
<li>
<p>To achieve the multiple-iterator effect on one object, <code>__iter__</code> simply needs to define a new stateful object for the iterator, instead of returning <code>self</code> for each iterator request.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">SkipObject</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">wrapped</span><span class="p">):</span>  <span class="c1"># Save item to be used
</span>        <span class="n">self</span><span class="p">.</span><span class="n">wrapped</span> <span class="o">=</span> <span class="n">wrapped</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nc">SkipIterator</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">wrapped</span><span class="p">)</span>  <span class="c1"># New iterator each time
</span>
<span class="k">class</span> <span class="nc">SkipIterator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">wrapped</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">wrapped</span> <span class="o">=</span> <span class="n">wrapped</span>  <span class="c1"># Iterator state information
</span>        <span class="n">self</span><span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__next__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">offset</span> <span class="o">&gt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">wrapped</span><span class="p">):</span>  <span class="c1"># Terminate iterations
</span>            <span class="k">raise</span> <span class="nb">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">wrapped</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">offset</span><span class="p">]</span>  <span class="c1"># else return and skip
</span>            <span class="n">self</span><span class="p">.</span><span class="n">offset</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">return</span> <span class="n">item</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="membership-__contains__-__iter__-and-__getitem__">12.5.4. Membership: __contains__, __iter__, and __getitem__</h4>
<div class="ulist">
<ul>
<li>
<p>In the iterations domain, classes can implement the <code>in</code> membership operator as an iteration, using either the <code>__iter__</code> or <code>__getitem__</code> methods.</p>
</li>
<li>
<p>To support more specific membership, though, classes may code a <code>__contains__</code> method—when present, this method is preferred over <code>__iter__</code>, which is preferred over <code>__getitem__</code>.</p>
</li>
<li>
<p>The <code>__contains__</code> method should define membership as applying to keys for a mapping (and can use quick lookups), and as a search for <em>sequences</em>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Iters</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>  <span class="c1"># Fallback for iteration
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">get[%s]:</span><span class="sh">'</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>  <span class="c1"># Also for index, slice
</span>        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="c1"># Preferred for iteration
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">iter=&gt; next:</span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>  <span class="c1"># Allows multiple active iterators
</span>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">:</span>  <span class="c1"># no __next__ to alias to next
</span>            <span class="k">yield</span> <span class="n">x</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">next:</span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>  <span class="c1"># Preferred for 'in'
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">contains: </span><span class="sh">'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="attribute-access-__getattr__-and-__setattr__">12.5.5. Attribute access: __getattr__ and __setattr__</h4>
<div class="ulist">
<ul>
<li>
<p>The <code>__getattr__</code> method intercepts attribute references.</p>
<div class="ulist">
<ul>
<li>
<p>It’s called with the attribute name as a string whenever trying to qualify an instance with an undefined (nonexistent) attribute name.</p>
</li>
<li>
<p>It is not called if Python can find the attribute using its inheritance tree search procedure.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Empty</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">attrname</span><span class="p">):</span>  <span class="c1"># On self.undefined
</span>        <span class="k">if</span> <span class="n">attrname</span> <span class="o">==</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">:</span>  <span class="c1"># age becomes a dynamically computed attribute
</span>            <span class="k">return</span> <span class="mi">40</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">AttributeError</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>  <span class="c1"># raises the builtin AttributeError exception</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">Empty</span><span class="p">()</span>
<span class="n">X</span><span class="p">.</span><span class="n">age</span>  <span class="c1"># 40
</span><span class="nf">getattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 40
</span>
<span class="n">X</span><span class="p">.</span><span class="n">name</span>  <span class="c1"># AttributeError: name
</span><span class="nf">getattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Jon</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># 'Jon'
</span>
<span class="nf">hasattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># False
</span>
<span class="nf">setattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Jon X</span><span class="sh">'</span><span class="p">)</span>
<span class="n">X</span><span class="p">.</span><span class="n">name</span>  <span class="c1"># 'Jon X'</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the same department, the <code>__setattr__</code> intercepts all attribute assignments.</p>
<div class="ulist">
<ul>
<li>
<p>If the method is defined or inherited, <code>self.attr = value</code> becomes <code>self.__setattr__('attr', value)</code>.</p>
</li>
<li>
<p>Assigning to any <code>self</code> attributes within <code>__setattr__</code> calls <code>__setattr__</code> again, potentially causing an infinite recursion loop.</p>
</li>
<li>
<p>Avoid loops by coding instance attribute assignments as assignments to attribute dictionary keys:  <code>self.<em>dict</em>['name'] = x</code>, not <code>self.name = x</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Accesscontrol</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="sh">'</span><span class="s">age</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">10</span>  <span class="c1"># Not self.name=val or setattr
</span>            <span class="c1"># It’s also possible to avoid recursive loops in a class that uses __setattr__ by routing
</span>            <span class="c1"># any attribute assignments to a higher superclass with a call, instead of assigning keys
</span>            <span class="c1"># in __dict__:
</span>            <span class="c1">#    self.__dict__[attr] = value + 10 # OK: doesn't loop
</span>            <span class="c1">#    object.__setattr__(self, attr, value + 10) # OK: doesn't loop (new-style only)
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">AttributeError</span><span class="p">(</span><span class="n">attr</span> <span class="o">+</span> <span class="sh">'</span><span class="s"> not allowed</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">Accesscontrol</span><span class="p">()</span>
<span class="n">X</span><span class="p">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">X</span><span class="p">.</span><span class="n">age</span>  <span class="c1"># 50
</span><span class="n">X</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Bob</span><span class="sh">'</span>  <span class="c1"># AttributeError: name not allowed</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>A third attribute management method, <code>__delattr__</code>, is passed the attribute name string and invoked on all attribute deletions (i.e., <code>del object.attr</code>).</p>
<div class="ulist">
<ul>
<li>
<p>Like <code>__setattr__</code>, it must avoid recursive loops by routing attribute deletions with the using class through <code>__dict__</code> or a superclass.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The built-in <code>getattr</code> function is used to fetch an attribute from an object by name string—<code>getattr(X,N)</code> is like <code>X.N</code>, except that <code>N</code> is an expression that evaluates to a string at runtime, not a variable.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Wrapper</span><span class="p">:</span>  <span class="c1"># A wrapper (sometimes called a proxy) class
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">wrapped</span> <span class="o">=</span> <span class="nb">object</span>  <span class="c1"># Save object
</span>
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">attrname</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Trace: </span><span class="sh">'</span> <span class="o">+</span> <span class="n">attrname</span><span class="p">)</span>  <span class="c1"># Trace fetch
</span>        <span class="k">return</span> <span class="nf">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">wrapped</span><span class="p">,</span> <span class="n">attrname</span><span class="p">)</span>  <span class="c1"># Delegate fetch</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="string-representation-__repr__-and-__str__">12.5.6. String representation: __repr__ and __str__</h4>
<div class="paragraph">
<p>If defined, <code>__repr__</code> (or its close relative, <code>__str__</code>) is called automatically when class instances are printed or converted to strings.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>__str__</code> is tried first for the <code>print</code> operation and the <code>str</code> built-in function (the internal equivalent of which <code>print</code> runs). It generally should return a user-friendly display.</p>
</li>
<li>
<p><code>__repr__</code> is used in all other contexts: for interactive echoes, the <code>repr</code> function, and nested appearances, as well as by <code>print</code> and <code>str</code> if no <code>__str__</code> is present. It should generally return an as-code string that could be used to re-create the object, or a detailed display for developers.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">adder</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># Initialize data
</span>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">other</span>  <span class="c1"># Add other in place (bad form?)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nf">adder</span><span class="p">()</span>  <span class="c1"># Default displays
</span><span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># &lt;__main__.adder object at 0x7fd1fd745a50&gt;
</span><span class="n">x</span>
<span class="c1"># &lt;__main__.adder object at 0x7fd1fd745a50&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">addrepr</span><span class="p">(</span><span class="n">adder</span><span class="p">):</span>  <span class="c1"># Inherit __init__, __add__
</span>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="c1"># Add string representation
</span>        <span class="k">return</span> <span class="sh">'</span><span class="s">addrepr(%s)</span><span class="sh">'</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span>  <span class="c1"># Convert to as-code string</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nf">addrepr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span>  <span class="c1"># Runs __repr__
# addrepr(2)
</span><span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Runs __repr__
# addrepr(2)
</span><span class="nf">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nf">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Runs __repr__ for both
# ('addrepr(2)', 'addrepr(2)')</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">addstr</span><span class="p">(</span><span class="n">adder</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>  <span class="c1"># __str__ but no __repr__
</span>        <span class="k">return</span> <span class="sh">'</span><span class="s">[Value: %s]</span><span class="sh">'</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span>  <span class="c1"># Convert to nice string</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nf">addstr</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span>  <span class="c1"># Default __repr__
# &lt;demo.addstr object at 0x7fd1fd63d2d0&gt;
</span><span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># # Runs __str__
# [Value: 3]
</span><span class="nf">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nf">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># ('[Value: 3]', '&lt;demo.addstr object at 0x7fd1fd63d2d0&gt;')</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">addboth</span><span class="p">(</span><span class="n">adder</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sh">'</span><span class="s">[Value: %s]</span><span class="sh">'</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span>  <span class="c1"># User-friendly string
</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sh">'</span><span class="s">addboth(%s)</span><span class="sh">'</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span>  <span class="c1"># As-code string</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nf">addboth</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x</span>  <span class="c1"># Runs __repr__
# addboth(4)
</span><span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Runs __str__
# [Value: 4]
</span><span class="nf">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nf">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># ('[Value: 4]', 'addboth(4)')</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="right-side-and-in-place-uses-__radd__-and-__iadd__">12.5.7. Right-side and in-place uses: __radd__ and __iadd__</h4>
<div class="ulist">
<ul>
<li>
<p>Every binary operator has a left, right, and in-place variant overloading methods (e.g., <code>__add__</code>, <code>__radd__</code>, and <code>__iadd__</code>).</p>
</li>
<li>
<p>For example, the <code>__add__</code> for objects on the left is called instead in all other cases and does not support the use of instance objects on the right side of the <code>+</code> operator.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Number</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="o">+</span><span class="n">other</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nc">Number</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="c1"># 7
</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span>
<span class="c1"># TypeError: unsupported operand type(s) for +: 'int' and 'Number'</span></code></pre>
</div>
</div>
</li>
<li>
<p>To implement more general expressions, and hence support commutative-style operators, code the <code>__radd__</code> method as well.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Number</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="o">+</span><span class="n">other</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="o">+</span><span class="n">other</span>

    <span class="c1"># Reusing __add__ in __radd__
</span>    <span class="c1"># def __radd__(self, other):
</span>    <span class="c1">#     return self.__add__(other)  # Call __add__ explicitly
</span>    <span class="c1">#     return self + other  # Swap order and re-add
</span>    <span class="c1"># __radd__ = __add__  # Alias: cut out the middleman</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nc">Number</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="c1"># 7
</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span>
<span class="c1"># 7</span></code></pre>
</div>
</div>
</li>
<li>
<p>To also implement <code>+=</code> in-place augmented addition, code either an <code>__iadd__</code> or an <code>__add__</code>. The latter is used if the former is absent, but may not be able optimize in-place cases.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Number</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="o">+</span><span class="n">other</span>

    <span class="n">__radd__</span> <span class="o">=</span> <span class="n">__add__</span>

    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># __iadd__ explicit: x += y
</span>        <span class="n">self</span><span class="p">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">other</span>  <span class="c1"># Usually returns self
</span>        <span class="k">return</span> <span class="n">self</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">x</span> <span class="o">=</span> <span class="nc">Number</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">x</span><span class="p">.</span><span class="n">data</span>
<span class="c1"># 7</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="call-expressions-__call__">12.5.8. Call expressions: __call__</h4>
<div class="ulist">
<ul>
<li>
<p>Python runs a <code>__call__</code> method for function call expressions applied to the instances, passing along whatever positional or keyword arguments were sent.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Callee</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>  <span class="c1"># Intercept instance calls
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Called:</span><span class="sh">'</span><span class="p">,</span> <span class="n">pargs</span><span class="p">,</span> <span class="n">kargs</span><span class="p">)</span>  <span class="c1"># Accept arbitrary arguments</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">C</span> <span class="o">=</span> <span class="nc">Callee</span><span class="p">()</span>
<span class="nc">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># C is a callable object
# Called: (1, 2, 3) {}
</span><span class="nc">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># Called: (1, 2, 3) {'y': 5, 'x': 4}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># Normals and defaults
</span>
<span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># Collect arbitrary arguments
</span>
<span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pargs</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span> <span class="p">...</span>  <span class="c1"># 3.X keyword-only argument</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="boolean-tests-__bool__-and-__len__">12.5.9. Boolean tests: __bool__ and __len__</h4>
<div class="ulist">
<ul>
<li>
<p>In Boolean contexts, Python first tries <code>__bool__</code> to obtain a direct Boolean value; if that method is missing, Python tries <code>__len__</code> to infer a truth value from the object’s length.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Truth</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">True</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">Truth</span><span class="p">()</span>
<span class="k">if</span> <span class="n">X</span><span class="p">:</span> <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">yes!</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># yes!</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Truth</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">False</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">Truth</span><span class="p">()</span>
<span class="nf">bool</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># False</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Truth</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">0</span>
<span class="n">X</span> <span class="o">=</span> <span class="nc">Truth</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">X</span><span class="p">:</span> <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">no!</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># no!</span></code></pre>
</div>
</div>
</li>
<li>
<p>If both methods are present Python prefers <code>__bool__</code> over <code>__len__</code>, because it is more specific:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Truth</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">True</span> <span class="c1"># 3.X tries __bool__ first
</span>    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span> <span class="k">return</span> <span class="mi">0</span> <span class="c1"># 2.X tries __len__ first
</span><span class="n">X</span> <span class="o">=</span> <span class="nc">Truth</span><span class="p">()</span>
<span class="k">if</span> <span class="n">X</span><span class="p">:</span> <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">yes!</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># yes!</span></code></pre>
</div>
</div>
</li>
<li>
<p>If neither truth method is defined, the object is vacuously considered true (though any potential implications for more metaphysically inclined readers are strictly coincidental):</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Truth</span><span class="p">:</span>
    <span class="k">pass</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">X</span> <span class="o">=</span> <span class="nc">Truth</span><span class="p">()</span>
<span class="nf">bool</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># True</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="withas-context-managers-__enter__-and-__exit__">12.5.10. with/as Context Managers: __enter__ and __exit__</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">with</span> <span class="n">expression</span> <span class="p">[</span><span class="k">as</span> <span class="n">variable</span><span class="p">],</span> <span class="p">[</span><span class="n">expression</span> <span class="p">[</span><span class="k">as</span> <span class="n">variable</span><span class="p">]]:</span>
    <span class="k">with</span><span class="o">-</span><span class="n">block</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>with</code> statement can be used with any object that implements the <code>__enter__()</code> and <code>__exit__()</code> special methods that provide hooks for initializing and finalizing resource management. Common resources managed with with include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Files: The with <code>open('filename', 'mode') as file:</code> syntax opens a file, assigns it to a variable (<code>file</code>), and automatically closes the file when the indented block exits, even in case of exceptions.</p>
</li>
<li>
<p>Database Connections: <code>with sqlite3.connect(':memory:') as con:</code> creates a connection, assigns it to a variable, and guarantees closure upon exiting the block.</p>
</li>
<li>
<p>Locks: In multithreaded environments, with can be used with lock objects to acquire a lock at the beginning of the block and release it at the end, ensuring proper synchronization.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="n">fi</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">test.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">fi</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">hello world</span><span class="sh">'</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">fi</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">test.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">fo</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">,</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">res</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>  <span class="c1"># multiple context managers
</span>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fin</span><span class="p">:</span>
        <span class="k">if</span> <span class="sh">'</span><span class="s">some key</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">fout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">A custom context manager class that simulates a cat entering and leaving.</span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Called when entering the `with` block. Prints a message and returns itself.

        Returns:
            The Cat instance (self) to be used within the `with` block.
        </span><span class="sh">"""</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m coming in!</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self</span>  <span class="c1"># Return self to provide the managed object to the `with` block
</span>
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">traceback</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">
        Called when exiting the `with` block, regardless of exceptions.
        Prints a message, optionally handles exceptions, and returns True to suppress them.

        Args:
            exc_type (type): The type of exception raised within the `with` block (if any).
            exc_value (object): The actual exception object raised (if any).
            traceback (object): A traceback object containing information about the call stack
                               (if any exception was raised).

        Returns:
            bool: True to suppress any exceptions raised within the `with` block,
                  False to re-raise them. (Can be modified for specific exception handling)
        </span><span class="sh">"""</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m going out.</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># Suppress potential exceptions (modify for specific handling)
</span>        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">
        Method to simulate a cat</span><span class="sh">'</span><span class="s">s meow. Prints </span><span class="sh">"</span><span class="s">meow!</span><span class="sh">"</span><span class="s">.

        Returns:
            None
        </span><span class="sh">"""</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">meow!</span><span class="sh">"</span><span class="p">)</span>


<span class="k">with</span> <span class="nc">Cat</span><span class="p">()</span> <span class="k">as</span> <span class="n">cat</span><span class="p">:</span>  <span class="c1"># type: Cat
</span>    <span class="sh">"""</span><span class="s">Enters the context manager and assigns the Cat object to </span><span class="sh">'</span><span class="s">cat</span><span class="sh">'</span><span class="s">.</span><span class="sh">"""</span>
    <span class="n">cat</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># Calls the cat's meow method within the context
</span>
<span class="c1"># I'm coming in!
# meow!
# I'm going out.</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enum">12.6. Enum</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Added in version 3.4.</p>
</div>
</blockquote>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span> <span class="nc">Weekday</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">MONDAY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">TUESDAY</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">WEDNESDAY</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">THURSDAY</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">FRIDAY</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">SATURDAY</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">SUNDAY</span> <span class="o">=</span> <span class="mi">7</span>

<span class="nc">Weekday</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="c1"># &lt;Weekday.WEDNESDAY: 3&gt;
</span><span class="n">Weekday</span><span class="p">[</span><span class="sh">"</span><span class="s">WEDNESDAY</span><span class="sh">"</span><span class="p">]</span>  <span class="c1"># &lt;Weekday.WEDNESDAY: 3&gt;
</span>
<span class="nf">print</span><span class="p">(</span><span class="n">Weekday</span><span class="p">.</span><span class="n">THURSDAY</span><span class="p">)</span>         <span class="c1"># Weekday.THURSDAY
</span><span class="nf">print</span><span class="p">(</span><span class="n">Weekday</span><span class="p">.</span><span class="n">TUESDAY</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>     <span class="c1"># TUESDAY
</span><span class="nf">print</span><span class="p">(</span><span class="n">Weekday</span><span class="p">.</span><span class="n">WEDNESDAY</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># 3
</span>
<span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nf">list</span><span class="p">(</span><span class="n">Weekday</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
<span class="c1"># Weekday.MONDAY
# Weekday.TUESDAY
# Weekday.WEDNESDAY
# Weekday.THURSDAY
# Weekday.FRIDAY
# Weekday.SATURDAY
# Weekday.SUNDAY</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">enum</span> <span class="kn">import</span> <span class="n">Flag</span>

<span class="k">class</span> <span class="nc">Weekday</span><span class="p">(</span><span class="n">Flag</span><span class="p">):</span>
    <span class="n">MONDAY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">TUESDAY</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">WEDNESDAY</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">THURSDAY</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">FRIDAY</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">SATURDAY</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">SUNDAY</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">weekend</span> <span class="o">=</span> <span class="n">Weekday</span><span class="p">.</span><span class="n">SATURDAY</span> <span class="o">|</span> <span class="n">Weekday</span><span class="p">.</span><span class="n">SUNDAY</span>
<span class="c1"># &lt;Weekday.SATURDAY|SUNDAY: 96&gt;
</span><span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">weekend</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
<span class="c1"># Weekday.SATURDAY
# Weekday.SUNDAY</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exceptions">13. Exceptions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An exception is a class, which is a child of the class <code>Exception</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">OopsException</span><span class="p">(</span><span class="nb">Exception</span><span class="p">):</span> <span class="k">pass</span>  <span class="c1"># user-defined exception</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>raise</code> statement raises (triggers) a built-in or user-defined exception.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">raise</span> <span class="n">instance</span>  <span class="c1"># raise instance of class
</span><span class="k">raise</span> <span class="n">clazz</span>     <span class="c1"># make and raise instance of class: makes an instance with no constructor arguments
</span><span class="k">raise</span>           <span class="c1"># reraise the most recent exception</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">try</span><span class="p">:</span>
    <span class="mi">1</span> <span class="o">/</span> <span class="mi">0</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
    <span class="k">raise</span> <span class="nc">TypeError</span><span class="p">(</span><span class="sh">'</span><span class="s">Bad</span><span class="sh">'</span><span class="p">)</span> <span class="k">from</span> <span class="n">E</span>  <span class="c1"># raise newexception from otherexception
</span>
<span class="c1"># Traceback (most recent call last):
# ZeroDivisionError: division by zero
#
# The above exception was the direct cause of the following exception:
#
# Traceback (most recent call last):
# TypeError: Bad</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>assert</code> statement raises an <code>AssertionError</code> exception if a condition is false.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># assert test, data # the data part is optional
</span><span class="k">assert</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">'</span><span class="s">Nobody expects the Spanish Inquisition!</span><span class="sh">'</span>  <span class="c1"># AssertionError: Nobody expects the Spanish Inquisition!</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>try</code> statement catches and recovers from exceptions with one or more handlers for exceptions that may be raised during the block’s execution.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># try -&gt; except -&gt; else -&gt; finally
</span><span class="k">try</span><span class="p">:</span>
    <span class="k">raise</span> <span class="nc">OopsException</span><span class="p">(</span><span class="sh">'</span><span class="s">panic</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># raising exceptions
</span><span class="k">except</span> <span class="n">OopsException</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>  <span class="c1"># 3.X localizes 'as' names to except block
</span>    <span class="nf">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>  <span class="c1"># catch and recover from exceptions
</span><span class="nf">except </span><span class="p">(</span><span class="nb">RuntimeError</span><span class="p">,</span> <span class="nb">TypeError</span><span class="p">,</span> <span class="nb">NameError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>  <span class="c1"># multiple exceptions as a parenthesized tuple
</span>    <span class="bp">...</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">other</span><span class="p">:</span>  <span class="c1"># except to catch all exceptions
</span>    <span class="bp">...</span>
<span class="k">except</span><span class="p">:</span>  <span class="c1"># bare except to catch all exceptions
</span>    <span class="bp">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="p">...</span> <span class="c1"># run if no exception was raised during try block
</span><span class="k">finally</span><span class="p">:</span>  <span class="c1"># termination actions
</span>    <span class="bp">...</span></code></pre>
</div>
</div>
</li>
<li>
<p>The <code>with/as</code> statement is designed to automate startup and termination activities that must occur around a block of code.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># try:
#     file = open('lumberjack.txt', 'w', encoding='utf-8')
#     file.write('The larch!\n')
# finally:
#     if file: file.close()
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">lumberjack.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>  <span class="c1"># always close file on exit
</span>    <span class="nb">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">The larch!</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="decorators">14. Decorators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A decorator is a <em>callable that returns a callable</em> to specify management or augmentation code for functions and classes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Function decorators, do name rebinding at function definition time, install wrapper objects to intercept later function calls and process them as needed, usually passing the call on to the original function to run the managed action.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>
    <span class="c1"># Process function F
</span>    <span class="k">return</span> <span class="n">F</span>

<span class="nd">@decorator</span>       <span class="c1"># Decorate function
</span><span class="k">def</span> <span class="nf">func</span><span class="p">():</span> <span class="p">...</span>  <span class="c1"># func = decorator(func)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>
    <span class="c1"># Save or use function F
</span>    <span class="c1"># Return a different callable, a proxy: nested def, class with __call__, etc.
</span>    <span class="bp">...</span>

<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span> <span class="p">...</span>  <span class="c1"># func = decorator(func)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>                 <span class="c1"># On @ decoration
</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>  <span class="c1"># On wrapped function call that retains the original function in an enclosing scope
</span>        <span class="c1"># Use F, args, and  kargs
</span>        <span class="c1"># F(*args, **kargs) calls original function
</span>        <span class="bp">...</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@decorator</span>                         <span class="c1"># func = decorator(func)
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">122</span><span class="p">):</span>             <span class="c1"># func is passed to decorator's F
</span>    <span class="bp">...</span>

<span class="nf">func</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>                      <span class="c1"># 6, 7, 8 are passed to wrapper's *args, **kargs</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">class</span> <span class="nc">decorator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>  <span class="c1"># On @ decoration
</span>        <span class="n">self</span><span class="p">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>  <span class="c1"># On wrapped function call by overloading the call operation
</span>        <span class="c1"># Use self.func and args
</span>        <span class="c1"># self.func(*args) calls original function
</span>
<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>                 <span class="c1"># func = decorator(func)
</span>    <span class="p">...</span>                         <span class="c1"># func is passed to __init__
</span>
<span class="nf">func</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>                      <span class="c1"># 6, 7 are passed to __call__'s *args</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="c1"># Save or use A, B
</span>    <span class="k">def</span> <span class="nf">actualDecorator</span><span class="p">(</span><span class="n">F</span><span class="p">):</span>
        <span class="c1"># Save or use function F
</span>        <span class="c1"># Return a callable: nested def, class with __call__, etc.
</span>        <span class="k">return</span> <span class="nb">callable</span>
    <span class="k">return</span> <span class="n">actualDecorator</span>

<span class="nd">@decorator</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>  <span class="c1"># F = decorator(A, B)(F) # Rebind F to result of decorator's return value
</span>    <span class="bp">...</span></code></pre>
</div>
</div>
</li>
<li>
<p>Class decorators, do name rebinding at class definition time, install wrapper objects to intercept later instance creation calls and process them as needed, usually passing the call on to the original class to create a managed instance.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
    <span class="c1"># Process class C
</span>    <span class="k">return</span> <span class="n">C</span>

<span class="nd">@decorator</span>  <span class="c1"># Decorate class
</span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="p">...</span>     <span class="c1"># C = decorator(C)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
    <span class="c1"># Save or use class C
</span>    <span class="c1"># Return a different callable, a proxy: nested def, class with __call__, etc.
</span>
<span class="nd">@decorator</span>
<span class="k">class</span> <span class="nc">C</span><span class="p">:</span>
    <span class="p">...</span>  <span class="c1"># C = decorator(C)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>                             <span class="c1"># On @ decoration
</span>    <span class="k">class</span> <span class="nc">Wrapper</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>              <span class="c1"># On instance creation
</span>            <span class="n">self</span><span class="p">.</span><span class="n">wrapped</span> <span class="o">=</span> <span class="nf">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>            <span class="c1"># On attribute fetch
</span>            <span class="k">return</span> <span class="nf">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">wrapped</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Wrapper</span>

<span class="nd">@decorator</span>
<span class="k">class</span> <span class="nc">C</span><span class="p">:</span>                        <span class="c1"># C = decorator(C)
</span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>   <span class="c1"># Run by Wrapper.__init__
</span>        <span class="n">self</span><span class="p">.</span><span class="n">attr</span> <span class="o">=</span> <span class="sh">'</span><span class="s">spam</span><span class="sh">'</span>

<span class="n">x</span> <span class="o">=</span> <span class="nc">C</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>                     <span class="c1"># Really calls Wrapper(6, 7)
</span><span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">attr</span><span class="p">)</span>                   <span class="c1"># Runs Wrapper.__getattr__, prints "spam"</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modules-and-packages">15. Modules and packages</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># A module is a single Python file (.py extension) containing Python code,
# that can include functions, classes, variables, and statements.
</span>
<span class="c1"># animal.py (module file)
</span><span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">voice</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">__voice</span> <span class="o">=</span> <span class="n">voice</span>

    <span class="k">def</span> <span class="nf">wow</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">__voice</span><span class="si">}</span><span class="s">!</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># A package is a directory containing multiple Python modules and potentially
# subdirectories with even more modules, that represents a collection of related
# modules organized under a common namespace.
#
# A package import turns a directory into another Python namespace, with attributes
# corresponding to the subdirectories and module files that the directory contains.
</span>
<span class="c1"># .
# ├── animals
# │   ├── cat.py
# │   ├── dog.py
# │   └── __init__.py
# └── main.py
</span>
<span class="c1"># animals/cat.py
</span><span class="k">def</span> <span class="nf">wow</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">meow!</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># animals/dog.py
</span><span class="k">def</span> <span class="nf">wow</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">bark!</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># main.py
</span><span class="kn">from</span> <span class="n">animals</span> <span class="kn">import</span> <span class="n">cat</span>  <span class="c1"># from package import module
</span><span class="kn">import</span> <span class="n">animals.dog</span> <span class="k">as</span> <span class="n">dog</span>  <span class="c1"># import package.module
</span>
<span class="n">cat</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># meow!
</span><span class="n">dog</span><span class="p">.</span><span class="nf">wow</span><span class="p">()</span>  <span class="c1"># bark!</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="search-path">15.1. search path</h3>
<div class="paragraph">
<p>In the context of programming languages and environments, the search path refers to a list of directories that the program or interpreter looks at to locate specific files, particularly modules or libraries, that is composed of the concatenation of the four major components, that ultimately becomes <code>sys.path</code>, a mutable list of directory name strings:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Home directory (automatic)</p>
<div class="ulist">
<ul>
<li>
<p>When running a program, this entry is the directory containing the program’s top-level script file.</p>
</li>
<li>
<p>When working <em>interactively</em>, this entry is the directory in the working (i.e., the current working directory).</p>
</li>
</ul>
</div>
</li>
<li>
<p>PYTHONPATH directories (if set)</p>
<div class="ulist">
<ul>
<li>
<p>In brief, PYTHONPATH is simply a list of user-defined and platform-specific names of directories that contain Python code files.</p>
</li>
<li>
<p>The <code>os.pathsep</code> constant in Python provides the provide platform-specific directory path separator on the module search path.</p>
<div class="ulist">
<ul>
<li>
<p>Windows: <code>C:\Python310;C:\Users\YourName\Documents\my_modules</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">platform</span>

<span class="n">platform</span><span class="p">.</span><span class="nf">system</span><span class="p">(),</span> <span class="n">os</span><span class="p">.</span><span class="n">pathsep</span>  <span class="c1"># ('Windows', ';')</span></code></pre>
</div>
</div>
</li>
<li>
<p>Linux/macOS: <code>/usr/lib/python3.10/site-packages:/home/yourname/my_modules</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">platform</span>

<span class="n">platform</span><span class="p">.</span><span class="nf">system</span><span class="p">(),</span> <span class="n">os</span><span class="p">.</span><span class="n">pathsep</span>  <span class="c1"># ('Linux', ':')</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Standard library directories</p>
</li>
<li>
<p>The contents of any .pth files (if present)</p>
</li>
<li>
<p>The <em>site-packages</em> directory of third-party extensions (automatic)</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">sys</span>
<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"'</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>

<span class="sh">''</span>  <span class="c1"># current working directory where the script is located
</span><span class="sh">'</span><span class="s">/usr/lib/python311.zip</span><span class="sh">'</span>  <span class="c1"># standard library, built-in modules
</span><span class="sh">'</span><span class="s">/usr/lib/python3.11</span><span class="sh">'</span>
<span class="sh">'</span><span class="s">/usr/lib/python3.11/lib-dynload</span><span class="sh">'</span>  <span class="c1"># dynamically loaded modules or libraries
</span><span class="sh">'</span><span class="s">/usr/local/lib/python3.11/dist-packages</span><span class="sh">'</span>  <span class="c1"># third-party libraries
</span><span class="sh">'</span><span class="s">/usr/lib/python3/dist-packages</span><span class="sh">'</span>

<span class="c1"># sys.path is a list, and can be updated programmlly
</span><span class="n">sys</span><span class="p">.</span><span class="n">path</span>
<span class="c1"># ['', '/usr/lib/python311.zip', '/usr/lib/python3.11', '/usr/lib/python3.11/lib-dynload', '/usr/local/lib/python3.11/dist-packages', '/usr/lib/python3/dist-packages']
</span><span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sh">'</span><span class="s">/tmp</span><span class="sh">'</span><span class="p">)</span>
<span class="n">sys</span><span class="p">.</span><span class="n">path</span>
<span class="c1"># ['/tmp', '', '/usr/lib/python311.zip', '/usr/lib/python3.11', '/usr/lib/python3.11/lib-dynload', '/usr/local/lib/python3.11/dist-packages', '/usr/lib/python3/dist-packages']</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__init__-py">15.2. __init__.py</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># dir0\ # Container on module search path
#     dir1\
#         __init__.py
#         dir2\
#             __init__.py
#             mod.py
</span>
<span class="kn">import</span> <span class="n">dir1.dir2.mod</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dir1</code> and <code>dir2</code> both must contain an <code>__init__.py</code> file at least until Python 3.3.</p>
</li>
<li>
<p><code>dir0</code>, the container, does not require an <code>__init__.py</code> file; this file will simply be ignored if present.</p>
</li>
<li>
<p><code>dir0</code>, not <code>dir0\dir1</code>, must be listed on the module search path <code>sys.path</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>__init__.py</code> file serves as a hook for package initialization-time actions, declares a directory as a package, generates a module namespace for a directory, and implements the behavior of <code>from *</code> (i.e., <code>from .. import *</code>) statements when used with directory imports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Package initialization: The first time a Python program imports through a directory, it automatically runs all the code in the directory’s <code>__init__.py</code> file which a natural place to put code to initialize the state required by files in a package.</p>
</li>
<li>
<p>Module usability declarations: Package <code>__init__.py</code> files are also partly present to declare that a directory is a regular module package.</p>
</li>
<li>
<p>Module namespace initialization: In the package import model, the directory paths in a script become real nested object paths after an import.</p>
</li>
<li>
<p><code>from *</code> statement behavior: As an advanced feature, the <code>__all__</code> lists in <code>__init__.py</code> files can define what is exported when a directory is imported with the <code>from *</code> statement form.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="import-and-from-statements-reload-call">15.3. import and from statements, reload call</h3>
<div class="ulist">
<ul>
<li>
<p><code>import</code> fetches the module as a whole, and must qualify to fetch its names.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">module_name</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>from</code> fetches (or copies) specific names out of the module over to another scope, and when using a <code>*</code> (used only at the top level of a module file, not within a function) instead of specific names, it copies of all names assigned at the top level of the referenced module.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># import specific functions or classes from a module.
</span><span class="kn">from</span> <span class="n">module_name</span> <span class="kn">import</span> <span class="n">element1</span><span class="p">,</span> <span class="n">element2</span>
<span class="c1"># import a specific element and assign it an alias for easier use.
</span><span class="kn">from</span> <span class="n">module_name</span> <span class="kn">import</span> <span class="n">element1</span> <span class="k">as</span> <span class="n">alias</span>
<span class="c1"># copy out _all_ variables
</span><span class="kn">from</span> <span class="n">module_name</span> <span class="kn">import</span> <span class="o">*</span></code></pre>
</div>
</div>
</li>
<li>
<p>Like <code>def</code>, <code>import</code> and <code>from</code> are executable statements, not compile-time declarations, and they are implicit assignments:</p>
<div class="ulist">
<ul>
<li>
<p><code>import</code> assigns an entire module object to a single name.</p>
</li>
<li>
<p><code>from</code> assigns one or more names to objects of the same names in another module.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Modules are loaded and run on the first <code>import</code> or <code>from</code>, and only the first.</p>
</li>
<li>
<p>Unlike <code>import</code> and <code>from</code>:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>reload</code> is a function in Python, not a statement.</p>
</li>
<li>
<p><code>reload</code> is passed an existing module object, not a new name.</p>
</li>
<li>
<p><code>reload</code> lives in a module in Python 3.X and must be imported itself.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># import module                 # initial import
# ...use module.attributes...
# ...                           # now, go change the module file
# ...
# from importlib import reload  # get reload itself (in 3.x)
# reload(module)                # get updated exports
# ...use module.attributes...</span></code></pre>
</div>
</div>
</li>
<li>
<p>A <em>namespace package</em> is not fundamentally different from a <em>regular package</em> (must have an <code>__init__.py</code> file that is run automatically); it is just a different way of creating packages which are still relative to <code>sys.path</code> at the
top level: the leftmost component of a dotted namespace package path must still be located in an entry on the normal module search path.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">dir1.dir2.mod</span>
<span class="kn">from</span> <span class="n">dir1.dir2.mod</span> <span class="kn">import</span> <span class="n">x</span>
<span class="kn">import</span> <span class="n">splitdir.mod</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="nb">mkdir</span> <span class="nt">-p</span> /code/ns/dir<span class="o">{</span>1,2<span class="o">}</span>/sub  <span class="c"># two dirs of same name in different dirs</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># module files in different directories
</span>
<span class="c1"># /code/ns/dir1/sub/mod1.py
</span><span class="nf">print</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">dir1\sub\mod1</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># /code/ns/dir2/sub/mod2.py
</span><span class="nf">print</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">dir2\sub\mod2</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="nv">PYTHONPATH</span><span class="o">=</span>/code/ns/dir1:/code/ns/dir2 python <span class="nt">-q</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">sub</span>
<span class="n">sub</span>  <span class="c1"># namespace packages: nested search paths
# &lt;module 'sub' (&lt;_frozen_importlib_external.NamespaceLoader object at 0x7fd1eeda5c50&gt;)&gt;
</span><span class="n">sub</span><span class="p">.</span><span class="n">__path__</span>
<span class="c1"># _NamespacePath(['/code/ns/dir1/sub', '/code/ns/dir2/sub'])
</span>
<span class="kn">from</span> <span class="n">sub</span> <span class="kn">import</span> <span class="n">mod1</span>
<span class="c1"># dir1\sub\mod1
</span><span class="kn">import</span> <span class="n">sub.mod2</span>  <span class="c1"># content from two different directories
# dir2\sub\mod2
</span>
<span class="n">mod1</span>
<span class="c1"># &lt;module 'sub.mod1' from '/code/ns/dir1/sub/mod1.py'&gt;
</span><span class="n">sub</span><span class="p">.</span><span class="n">mod2</span>
<span class="c1"># &lt;module 'sub.mod2' from '/code/ns/dir2/sub/mod2.py'&gt;</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="relative-imports">15.4. relative imports</h3>
<div class="ulist">
<ul>
<li>
<p>The <code>from</code> statement can use leading dots (<code>.</code>) to specify that it require modules located within the same package (known as <em>package relative imports</em>), instead of modules located elsewhere on the module import search path (called <em>absolute imports</em>).</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">.</span> <span class="kn">import</span> <span class="n">string</span> <span class="c1"># relative to this package, imports mypkg.string
</span><span class="kn">from</span> <span class="n">.string</span> <span class="kn">import</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="c1"># imports names from mypkg.string
</span><span class="kn">from</span> <span class="n">..</span> <span class="kn">import</span> <span class="n">string</span> <span class="c1"># imports string sibling of mypkg</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="go">├── main.py
└── spam
    ├── eggs.py
    ├── ham.py
    └── __init__.py</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># spam/ham.py
</span><span class="kn">from</span> <span class="n">.</span> <span class="kn">import</span> <span class="n">eggs</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">eggs</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># main.py
</span><span class="kn">from</span> <span class="n">spam</span> <span class="kn">import</span> <span class="n">ham</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 main.py
<span class="go">eggs</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Running <code>main.py</code> directly sets the module&#8217;s <code>__name__</code> attribute to "__main__", causing issues with relative imports which rely on it being set to the package name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># mypkg\
#     main.py
#     string.py</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># string.py
</span><span class="k">def</span> <span class="nf">some_function</span><span class="p">():</span> <span class="bp">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># main.py
</span><span class="kn">from</span> <span class="n">.string</span> <span class="kn">import</span> <span class="n">some_function</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 main.py
<span class="go">Traceback (most recent call last):
    from .string import some_function
ImportError: attempted relative import with no known parent package</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_x-__all__-__name__-and-__main__">15.5. _X, __all__, __name__, and __main__</h3>
<div class="ulist">
<ul>
<li>
<p>Python looks for an <code>__all__</code> list in the module first and copies its names irrespective of any underscores; if <code>__all__</code> is not defined, <code>from *</code> copies all names without a single leading underscore (<code>_X</code>):</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># unders.py
</span><span class="n">a</span><span class="p">,</span> <span class="n">_b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">_d</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">unders</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1"># Load non _X names only
</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span>  <span class="c1"># (1, 3)
</span><span class="n">_b</span>  <span class="c1"># NameError: name '_b' is not defined
</span>
<span class="kn">import</span> <span class="n">unders</span> <span class="c1"># But other importers get every name
</span><span class="n">unders</span><span class="p">.</span><span class="n">_b</span>  <span class="c1"># 2</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># alls.py
</span><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">_c</span><span class="sh">'</span><span class="p">]</span> <span class="c1"># __all__ has precedence over _X
</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">_c</span><span class="p">,</span> <span class="n">_d</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">alls</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># load __all__ names only
</span><span class="n">a</span><span class="p">,</span> <span class="n">_c</span>  <span class="c1"># (1, 3)
</span><span class="n">b</span>  <span class="c1"># NameError: name 'b' is not defined
</span><span class="kn">from</span> <span class="n">alls</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">_c</span><span class="p">,</span> <span class="n">_d</span>  <span class="c1"># but other importers get every name
</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">_c</span><span class="p">,</span> <span class="n">_d</span>  <span class="c1"># (1, 2, 3, 4)
</span>
<span class="kn">import</span> <span class="n">alls</span>
<span class="n">alls</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">alls</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">alls</span><span class="p">.</span><span class="n">_c</span><span class="p">,</span> <span class="n">alls</span><span class="p">.</span><span class="n">_d</span>  <span class="c1"># (1, 2, 3, 4)</span></code></pre>
</div>
</div>
</li>
<li>
<p>If a module’s <code>__name__</code> variable is the string "__main__", it means that the file is being executed as a top-level script as a program instead of being imported from another file as a library in the program.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># cat.py
</span><span class="k">def</span> <span class="nf">wow</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">__name__</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">executed: </span><span class="si">{</span><span class="nf">wow</span><span class="p">()</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 cat.py  <span class="c"># directly executed (as a script)</span>
<span class="go">executed: __main__</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># imported by another module
</span><span class="kn">from</span> <span class="n">cat</span> <span class="kn">import</span> <span class="n">wow</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">imported: </span><span class="si">{</span><span class="nf">wow</span><span class="p">()</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># imported: cat</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="modules-by-name-strings">15.6. modules by name strings</h3>
<div class="ulist">
<ul>
<li>
<p>To import the referenced module given its string name, build and run an <code>import</code> statement with <code>exec</code>, or pass the string name in a call to the <code>__import__</code> or <code>importlib.import_module</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># The `import` statements can’t directly to load a module given its name as a
# string—Python expects a variable name that’s taken literally and not evalu-
# ated, not a string or expression.
</span><span class="k">import</span> <span class="sh">'</span><span class="s">string</span><span class="sh">'</span>
<span class="c1">#   File "&lt;stdin&gt;", line 1
#     import 'string'
#            ^^^^^^^^
# SyntaxError: invalid syntax</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># The most general approach is to construct an `import` statement as a string of Python
# code and pass it to the `exec` built-in function to run, but it must compile the `import`
# statement each time it runs, and compiling can be slow.
</span><span class="n">modname</span> <span class="o">=</span> <span class="sh">'</span><span class="s">string</span><span class="sh">'</span>
<span class="nf">exec</span><span class="p">(</span><span class="sh">'</span><span class="s">import </span><span class="sh">'</span> <span class="o">+</span> <span class="n">modname</span><span class="p">)</span> <span class="c1"># Run a string of code
</span><span class="n">string</span>
<span class="c1"># &lt;module 'string' from '/usr/lib/python3.11/string.py'&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># In most cases it’s probably simpler and may run quicker to use the built-in `__import__`
# function to load from a name string instead, which returns the module object, so assign it
# to a name here to keep it.
</span><span class="n">modname</span> <span class="o">=</span> <span class="sh">'</span><span class="s">string</span><span class="sh">'</span>
<span class="n">string</span> <span class="o">=</span> <span class="nf">__import__</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span>
<span class="n">string</span>
<span class="c1"># &lt;module 'string' from '/usr/lib/python3.11/string.py'&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># The newer call `importlib.import_module` does the same work as the built-in `__import__`
# function, and is generally preferred in more recent Pythons for direct calls to import
# by name string.
</span><span class="kn">import</span> <span class="n">importlib</span>
<span class="n">modname</span> <span class="o">=</span> <span class="sh">'</span><span class="s">string</span><span class="sh">'</span>
<span class="n">string</span> <span class="o">=</span> <span class="n">importlib</span><span class="p">.</span><span class="nf">import_module</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="pip-pip-install-packages">15.7. pip: pip install packages</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># ensure can run pip from the command line</span>
python3 <span class="nt">-m</span> pip <span class="nt">--version</span>  <span class="c"># pip --version</span>
<span class="c"># pip 23.0.1 from /usr/lib/python3/dist-packages/pip (python 3.11)</span>

<span class="c"># OR, install pip, venv modules in Debian/Ubuntu for the system python.</span>
apt <span class="nb">install </span>python3-pip python3-venv  <span class="c"># On Debian/Ubuntu systems</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="virtual-environment">15.7.1. virtual environment</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># create a virtual environment</span>
python3 <span class="nt">-m</span> venv python-learning-notes_env

<span class="c"># active a virtual environment</span>
<span class="nb">source </span>python-learning-notes_env/bin/activate

<span class="c"># ensure pip, setuptools, and wheel are up to date</span>
pip <span class="nb">install</span> <span class="nt">--upgrade</span> pip setuptools wheel

<span class="c"># show pip version</span>
pip <span class="nt">--version</span>  <span class="c"># python3 -m pip --version</span>
<span class="c"># pip 24.0 from .../python-learning-notes_env/lib/python3.11/site-packages/pip (python 3.11)</span>

<span class="c"># deactive a virtual environment: the deactivate command is often implemented as a shell function.</span>
deactivate</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="version-specifiers">15.7.2. Version specifiers</h4>
<div class="paragraph">
<p>A version specifier consists of a series of version clauses, separated by commas. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">~= 0.9, &gt;</span><span class="o">=</span> 1.0, <span class="o">!=</span> 1.3.4.<span class="k">*</span>, &lt; 2.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The comparison operator determines the kind of version clause:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>~=</code>: <a href="https://peps.python.org/pep-0440/#compatible-release">Compatible release</a> clause</p>
</li>
<li>
<p><code>==</code>: <a href="https://peps.python.org/pep-0440/#version-matching">Version matching</a> clause</p>
</li>
<li>
<p><code>!=</code>: <a href="https://peps.python.org/pep-0440/#version-exclusion">Version exclusion</a> clause</p>
</li>
<li>
<p><code><=</code>, <code>&gt;=</code>: <a href="https://peps.python.org/pep-0440/#inclusive-ordered-comparison">Inclusive ordered comparison</a> clause</p>
</li>
<li>
<p><code>&lt;</code>, <code>&gt;</code>: <a href="https://peps.python.org/pep-0440/#exclusive-ordered-comparison">Exclusive ordered comparison</a> clause</p>
</li>
<li>
<p><code>===</code>: <a href="https://peps.python.org/pep-0440/#arbitrary-equality">Arbitrary equality</a> clause.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>~=3.1</code>: version 3.1 or later, but not version 4.0 or later.</p>
</li>
<li>
<p><code>~=3.1.2</code>: version 3.1.2 or later, but not version 3.2.0 or later.</p>
</li>
<li>
<p><code>~=3.1a1</code>: version 3.1a1 or later, but not version 4.0 or later.</p>
</li>
<li>
<p><code>== 3.1</code>: specifically version 3.1 (or 3.1.0), excludes all pre-releases, post releases, developmental releases and any 3.1.x maintenance releases.</p>
</li>
<li>
<p><code>== 3.1.*</code>: any version that starts with 3.1. Equivalent to the <code>~=3.1.0</code> compatible release clause.</p>
</li>
<li>
<p><code>~=3.1.0, != 3.1.3</code>: version 3.1.0 or later, but not version 3.1.3 and not version 3.2.0 or later.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="pip-install">15.7.3. pip install</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># install the latest stable version.</span>
pip <span class="nb">install</span> &lt;package_name&gt;

<span class="c"># install a package with extras, i.e., optional dependencies (e.g., pip install 'transformers[torch]').</span>
pip <span class="nb">install</span> &lt;package_name&gt;[extra1[,extra2,...]]

<span class="c"># install the exact version (e.g., pip install vllm==0.4.3).</span>
pip <span class="nb">install</span> &lt;package_name&gt;<span class="o">==</span>&lt;version&gt;

<span class="c"># install the latest version greater than or equal to the specified one (e.g., pip install vllm&gt;=0.4.0 gets anything from 0.4.0 onwards), but within the same major version.</span>
pip <span class="nb">install</span> &lt;package_name&gt;&gt;<span class="o">=</span>&lt;version&gt;

<span class="c"># install the latest patch version (tilde operator) within the specified major and minor version (e.g., pip install vllm~=0.4).</span>
pip <span class="nb">install</span> &lt;package_name&gt;~<span class="o">=</span>&lt;version&gt;

<span class="c"># upgrade an already installed to the latest from PyPI.</span>
pip <span class="nb">install</span> <span class="nt">--upgrade</span> &lt;package_name&gt;

<span class="c"># install from an alternate index</span>
pip <span class="nb">install</span> <span class="nt">--index-url</span> http://my.package.repo/simple/ &lt;package_name&gt;

<span class="c"># search an additional index during install, in addition to PyPI</span>
pip <span class="nb">install</span> <span class="nt">--extra-index-url</span> http://my.package.repo/simple &lt;package_name&gt;

<span class="c"># install pre-release and development versions, in addition to stable versions</span>
pip <span class="nb">install</span> <span class="nt">--pre</span> &lt;package_name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cache-configuration">15.7.4. cache, configuration</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># get the cache directory that pip is currently configured to use</span>
pip cache <span class="nb">dir</span>  <span class="c"># ~/.cache/pip</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ini"><span class="c"># Configuration files can change the default values for command line options, and pip has 3 levels:
#   - global: system-wide configuration file, shared across users.
#   - user: per-user configuration file.
#   - site: per-environment configuration file; i.e. per-virtualenv.
</span>
<span class="c"># the names of the settings are derived from the long command line option.
</span><span class="nn">[global]</span>
<span class="py">timeout</span> <span class="p">=</span> <span class="s">60</span>
<span class="py">index-url</span> <span class="p">=</span> <span class="s">https://download.zope.org/ppix</span>

<span class="c"># per-command section: pip install
</span><span class="nn">[install]</span>
<span class="py">ignore-installed</span> <span class="p">=</span> <span class="s">true</span>
<span class="py">no-dependencies</span> <span class="p">=</span> <span class="s">yes</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">#</span><span class="w"> </span>finding the config directory programmatically:
<span class="gp">Debian GNU/Linux$</span><span class="w"> </span>pip config list <span class="nt">-v</span>
<span class="go">For variant 'global', will try loading '/etc/xdg/pip/pip.conf'
For variant 'global', will try loading '/etc/pip.conf'
For variant 'user', will try loading '~/.pip/pip.conf'
For variant 'user', will try loading '~/.config/pip/pip.conf'
</span><span class="gp">For variant 'site', will try loading '$</span>VIRTUAL_ENV/pip.conf<span class="s1">' or '</span>/usr/pip.conf<span class="s1">'
</span><span class="go">
</span><span class="gp">Microsoft Windows 11 &gt;</span><span class="w"> </span>pip config list <span class="nt">-v</span>
<span class="go">For variant 'global', will try loading '%ALLUSERSPROFILE%\pip\pip.ini'
For variant 'user', will try loading '%USERPROFILE%\pip\pip.ini'
For variant 'user', will try loading '%APPDATA%\pip\pip.ini'
For variant 'site', will try loading '%VIRTUAL_ENV%\pip.ini' or '%LOCALAPPDATA%\Programs\Python\Python312\pip.ini'</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mirror">15.7.5. mirror</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># default: https://pypi.org/simple</span>

<span class="c"># set the PyPI mirror</span>
pip config <span class="nt">--user</span> <span class="nb">set </span>global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
<span class="c"># pip config --user set global.index-url https://mirrors.aliyun.com/pypi/simple/</span>
<span class="c"># pip config set global.extra-index-url "https://mirrors.sustech.edu.cn/pypi/web/simple https://mirrors.aliyun.com/pypi/simple/"</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="conda">15.7.6. conda</h4>
<div class="paragraph">
<p><a href="https://docs.conda.io/en/latest/">Conda</a> is a free, open-source software program for package and environment management originally developed by Anaconda.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.anaconda.com/docs/getting-started/miniconda">Miniconda</a> is a free, miniature installation of <a href="https://www.anaconda.com/docs/getting-started/getting-started">Anaconda</a> Distribution that includes only <em>conda</em>, <em>Python</em>, the packages they both depend on, and a small number of other useful packages.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># download and install the latest version</span>
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash ~/Miniconda3-latest-Linux-x86_64.sh

<span class="c"># optional: disable auto-activation of base environment on startup</span>
conda config <span class="nt">--set</span> auto_activate_base <span class="nb">false</span></code></pre>
</div>
</div>
</li>
<li>
<p>Conda channels are the locations where packages are stored that serve as the base for hosting and managing packages. By default, conda can serve packages from two main locations:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>repo.anaconda.com</code>: By default, <code>conda</code> automatically uses the following base locations to download and update packages:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>https://repo.anaconda.com/pkgs/main
https://repo.anaconda.com/pkgs/r
https://repo.anaconda.com/pkgs/msys2</code></pre>
</div>
</div>
</li>
<li>
<p><code>conda.anaconda.org</code>: Conda clients search for community channels like <code>conda-forge</code> or <code>bioconda</code> here.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>conda config <span class="nt">--get</span> channels
<span class="gp">--add channels 'https://repo.anaconda.com/pkgs/r'   #</span><span class="w"> </span>lowest priority
<span class="gp">--add channels 'https://repo.anaconda.com/pkgs/main'   #</span><span class="w"> </span>highest priority
<span class="gp">$</span><span class="w"> </span>conda config <span class="nt">--add</span> channels conda-forge
<span class="gp">$</span><span class="w"> </span>conda config <span class="nt">--get</span> channels
<span class="gp">--add channels 'https://repo.anaconda.com/pkgs/r'   #</span><span class="w"> </span>lowest priority
<span class="go">--add channels 'https://repo.anaconda.com/pkgs/main'
</span><span class="gp">--add channels 'conda-forge'   #</span><span class="w"> </span>highest priority
<span class="gp">$</span><span class="w"> </span>conda config <span class="nt">--set</span> channel_priority strict
<span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> ~/.condarc
<span class="go">channels:
  - conda-forge
  - https://repo.anaconda.com/pkgs/main
  - https://repo.anaconda.com/pkgs/r
auto_activate_base: false
channel_priority: strict</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yml"><span class="c1"># mirror defaults</span>
<span class="na">default_channels</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">https://my-mirror.com/pkgs/main</span>
    <span class="pi">-</span> <span class="s">https://my-mirror.com/pkgs/r</span>
    <span class="pi">-</span> <span class="s">https://my-mirror.com/pkgs/msys2</span>

<span class="c1"># mirror all community channels</span>
<span class="na">channel_alias</span><span class="pi">:</span> <span class="s">https://my-mirror.com</span>

<span class="c1"># mirror only some community channels</span>
<span class="na">custom_channels</span><span class="pi">:</span>
    <span class="na">conda-forge</span><span class="pi">:</span> <span class="s">https://my-mirror.com/conda-forge</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yml"><span class="c1"># using TUNA mirrors</span>
<span class="na">show_channel_urls</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">default_channels</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span>
  <span class="pi">-</span> <span class="s">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span>
  <span class="pi">-</span> <span class="s">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span>
<span class="na">custom_channels</span><span class="pi">:</span>
  <span class="na">conda-forge</span><span class="pi">:</span> <span class="s">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span></code></pre>
</div>
</div>
</li>
<li>
<p>Conda is a powerful command line tool for package and environment management that runs on Windows, macOS, and Linux.</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># create environments</span>
conda create <span class="nt">-n</span> &lt;env-name&gt;

<span class="c"># add packages while creating an environment</span>
conda create <span class="nt">-n</span> myenvironment python numpy pandas</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># list environments</span>
conda info <span class="nt">--envs</span>
<span class="c"># or</span>
conda <span class="nb">env </span>list</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># remove an environment</span>
conda <span class="nb">env </span>remove <span class="nt">--name</span> my_env</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># activate an environment</span>
conda activate myenv

<span class="c"># deactivate an environment</span>
conda deactivate

<span class="c"># change the current environment back to the default base</span>
conda activate</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># install packages via environment activation</span>
conda activate myenvironment
conda <span class="nb">install </span>matplotlib

<span class="c"># install multiple packages via environment activation</span>
conda <span class="nb">install</span> <span class="nt">-y</span> pandas jupyter matplotlib

<span class="c"># install packages via command line option</span>
conda <span class="nb">install</span> <span class="nt">--name</span> myenvironment matplotlib

<span class="c"># install packages from a specific channel, such as conda-forge</span>
conda <span class="nb">install </span>conda-forge::numpy <span class="c"># or conda install -c conda-forge numpy</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># check the installed package</span>
conda list</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># see if a specific package, such as SciPy, is available for installation</span>
conda search scipy

<span class="c"># see if a specific package, such as SciPy, is available for installation from Anaconda.org</span>
conda search <span class="nt">--override-channels</span> <span class="nt">--channel</span> defaults scipy

<span class="c"># see if a specific package, such as SciPy, exists in a specific channel, is available for installation</span>
conda search <span class="nt">--override-channels</span> <span class="nt">--channel</span> conda-forge scipy

<span class="c"># show package detailed information: conda search &lt;package&gt;=&lt;version&gt;=&lt;build_num&gt; --info</span>
conda search <span class="nv">scipy</span><span class="o">=</span>1.15.2<span class="o">=</span>py313hf4aebb8_1 <span class="nt">--info</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># see conda version</span>
conda <span class="nt">--version</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># view a list of available Python versions</span>
conda search python

<span class="c"># update Python</span>
conda update python</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># update a specific package</span>
conda update biopython

<span class="c"># update conda itself</span>
conda update conda</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># use pip in an environment</span>
conda <span class="nb">install</span> <span class="nt">-n</span> myenv pip
conda activate myenv
pip &lt;pip_subcommand&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="pipenv">15.7.7. pipenv</h4>
<div class="paragraph">
<p>Pipenv is a dependency manager for Python projects, is similar in spirit to Node.js’ npm or Ruby’s bundler.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># install pipenv in Debian/Ubuntu for the system python.</span>
apt <span class="nb">install </span>pipenv</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># install pipenv for the user python.</span>
pip <span class="nb">install </span>pipenv <span class="nt">--user</span>

<span class="c"># If pipenv isn’t available in a shell after installation, add the user site-packages binary directory to `PATH`.</span>
<span class="c">#</span>
<span class="c"># On Windows, the user base binary directory can be found by running</span>
<span class="c"># `python -m site --user-site`</span>
<span class="c"># and replacing `site-packages` with `Scripts`.</span>
<span class="c">#</span>
<span class="c"># On Linux and macOS, find the user base binary directory by running</span>
<span class="c"># `python -m site --user-base`</span>
<span class="c"># and appending `bin` to the end.</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Debian/Linux might not work due to limitations with user-based installations.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using <code>apt</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">apt <span class="nb">install </span>pipenv</code></pre>
</div>
</div>
</li>
<li>
<p>Using <code>pip</code> with virtualenv</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># Create a virtual environment</span>
python3 <span class="nt">-m</span> venv pipenv_env

<span class="c"># Activate the virtual environment (replace "pipenv_env" with your chosen name)</span>
<span class="nb">source </span>pipenv_env/bin/activate

<span class="c"># Install pipenv within the virtual environment</span>
pip <span class="nb">install </span>pipenv

<span class="c"># Deactivate the virtual environment (optional)</span>
deactivate</code></pre>
</div>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># Pipenv manages dependencies on a per-project basis.</span>
<span class="nb">mkdir </span>myproject <span class="o">&amp;&amp;</span> <span class="nb">cd </span>myproject
pipenv <span class="nb">install </span>requests
<span class="nb">ls</span>  <span class="c"># Pipfile  Pipfile.lock</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># show the location of the virtual environment</span>
pipenv run python <span class="nt">-c</span> <span class="s2">"import os; print(os.environ['VIRTUAL_ENV'])"</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># activate the project's virtualenv:</span>
pipenv shell</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># main.py
</span><span class="kn">import</span> <span class="n">requests</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">https://httpbin.org/ip</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Your IP is {0}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">'</span><span class="s">origin</span><span class="sh">'</span><span class="p">]))</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># run a command inside the virtualenv</span>
pipenv run python main.py
<span class="c"># Your IP is 9.5.2.7</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># show virtualenv path information</span>
pipenv <span class="nt">--venv</span>
<span class="c"># /Users/your-username/.local/share/virtualenvs/your-project-name-abc123</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># remove the virtualenv</span>
pipenv <span class="nt">--rm</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># remove the virtual environment manually</span>
<span class="nb">rm</span> <span class="nt">-rf</span> /Users/your-username/.local/share/virtualenvs/your-project-name-abc123</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># remove all virtual environments</span>
<span class="nb">rm</span> <span class="nt">-rf</span> ~/.local/share/virtualenvs/</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh">pipenv check         <span class="c"># Checks for PyUp Safety security vulnerabilities and against</span>
                     <span class="c"># PEP 508 markers provided in Pipfile.</span>
pipenv clean         <span class="c"># Uninstalls all packages not specified in Pipfile.lock.</span>
pipenv graph         <span class="c"># Displays currently-installed dependency graph information.</span>
pipenv <span class="nb">install</span>       <span class="c"># Installs provided packages and adds them to Pipfile, or (if no</span>
                     <span class="c"># packages are given), installs all packages from Pipfile.</span>
pipenv lock          <span class="c"># Generates Pipfile.lock.</span>
pipenv open          <span class="c"># View a given module in your editor.</span>
pipenv requirements  <span class="c"># Generate a requirements.txt from Pipfile.lock.</span>
pipenv run           <span class="c"># Spawns a command installed into the virtualenv.</span>
pipenv scripts       <span class="c"># Lists scripts in current environment config.</span>
pipenv shell         <span class="c"># Spawns a shell within the virtualenv.</span>
pipenv <span class="nb">sync</span>          <span class="c"># Installs all packages specified in Pipfile.lock.</span>
pipenv uninstall     <span class="c"># Uninstalls a provided package and removes it from Pipfile.</span>
pipenv update        <span class="c"># Runs lock, then sync.</span>
pipenv upgrade       <span class="c"># Resolves provided packages and adds them to Pipfile, or (if no</span>
                     <span class="c"># packages are given), merges results to Pipfile.lock</span>
pipenv verify        <span class="c"># Verify the hash in Pipfile.lock is up-to-date.</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing">16. Testing</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>unittest</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># **Key Points About `unittest` in Python:**
#
# * **Test Cases:** Individual units of testing that verify specific functionality.
# * **Test Suites:** Collections of test cases that can be run together.
# * **Assertions:** Methods used to check if expected results match actual results.
# * **Test Case Structure:** Arrange-Act-Assert (AAA) is a common structure.
# * **Test Fixtures:** `setUp()` and `tearDown()` methods for setup and cleanup.
# * **Running Tests:** `unittest.main()` is the primary way to run tests.
# * **Best Practices:** Write clear, concise, and well-organized tests.
# * **Naming Conventions:** Test case functions must be prefixed with `test_`.
#
# **Common Assertions:**
#
# * `assertEqual(a, b)`: Checks if `a` equals `b`.
# * `assertNotEqual(a, b)`: Checks if `a` does not equal `b`.
# * `assertTrue(condition)`: Checks if `condition` is `True`.
# * `assertFalse(condition)`: Checks if `condition` is `False`.
# * `assertIn(item, container)`: Checks if `item` is in `container`.
# * `assertNotIn(item, container)`: Checks if `item` is not in `container`.
</span>
<span class="c1"># test_cap.py
</span><span class="kn">import</span> <span class="n">unittest</span>

<span class="k">def</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">.</span><span class="nf">capitalize</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">TestCap</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_one_word</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="sh">'</span><span class="s">duck</span><span class="sh">'</span>  <span class="c1"># _arrange_ the objects, create and set them up as necessary.
</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># _act_ on an object.
</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertEqual</span><span class="p">(</span><span class="sh">'</span><span class="s">Duck</span><span class="sh">'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>  <span class="c1"># _assert_ that something is as expected.
</span>
    <span class="k">def</span> <span class="nf">test_multi_words</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="sh">'</span><span class="s">hello world</span><span class="sh">'</span>  <span class="c1"># _arrange_ the objects, create and set them up as necessary.
</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># _act_ on an object.
</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertEqual</span><span class="p">(</span><span class="sh">'</span><span class="s">Hello World</span><span class="sh">'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>  <span class="c1"># _assert_ that something is as expected.
</span>
    <span class="k">def</span> <span class="nf">test_table_driven</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1"># _arrange_ the objects, create and set them up as necessary.
</span>        <span class="n">tests</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="sh">'</span><span class="s">duck</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Duck</span><span class="sh">'</span><span class="p">),</span>
            <span class="p">(</span><span class="sh">'</span><span class="s">hello world</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Hello World</span><span class="sh">'</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">expected</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># _act_ on an object.
</span>            <span class="n">self</span><span class="p">.</span><span class="nf">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>  <span class="c1"># _assert_ that something is as expected.
</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="n">unittest</span><span class="p">.</span><span class="nf">main</span><span class="p">()</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 test_cap.py
<span class="go">F.
======================================================================
FAIL: test_multi_words (__main__.TestCap.test_multi_words)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "...", line 27, in test_multi_words
    self.assertEqual('Hello World', result)
AssertionError: 'Hello World' != 'Hello world!'
- Hello World
?       ^
+ Hello world
?       ^


----------------------------------------------------------------------
Ran 2 tests in 0.003s

FAILED (failures=1)</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>doctest</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># doctest_cap.py
</span><span class="k">def</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">
</span><span class="gp">    &gt;&gt;&gt;</span> <span class="nf">cap</span><span class="p">(</span><span class="sh">'</span><span class="s">duck</span><span class="sh">'</span><span class="p">)</span>
    <span class="sh">'</span><span class="s">Duck</span><span class="sh">'</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="nf">cap</span><span class="p">(</span><span class="sh">'</span><span class="s">hello world</span><span class="sh">'</span><span class="p">)</span>
    <span class="sh">'</span><span class="s">Hello World</span><span class="sh">'</span>
    <span class="sh">"""</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">.</span><span class="nf">capitalize</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="n">doctest</span>
    <span class="n">doctest</span><span class="p">.</span><span class="nf">testmod</span><span class="p">()</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 doctest_cap.py
<span class="go">**********************************************************************
File "...", line 5, in __main__.cap
Failed example:
    cap('hello world')
Expected:
    'Hello World'
Got:
    'Hello world'
**********************************************************************
1 items had failures:
   1 of   2 in __main__.cap
***Test Failed*** 1 failures.</span></code></pre>
</div>
</div>
</li>
<li>
<p><code>pytest</code></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># test_cap.py
</span><span class="k">def</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">.</span><span class="nf">capitalize</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">test_one_word</span><span class="p">():</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sh">'</span><span class="s">duck</span><span class="sh">'</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Duck</span><span class="sh">'</span>

<span class="k">def</span> <span class="nf">test_multiple_words</span><span class="p">():</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sh">'</span><span class="s">hello world</span><span class="sh">'</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">cap</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="sh">'</span><span class="s">Hello World</span><span class="sh">'</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>pipenv <span class="nb">install </span>pytest
<span class="go">Installing pytest...
Installing dependencies from Pipfile.lock (207fdb)...
</span><span class="gp">$</span><span class="w"> </span>pytest
<span class="go">============================================== test session starts ==============================================
platform linux -- Python 3.11.2, pytest-8.2.1, pluggy-1.5.0
rootdir: ...
collected 2 items

test_cap.py .F                                                                                            [100%]

=================================================== FAILURES ====================================================
______________________________________________ test_multiple_words ______________________________________________

    def test_multiple_words():
        text = 'hello world'
        result = cap(text)
</span><span class="gp">&gt;</span><span class="w">       </span>assert result <span class="o">==</span> <span class="s1">'Hello World'</span>
<span class="go">E       AssertionError: assert 'Hello world' == 'Hello World'
E
E         - Hello World
E         ?       ^
E         + Hello world
E         ?       ^

test_cap.py:12: AssertionError
============================================ short test summary info ============================================
FAILED test_cap.py::test_multiple_words - AssertionError: assert 'Hello world' == 'Hello World'
========================================== 1 failed, 1 passed in 0.09s ==========================================</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="processes-and-concurrency">17. Processes and concurrency</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># The standard library’s os module provides a common way of accessing some system information.
</span><span class="kn">import</span> <span class="n">os</span>
<span class="n">os</span><span class="p">.</span><span class="nf">uname</span><span class="p">()</span>
<span class="c1"># posix.uname_result(sysname='Linux', nodename='node-0', release='6.1.0-21-amd64', version='#1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03)', machine='x86_64')
</span><span class="n">os</span><span class="p">.</span><span class="nf">getloadavg</span><span class="p">()</span>
<span class="c1"># (0.05126953125, 0.03955078125, 0.00341796875)
</span><span class="n">os</span><span class="p">.</span><span class="nf">cpu_count</span><span class="p">()</span>
<span class="c1"># 4
</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getpid</span><span class="p">(),</span> <span class="n">os</span><span class="p">.</span><span class="nf">getcwd</span><span class="p">(),</span> <span class="n">os</span><span class="p">.</span><span class="nf">getuid</span><span class="p">(),</span> <span class="n">os</span><span class="p">.</span><span class="nf">getgid</span><span class="p">())</span>
<span class="c1"># (1295, '/tmp', 1000, 1000)
</span><span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'</span><span class="s">date -u</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># Thu Jun  6 11:23:23 AM UTC 2024
# 0</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># get system and process information with the third-party package psutil
</span><span class="kn">import</span> <span class="n">psutil</span>  <span class="c1"># pip install psutil
</span><span class="nf">print</span><span class="p">(</span><span class="n">psutil</span><span class="p">.</span><span class="nf">cpu_times</span><span class="p">(</span><span class="n">percpu</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="c1"># [scputimes(user=4.37, nice=0.0, system=6.71, idle=1468.69, iowait=0.26, irq=0.0, softirq=1.86, steal=0.0, guest=0.0, guest_nice=0.0), scputimes(user=11.84, nice=0.0, system=9.3, idle=1465.29, iowait=1.02, irq=0.0, softirq=0.75, steal=0.0, guest=0.0, guest_nice=0.0), scputimes(user=10.31, nice=0.0, system=8.58, idle=1468.4, iowait=1.66, irq=0.0, softirq=0.97, steal=0.0, guest=0.0, guest_nice=0.0), scputimes(user=9.11, nice=0.0, system=10.02, idle=1467.95, iowait=0.81, irq=0.0, softirq=0.65, steal=0.0, guest=0.0, guest_nice=0.0)]
</span><span class="nf">print</span><span class="p">(</span><span class="n">psutil</span><span class="p">.</span><span class="nf">cpu_percent</span><span class="p">(</span><span class="n">percpu</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="c1"># 0.0
</span><span class="nf">print</span><span class="p">(</span><span class="n">psutil</span><span class="p">.</span><span class="nf">cpu_percent</span><span class="p">(</span><span class="n">percpu</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="c1"># [0.3, 0.4, 0.4, 0.1]</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="subprocess-and-multiprocessing">17.1. subprocess and multiprocessing</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">subprocess</span>

<span class="c1"># run another program in a shell
# and grab whatever output it created (both standard output and standard error output)
</span><span class="nf">print</span><span class="p">(</span><span class="n">subprocess</span><span class="p">.</span><span class="nf">getoutput</span><span class="p">(</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># Thu Jun  6 07:19:50 PM CST 2024
</span>
<span class="c1"># A variant method called `check_output()` takes a list of the command and arguments.
# By default it returns standard output only as type bytes rather than a string, and
# does not use the shell:
</span><span class="nf">print</span><span class="p">(</span><span class="n">subprocess</span><span class="p">.</span><span class="nf">check_output</span><span class="p">([</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">-u</span><span class="sh">'</span><span class="p">]))</span>  <span class="c1"># b'Thu Jun  6 11:30:09 AM UTC 2024\n'
</span>
<span class="c1"># return a tuple with the status code and output of the other program
</span><span class="nf">print</span><span class="p">(</span><span class="n">subprocess</span><span class="p">.</span><span class="nf">getstatusoutput</span><span class="p">(</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># (0, 'Thu Jun  6 07:32:25 PM CST 2024')
</span>
<span class="c1"># capture the exit status only
</span><span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="sh">'</span><span class="s">date -u</span><span class="sh">'</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># Thu Jun  6 11:45:51 AM UTC 2024
</span><span class="nf">print</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="c1"># 0
</span>
<span class="c1"># makes a list of the arguments, not need to call the shell
</span><span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">call</span><span class="p">([</span><span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">-u</span><span class="sh">'</span><span class="p">])</span>
<span class="c1"># Thu Jun  6 11:50:04 AM UTC 2024
</span><span class="nf">print</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<span class="c1"># 0</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># create multiple independent processes
</span><span class="kn">import</span> <span class="n">multiprocessing</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="k">def</span> <span class="nf">whoami</span><span class="p">(</span><span class="n">what</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Process %s says: %s</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getpid</span><span class="p">(),</span> <span class="n">what</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">whoami</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m the main program</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="p">.</span><span class="nc">Process</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">whoami</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m function %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">n</span><span class="p">,))</span>
        <span class="n">p</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>

<span class="c1"># Process 1648 says: I'm the main program
# Process 1649 says: I'm function 0
# Process 1650 says: I'm function 1
# Process 1651 says: I'm function 2
# Process 1652 says: I'm function 3</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="c1"># kill a process with terminate()
</span><span class="kn">import</span> <span class="n">multiprocessing</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">os</span>

<span class="k">def</span> <span class="nf">whoami</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m %s, in process %s</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="nf">getpid</span><span class="p">()))</span>

<span class="k">def</span> <span class="nf">loopy</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="nf">whoami</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="mi">1000000</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\t</span><span class="s">Number %s of %s. Honk!</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">stop</span><span class="p">))</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">whoami</span><span class="p">(</span><span class="sh">"</span><span class="s">main</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="p">.</span><span class="nc">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">loopy</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="sh">"</span><span class="s">loopy</span><span class="sh">"</span><span class="p">,))</span>
    <span class="n">p</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="nf">terminate</span><span class="p">()</span>

<span class="c1"># I'm main, in process 13084
# I'm loopy, in process 14664
#         Number 1 of 1000000. Honk!
#         Number 2 of 1000000. Honk!
#         Number 3 of 1000000. Honk!
#         Number 4 of 1000000. Honk!
#         Number 5 of 1000000. Honk!</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="queues-processes-and-threads">17.2. Queues, processes, and threads</h3>
<div class="paragraph">
<p>A queue is like a list: things are added at one end and taken away from the other, which most common is referred to as FIFO (first in, first out). In general, queues transport messages, which can be any kind of information, for distributed task management, also known as <em>work queues</em>, <em>job queues</em>, or <em>task queues</em>.</p>
</div>
<div class="paragraph">
<p>Threads can be dangerous. Like manual memory management in languages such as C and C++, they can cause bugs that are extremely hard to find, let alone fix. To use threads, all the code in the program (and in external libraries that it uses) must be <em>thread safe</em>.</p>
</div>
<div class="paragraph">
<p>In Python, threads do not speed up CPU-bound tasks because of an implementation detail in the standard Python system called the <em>Global Interpreter Lock</em> (GIL).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use threads for I/O-bound problems</p>
</li>
<li>
<p>Use processes, networking, or events (discussed in the next section) for CPU-bound problems</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">multiprocessing</span> <span class="k">as</span> <span class="n">mp</span>

<span class="k">def</span> <span class="nf">washer</span><span class="p">(</span><span class="n">dishes</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">dish</span> <span class="ow">in</span> <span class="n">dishes</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Washing</span><span class="sh">'</span><span class="p">,</span> <span class="n">dish</span><span class="p">,</span> <span class="sh">'</span><span class="s">dish</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">output</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">dish</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dryer</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">dish</span> <span class="o">=</span> <span class="nb">input</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Drying</span><span class="sh">'</span><span class="p">,</span> <span class="n">dish</span><span class="p">,</span> <span class="sh">'</span><span class="s">dish</span><span class="sh">'</span><span class="p">)</span>
        <span class="nb">input</span><span class="p">.</span><span class="nf">task_done</span><span class="p">()</span>

<span class="n">dish_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="p">.</span><span class="nc">JoinableQueue</span><span class="p">()</span>
<span class="n">dryer_proc</span> <span class="o">=</span> <span class="n">mp</span><span class="p">.</span><span class="nc">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">dryer</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">dish_queue</span><span class="p">,))</span>
<span class="n">dryer_proc</span><span class="p">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">dryer_proc</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
<span class="n">dishes</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">salad</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bread</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">entree</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dessert</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">washer</span><span class="p">(</span><span class="n">dishes</span><span class="p">,</span> <span class="n">dish_queue</span><span class="p">)</span>
<span class="n">dish_queue</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>

<span class="c1"># Washing salad dish
# Washing bread dish
# Washing entree dish
# Washing dessert dish
# Drying salad dish
# Drying bread dish
# Drying entree dish
# Drying dessert dish</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">threading</span>
<span class="kn">import</span> <span class="n">queue</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">def</span> <span class="nf">washer</span><span class="p">(</span><span class="n">dishes</span><span class="p">,</span> <span class="n">dish_queue</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">dish</span> <span class="ow">in</span> <span class="n">dishes</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Washing</span><span class="sh">"</span><span class="p">,</span> <span class="n">dish</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">dish_queue</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">dish</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dryer</span><span class="p">(</span><span class="n">dish_queue</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">dish</span> <span class="o">=</span> <span class="n">dish_queue</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Drying</span><span class="sh">"</span><span class="p">,</span> <span class="n">dish</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">dish_queue</span><span class="p">.</span><span class="nf">task_done</span><span class="p">()</span>

<span class="n">dish_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nc">Queue</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">dryer_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">dryer</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">dish_queue</span><span class="p">,))</span>
    <span class="n">dryer_thread</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
<span class="n">dishes</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">salad</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bread</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">entree</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">dessert</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">washer</span><span class="p">(</span><span class="n">dishes</span><span class="p">,</span> <span class="n">dish_queue</span><span class="p">)</span>
<span class="n">dish_queue</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>

<span class="c1"># Washing salad
# Washing bread
# Drying salad
# Washing entree
# Drying bread
# Washing dessert
# Drying entree
# Drying dessert</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="concurrent-futures">17.3. concurrent.futures</h3>
<div class="paragraph">
<p>The <code>concurrent.futures</code> module in the standard library can be used to schedule an asynchronous pool of workers, using threads (when I/O-bound) or processes (when CPU-bound), and get back a <code>future</code> to track their state and collect the results.</p>
</div>
<div class="paragraph">
<p>Use concurrent.futures any time to launch a bunch of concurrent tasks, such as the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Crawling URLs on the web</p>
</li>
<li>
<p>Processing files, such as resizing images</p>
</li>
<li>
<p>Calling service APIs</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">from</span> <span class="n">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
<span class="kn">import</span> <span class="n">math</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">val</span><span class="p">,</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">use_threads</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">futures</span><span class="p">.</span><span class="nc">ThreadPoolExecutor</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">as</span> <span class="n">tex</span><span class="p">:</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">tex</span><span class="p">.</span><span class="nf">submit</span><span class="p">(</span><span class="n">calc</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">.</span><span class="nf">as_completed</span><span class="p">(</span><span class="n">tasks</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">f</span><span class="p">.</span><span class="nf">result</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">use_processes</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">futures</span><span class="p">.</span><span class="nc">ProcessPoolExecutor</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">as</span> <span class="n">pex</span><span class="p">:</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">pex</span><span class="p">.</span><span class="nf">submit</span><span class="p">(</span><span class="n">calc</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">.</span><span class="nf">as_completed</span><span class="p">(</span><span class="n">tasks</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">f</span><span class="p">.</span><span class="nf">result</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Using </span><span class="si">{</span><span class="n">workers</span><span class="si">}</span><span class="s"> workers for </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s"> values</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using threads:</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nf">use_threads</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">result</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using processes:</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nf">use_processes</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">result</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="n">workers</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">workers</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># 1 .. 5
</span>    <span class="nf">main</span><span class="p">(</span><span class="n">workers</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="asynchronous-io">17.4. Asynchronous I/O</h3>
<div class="paragraph">
<p>Python 3.4 introduced the asyncio module for asynchronous programming, and Python 3.5 added the <code>async</code> and <code>await</code> keywords, enabling <em>coroutines</em> (pausable functions) and an <em>event loop</em> for scheduling them, which facilitates high-performance networking, web servers, database connections, and distributed task queues, making it ideal for IO-bound and structured network applications.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">say</span><span class="p">(</span><span class="n">phrase</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">phrase</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">wicked</span><span class="p">():</span>
    <span class="n">task_1</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="nf">say</span><span class="p">(</span><span class="sh">"</span><span class="s">Surrender,</span><span class="sh">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">task_2</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="nf">say</span><span class="p">(</span><span class="sh">"</span><span class="s">Dorothy!</span><span class="sh">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">task_1</span>
    <span class="k">await</span> <span class="n">task_2</span>

<span class="c1">#  blocking: runs the passed coroutine in the default executor, which given a timeout duration of 5 minutes to shutdown
</span><span class="n">asyncio</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="nf">wicked</span><span class="p">())</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">say</span><span class="p">(</span><span class="n">phrase</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">phrase</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">wicked</span><span class="p">():</span>
    <span class="n">task_1</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="nf">say</span><span class="p">(</span><span class="sh">"</span><span class="s">Surrender,</span><span class="sh">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">task_2</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="nf">say</span><span class="p">(</span><span class="sh">"</span><span class="s">Dorothy!</span><span class="sh">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">gather</span><span class="p">(</span><span class="n">task_1</span><span class="p">,</span> <span class="n">task_2</span><span class="p">)</span>  <span class="c1"># Wait for all tasks to finish concurrently
</span>
<span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">get_event_loop</span><span class="p">()</span>
<span class="n">loop</span><span class="p">.</span><span class="nf">run_until_complete</span><span class="p">(</span><span class="nf">wicked</span><span class="p">())</span>
<span class="n">loop</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sql">18. SQL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DB-API (Database API), similar to JDBC in Java, is a standardized interface for Python that allows us to interact with various relational databases using a consistent set of functions and methods, which can simplify database access by providing a common ground for working with different database systems like MySQL, PostgreSQL, SQL Server, and SQLite.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DB-API focuses on fundamental database operations like connecting, executing SQL queries, fetching results, and committing/rolling back transactions.</p>
</li>
<li>
<p>Different database modules (e.g., <code>MySQLdb</code>, <code>psycopg2</code>, <code>sqlite3</code>) implement the DB-API standard, ensuring consistency in these core functionalities across various systems.</p>
</li>
<li>
<p>DB-API promotes parameterization of SQL queries using placeholders (<code>%s</code>, <code>?</code>, etc.) for values, which enhances security by preventing SQL injection vulnerabilities and improves portability by separating data from the query itself.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="using-db-api-with-sqlite-in-memory">18.1. Using DB-API with SQLite in Memory</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="py"><span class="kn">import</span> <span class="n">sqlite3</span>

<span class="c1"># Connect to an in-memory database (no file needed)
</span><span class="k">with</span> <span class="n">sqlite3</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="sh">"</span><span class="s">:memory:</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>

    <span class="c1"># Create a cursor object
</span>    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>

    <span class="c1"># Create a table (assuming you don't have one)
</span>    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">'''</span><span class="s">
CREATE TABLE IF NOT EXISTS users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  username TEXT NOT NULL,
  email TEXT UNIQUE NOT NULL)
</span><span class="sh">'''</span><span class="p">)</span>

    <span class="c1"># Insert some data using parameterization
</span>    <span class="n">users</span> <span class="o">=</span> <span class="p">[(</span><span class="sh">"</span><span class="s">Alice</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">alice@example.com</span><span class="sh">"</span><span class="p">),</span> <span class="p">(</span><span class="sh">"</span><span class="s">Bob</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">bob@example.com</span><span class="sh">"</span><span class="p">)]</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">executemany</span><span class="p">(</span>
        <span class="sh">"</span><span class="s">INSERT INTO users (username, email) VALUES (?, ?)</span><span class="sh">"</span><span class="p">,</span> <span class="n">users</span><span class="p">)</span>

    <span class="c1"># Commit the changes
</span>    <span class="n">connection</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>

    <span class="c1"># Query the data
</span>    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM users</span><span class="sh">"</span><span class="p">)</span>

    <span class="c1"># Fetch all results
</span>    <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>

    <span class="c1"># Print the results
</span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ID: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s">, Username: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s">, Email: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-python-from-source-code-on-linux">Appendix A: Install Python from Source Code on Linux</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download <a href="https://www.python.org/downloads/source/">Python Source Releases</a></p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="c"># replace the Python version (e.g. 3.13.0) as needed</span>
curl <span class="nt">-LO</span> https://www.python.org/ftp/python/3.13.0/Python-3.13.0.tar.xz</code></pre>
</div>
</div>
</li>
<li>
<p>Extract the XZ compressed source tarball</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="nb">tar </span>xvf Python-3.13.0.tar.xz</code></pre>
</div>
</div>
</li>
<li>
<p>Configure, make and install the Python</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sh"><span class="nb">cd </span>Python-3.13.0 <span class="o">&amp;&amp;</span> ./configure <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>make <span class="nb">install</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, <code>make install</code> will install all the files in <code>/usr/local/bin</code>, <code>/usr/local/lib</code> etc. You can specify an installation prefix other than <code>/usr/local</code> using <code>--prefix</code> on <code>./configure</code>, for instance <code>--prefix=$HOME</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span> /usr/local/lib/
<span class="go">libpython3.12.a  libpython3.13.a  pkgconfig  python3.11  python3.12  python3.13
</span><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span> /usr/local/bin/
<span class="go">2to3  2to3-3.12  idle3  idle3.12  idle3.13  pip3  pip3.12  pip3.13  pydoc3  pydoc3.12  pydoc3.13  python3  python3.12  python3.12-config  python3.13  python3.13-config  python3-config</span></code></pre>
</div>
</div>
</li>
<li>
<p>Check the Python version</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span>python3 <span class="nt">--version</span>
<span class="go">Python 3.13.0</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build-a-docker-image-for-fastapi">Appendix B: Build a Docker Image for FastAPI</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="console"><span class="gp">$</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">Dockerfile  main.py  requirements.txt</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="dockerfile"><span class="c"># syntax=docker/dockerfile:1</span>
<span class="k">ARG</span><span class="s"> PYTHON_VERSION=3.11</span>

<span class="k">FROM</span><span class="w"> </span><span class="s">python:${PYTHON_VERSION}-alpine</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>

<span class="k">ARG</span><span class="s"> PYTHON_VERSION</span>

<span class="k">WORKDIR</span><span class="s"> /app</span>

<span class="k">COPY</span><span class="s"> requirements.txt .</span>

<span class="k">RUN </span><span class="nt">--mount</span><span class="o">=</span><span class="nb">type</span><span class="o">=</span>cache,target<span class="o">=</span>/root/.cache/pip <span class="se">\
</span>    pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt <span class="se">\
</span>        <span class="nt">-i</span> https://pypi.tuna.tsinghua.edu.cn/simple

<span class="k">FROM</span><span class="s"> python:${PYTHON_VERSION}-alpine</span>
<span class="k">ARG</span><span class="s"> PYTHON_VERSION</span>

<span class="k">ENV</span><span class="s"> APP_UID=1654</span>
<span class="k">RUN </span>apk add <span class="nt">--no-cache</span> shadow <span class="se">\
</span>    <span class="o">&amp;&amp;</span> groupadd <span class="nt">-r</span> app <span class="nt">-g</span> <span class="nv">$APP_UID</span> <span class="se">\
</span>    <span class="o">&amp;&amp;</span> useradd <span class="nt">--no-log-init</span> <span class="nt">-r</span> <span class="nt">-g</span> app <span class="nt">-u</span> <span class="nv">$APP_UID</span> app
<span class="k">USER</span><span class="s"> app</span>

<span class="k">COPY</span><span class="s"> --from=builder /usr/local/lib/python${PYTHON_VERSION}/site-packages /usr/local/lib/python${PYTHON_VERSION}/site-packages</span>
<span class="k">COPY</span><span class="s"> --from=builder /usr/local/bin /usr/local/bin</span>
<span class="k">COPY</span><span class="s"> . .</span>

<span class="k">EXPOSE</span><span class="s"> 8000</span>

<span class="k">CMD</span><span class="s"> ["fastapi", "run", "main.py"]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references">References</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="IntroducingPython"></a>[1] Bill Lubanovic <em>Introducing Python: Modern Computing in Simple Packages</em>. second edition, O’Reilly Media, Inc., November 2019</p>
</li>
<li>
<p><a id="LearningPython"></a>[2] Learning Python, 5th Edition Powerful Object-Oriented Programming (Mark Lutz), O&#8217;Reilly Media; 5th edition (July 30, 2013)</p>
</li>
<li>
<p><a id="wiki-Python"></a>[3] <a href="https://en.wikipedia.org/wiki/Python_(programming_language" class="bare">https://en.wikipedia.org/wiki/Python_(programming_language</a>)</p>
</li>
<li>
<p><a id="gemini"></a>[4] <a href="https://gemini.google.com" class="bare">https://gemini.google.com</a></p>
</li>
<li>
<p><a id="python-standard-library"></a>[5] <a href="https://docs.python.org/3/library/" class="bare">https://docs.python.org/3/library/</a></p>
</li>
<li>
<p><a id="pypi"></a>[6] <a href="https://pypi.org/" class="bare">https://pypi.org/</a></p>
</li>
<li>
<p><a id="numpy-basics"></a>[7] <a href="https://numpy.org/doc/stable/user/absolute_beginners.html" class="bare">https://numpy.org/doc/stable/user/absolute_beginners.html</a></p>
</li>
<li>
<p><a id="pydata-book"></a>[8] Wes McKinney <em>Python for Data Analysis</em>. thrid edition, O’Reilly, August 2022.</p>
</li>
</ul>
</div>
</div>
</div>
    
<style>
  .utterances {
      max-width: 100%;
  }
</style>
<script src="https://utteranc.es/client.js"
        repo="ousiax/utterances"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


  </div>

  <ul class="post-navigation">
    <li>
      
      <a href="/2024/05/15/websockets-and-server-sent-events/">&laquo; WebSockets and Server-sent events</a>
      
    </li>
    <li>
      
      <a href="/2024/05/27/python-for-data-analysis/">Python for Data Analysis &raquo;</a>
      
    </li>
  </ul>
</article>

      </div>
    </div>

    <footer class="site-footer">
  <div class="license">
    <span>Article licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></span>
  </div>
  
  <details open>
    <summary>Extral Links</summary>
    <div>
      
      <a href="https://jekyllrb.com/">Jekyll</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://shopify.github.io/">Liquid</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://docs.asciidoctor.org/">Asciidoctor</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="https://github.com/qqbuby/">GitHub</a>
      
      &nbsp;.&nbsp;
      
      
      <a href="/feed.xml">RSS</a>
      
      
    </div>
  </details>
  
</footer>


<!-- https://github.com/bryanbraun/anchorjs -->
<script src="/js/anchor.min.js"></script>
<script>
  anchors.add();
  anchors.remove(".site-title");
</script>




  </body>

</html>
